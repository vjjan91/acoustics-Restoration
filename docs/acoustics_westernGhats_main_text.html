<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Source code and supporting information for Using passive acoustic monitoring to examine the impacts of ecological restoration on faunal biodiversity in the Western Ghats</title>
  <meta name="description" content="Source code and supporting information for Using passive acoustic monitoring to examine the impacts of ecological restoration on faunal biodiversity in the Western Ghats" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Source code and supporting information for Using passive acoustic monitoring to examine the impacts of ecological restoration on faunal biodiversity in the Western Ghats" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="vjjan91/acoustics-Restoration" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Source code and supporting information for Using passive acoustic monitoring to examine the impacts of ecological restoration on faunal biodiversity in the Western Ghats" />
  
  
  

<meta name="author" content="Vijay Ramesh" />
<meta name="author" content="Priyanka Hariharan" />
<meta name="author" content="VA Akshay" />
<meta name="author" content="Pooja Choksi" />
<meta name="author" content="Sarika Khanwilkar" />
<meta name="author" content="VV Robin" />
<meta name="author" content="Ruth DeFries" />


<meta name="date" content="2022-08-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="0.1" data-path=""><a href="#introduction"><i class="fa fa-check"></i><b>0.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path=""><a href="#attribution"><i class="fa fa-check"></i><b>0.1.1</b> Attribution</a></li>
<li class="chapter" data-level="0.1.2" data-path=""><a href="#data-access"><i class="fa fa-check"></i><b>0.1.2</b> Data access</a></li>
<li class="chapter" data-level="0.1.3" data-path=""><a href="#data-processing"><i class="fa fa-check"></i><b>0.1.3</b> Data processing</a></li>
<li class="chapter" data-level="0.1.4" data-path=""><a href="#main-text-figure-1"><i class="fa fa-check"></i><b>0.1.4</b> Main Text Figure 1</a></li>
<li class="chapter" data-level="0.1.5" data-path=""><a href="#main-text-figure-2"><i class="fa fa-check"></i><b>0.1.5</b> Main Text Figure 2</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path=""><a href="#site-selection"><i class="fa fa-check"></i><b>0.2</b> Site selection</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path=""><a href="#install-required-libraries"><i class="fa fa-check"></i><b>0.2.1</b> Install required libraries</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path=""><a href="#load-list-of-sites"><i class="fa fa-check"></i><b>0.3</b> Load list of sites</a>
<ul>
<li class="chapter" data-level="0.3.1" data-path=""><a href="#extract-elevation"><i class="fa fa-check"></i><b>0.3.1</b> Extract elevation</a></li>
<li class="chapter" data-level="0.3.2" data-path=""><a href="#distance-to-nearest-road"><i class="fa fa-check"></i><b>0.3.2</b> Distance to nearest road</a></li>
<li class="chapter" data-level="0.3.3" data-path=""><a href="#distance-between-ar-nr-site-pairs"><i class="fa fa-check"></i><b>0.3.3</b> Distance between AR-NR site pairs</a></li>
</ul></li>
<li class="chapter" data-level="0.4" data-path=""><a href="#processing-vegetation-data"><i class="fa fa-check"></i><b>0.4</b> Processing vegetation data</a>
<ul>
<li class="chapter" data-level="0.4.1" data-path=""><a href="#install-required-libraries-1"><i class="fa fa-check"></i><b>0.4.1</b> Install required libraries</a></li>
<li class="chapter" data-level="0.4.2" data-path=""><a href="#load-the-vegetation-data"><i class="fa fa-check"></i><b>0.4.2</b> Load the vegetation data</a></li>
<li class="chapter" data-level="0.4.3" data-path=""><a href="#process-habitat-structure-variables"><i class="fa fa-check"></i><b>0.4.3</b> Process habitat structure variables</a></li>
<li class="chapter" data-level="0.4.4" data-path=""><a href="#principal-component-analysis-of-vegetation-data"><i class="fa fa-check"></i><b>0.4.4</b> Principal component analysis of vegetation data</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path=""><a href="#acoustic-space-use"><i class="fa fa-check"></i><b>0.5</b> Acoustic space use</a>
<ul>
<li class="chapter" data-level="0.5.1" data-path=""><a href="#install-necessary-libraries"><i class="fa fa-check"></i><b>0.5.1</b> Install necessary libraries</a></li>
<li class="chapter" data-level="0.5.2" data-path=""><a href="#load-recordings-across-multiple-days-and-sites"><i class="fa fa-check"></i><b>0.5.2</b> Load recordings across multiple days and sites</a></li>
<li class="chapter" data-level="0.5.3" data-path=""><a href="#short-time-discrete-fourier-transform-stdft"><i class="fa fa-check"></i><b>0.5.3</b> Short-time discrete fourier transform (STDFT)</a></li>
<li class="chapter" data-level="0.5.4" data-path=""><a href="#average-acoustic-space-use"><i class="fa fa-check"></i><b>0.5.4</b> Average acoustic space use</a></li>
<li class="chapter" data-level="0.5.5" data-path=""><a href="#visual-examination-of-asu"><i class="fa fa-check"></i><b>0.5.5</b> Visual examination of ASU</a></li>
<li class="chapter" data-level="0.5.6" data-path=""><a href="#representative-figure-for-publication"><i class="fa fa-check"></i><b>0.5.6</b> Representative figure for publication</a></li>
</ul></li>
<li class="chapter" data-level="0.6" data-path=""><a href="#non-metric-multidimensional-scaling-of-acoustic-space-use-data"><i class="fa fa-check"></i><b>0.6</b> Non-metric multidimensional scaling of acoustic space use data</a>
<ul>
<li class="chapter" data-level="0.6.1" data-path=""><a href="#load-necessary-libraries-for-analysis"><i class="fa fa-check"></i><b>0.6.1</b> Load necessary libraries for analysis</a></li>
<li class="chapter" data-level="0.6.2" data-path=""><a href="#load-the-necessary-data-for-nmds-calculations"><i class="fa fa-check"></i><b>0.6.2</b> Load the necessary data for nmds calculations</a></li>
<li class="chapter" data-level="0.6.3" data-path=""><a href="#preparing-a-dataframe-of-space-use-to-run-ordinations"><i class="fa fa-check"></i><b>0.6.3</b> Preparing a dataframe of space use to run ordinations</a></li>
<li class="chapter" data-level="0.6.4" data-path=""><a href="#plotting-the-nmds-scores"><i class="fa fa-check"></i><b>0.6.4</b> Plotting the NMDS scores</a></li>
<li class="chapter" data-level="0.6.5" data-path=""><a href="#testing-multivariate-homogeneity-of-group-dispersions"><i class="fa fa-check"></i><b>0.6.5</b> Testing multivariate homogeneity of group dispersions</a></li>
<li class="chapter" data-level="0.6.6" data-path=""><a href="#visualizing-the-multivariate-homogeneity-of-group-dispersions"><i class="fa fa-check"></i><b>0.6.6</b> Visualizing the multivariate homogeneity of group dispersions</a></li>
</ul></li>
<li class="chapter" data-level="0.7" data-path=""><a href="#generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data"><i class="fa fa-check"></i><b>0.7</b> Generalized linear mixed modeling (acoustic space use and vegetation data)</a>
<ul>
<li class="chapter" data-level="0.7.1" data-path=""><a href="#install-required-libraries-2"><i class="fa fa-check"></i><b>0.7.1</b> Install required libraries</a></li>
<li class="chapter" data-level="0.7.2" data-path=""><a href="#load-necessary-data-for-statistical-modeling"><i class="fa fa-check"></i><b>0.7.2</b> Load necessary data for statistical modeling</a></li>
<li class="chapter" data-level="0.7.3" data-path=""><a href="#getting-data-ready-in-a-format-for-linear-modeling"><i class="fa fa-check"></i><b>0.7.3</b> Getting data ready in a format for linear modeling</a></li>
<li class="chapter" data-level="0.7.4" data-path=""><a href="#running-the-generalized-linear-mixed-models"><i class="fa fa-check"></i><b>0.7.4</b> Running the generalized linear mixed models</a></li>
<li class="chapter" data-level="0.7.5" data-path=""><a href="#we-now-run-generalized-linear-mixed-models-glmm-assuming-gaussian-errors-and-using-log-link-functions-to-examine-the-effects-of-habitat-vegetation-structure-on-acoustic-space-use."><i class="fa fa-check"></i><b>0.7.5</b> We now run generalized linear mixed models (GLMM) assuming gaussian errors and using log link functions to examine the effects of habitat (vegetation structure) on acoustic space use.</a></li>
</ul></li>
<li class="chapter" data-level="0.8" data-path=""><a href="#main-text-figure-4"><i class="fa fa-check"></i><b>0.8</b> Main Text Figure 4</a></li>
<li class="chapter" data-level="0.9" data-path=""><a href="#splitting-large-.wav-files"><i class="fa fa-check"></i><b>0.9</b> Splitting large .wav files</a>
<ul>
<li class="chapter" data-level="0.9.1" data-path=""><a href="#load-required-libraries"><i class="fa fa-check"></i><b>0.9.1</b> Load required libraries</a></li>
<li class="chapter" data-level="0.9.2" data-path=""><a href="#selecting-dawn-acoustic-data"><i class="fa fa-check"></i><b>0.9.2</b> Selecting dawn acoustic data</a></li>
<li class="chapter" data-level="0.9.3" data-path=""><a href="#split-the-files"><i class="fa fa-check"></i><b>0.9.3</b> Split the files</a></li>
</ul></li>
<li class="chapter" data-level="0.10" data-path=""><a href="#bird-species-richness"><i class="fa fa-check"></i><b>0.10</b> Bird Species Richness</a>
<ul>
<li class="chapter" data-level="0.10.1" data-path=""><a href="#install-required-libraries-3"><i class="fa fa-check"></i><b>0.10.1</b> Install required libraries</a></li>
<li class="chapter" data-level="0.10.2" data-path=""><a href="#load-manual-annotations-data"><i class="fa fa-check"></i><b>0.10.2</b> Load manual annotations data</a></li>
<li class="chapter" data-level="0.10.3" data-path=""><a href="#subset-data"><i class="fa fa-check"></i><b>0.10.3</b> Subset data</a></li>
<li class="chapter" data-level="0.10.4" data-path=""><a href="#total-number-of-detections"><i class="fa fa-check"></i><b>0.10.4</b> Total number of detections</a></li>
<li class="chapter" data-level="0.10.5" data-path=""><a href="#calculate-species-richness"><i class="fa fa-check"></i><b>0.10.5</b> Calculate species richness</a></li>
</ul></li>
<li class="chapter" data-level="0.11" data-path=""><a href="#acoustic-detections"><i class="fa fa-check"></i><b>0.11</b> Acoustic Detections</a>
<ul>
<li class="chapter" data-level="0.11.1" data-path=""><a href="#install-required-libraries-4"><i class="fa fa-check"></i><b>0.11.1</b> Install required libraries</a></li>
<li class="chapter" data-level="0.11.2" data-path=""><a href="#load-data"><i class="fa fa-check"></i><b>0.11.2</b> Load data</a></li>
<li class="chapter" data-level="0.11.3" data-path=""><a href="#overall-number-of-detections"><i class="fa fa-check"></i><b>0.11.3</b> Overall number of detections</a></li>
<li class="chapter" data-level="0.11.4" data-path=""><a href="#detections-by-treatment-type"><i class="fa fa-check"></i><b>0.11.4</b> Detections by treatment type</a></li>
<li class="chapter" data-level="0.11.5" data-path=""><a href="#detections-by-species-traits"><i class="fa fa-check"></i><b>0.11.5</b> Detections by species traits</a></li>
</ul></li>
<li class="chapter" data-level="0.12" data-path=""><a href="#species-proportions"><i class="fa fa-check"></i><b>0.12</b> Species proportions</a>
<ul>
<li class="chapter" data-level="0.12.1" data-path=""><a href="#install-required-libraries-5"><i class="fa fa-check"></i><b>0.12.1</b> Install required libraries</a></li>
<li class="chapter" data-level="0.12.2" data-path=""><a href="#load-the-necessary-data-to-calculate-proportions"><i class="fa fa-check"></i><b>0.12.2</b> Load the necessary data to calculate proportions</a></li>
<li class="chapter" data-level="0.12.3" data-path=""><a href="#proportion-of-acoustic-detections-across-all-10-s-chunks-for-every-site-date-combination"><i class="fa fa-check"></i><b>0.12.3</b> Proportion of acoustic detections across all 10-s chunks for every site-date combination</a></li>
<li class="chapter" data-level="0.12.4" data-path=""><a href="#testing-for-differences-in-species-acoustic-detections-across-treatment-types"><i class="fa fa-check"></i><b>0.12.4</b> Testing for differences in species acoustic detections across treatment types</a></li>
<li class="chapter" data-level="0.12.5" data-path=""><a href="#proportion-of-detections-across-acoustic-point-counts"><i class="fa fa-check"></i><b>0.12.5</b> Proportion of detections across acoustic point counts</a></li>
<li class="chapter" data-level="0.12.6" data-path=""><a href="#testing-for-differences-in-rainforest-and-open-country-species-detections-across-acoustic-point-counts"><i class="fa fa-check"></i><b>0.12.6</b> Testing for differences in rainforest and open-country species detections across acoustic point counts</a></li>
</ul></li>
<li class="chapter" data-level="0.13" data-path=""><a href="#non-metric-multidimensional-scaling-of-bird-species-detections"><i class="fa fa-check"></i><b>0.13</b> Non-metric multidimensional scaling of bird species detections</a>
<ul>
<li class="chapter" data-level="0.13.1" data-path=""><a href="#install-required-libraries-6"><i class="fa fa-check"></i><b>0.13.1</b> Install required libraries</a></li>
<li class="chapter" data-level="0.13.2" data-path=""><a href="#load-the-necessary-data-for-nmds-calculations-1"><i class="fa fa-check"></i><b>0.13.2</b> Load the necessary data for NMDS calculations</a></li>
<li class="chapter" data-level="0.13.3" data-path=""><a href="#preparing-dataframe-of-traits-and-species-to-be-used-for-nmds-later-on"><i class="fa fa-check"></i><b>0.13.3</b> Preparing dataframe of traits and species to be used for NMDS later on</a></li>
<li class="chapter" data-level="0.13.4" data-path=""><a href="#preparing-a-dataframe-of-detections-to-run-ordinations"><i class="fa fa-check"></i><b>0.13.4</b> Preparing a dataframe of detections to run ordinations</a></li>
<li class="chapter" data-level="0.13.5" data-path=""><a href="#bray-curtis-dissimilarity-index"><i class="fa fa-check"></i><b>0.13.5</b> Bray-Curtis dissimilarity index</a></li>
<li class="chapter" data-level="0.13.6" data-path=""><a href="#plotting-the-nmds-scores-1"><i class="fa fa-check"></i><b>0.13.6</b> Plotting the NMDS scores</a></li>
<li class="chapter" data-level="0.13.7" data-path=""><a href="#main-text-figure-5"><i class="fa fa-check"></i><b>0.13.7</b> Main text Figure 5</a></li>
<li class="chapter" data-level="0.13.8" data-path=""><a href="#testing-multivariate-homogeneity-of-group-dispersions-1"><i class="fa fa-check"></i><b>0.13.8</b> Testing multivariate homogeneity of group dispersions</a></li>
<li class="chapter" data-level="0.13.9" data-path=""><a href="#visualizing-the-multivariate-homogeneity-of-group-dispersions-1"><i class="fa fa-check"></i><b>0.13.9</b> Visualizing the multivariate homogeneity of group dispersions</a></li>
<li class="chapter" data-level="0.13.10" data-path=""><a href="#testing-compositional-dissimilarity-between-groups"><i class="fa fa-check"></i><b>0.13.10</b> Testing compositional dissimilarity between groups</a></li>
<li class="chapter" data-level="0.13.11" data-path=""><a href="#separate-analysis-instead-of-using-bird-detections-using-richness-to-run-nmds-ordinations"><i class="fa fa-check"></i><b>0.13.11</b> Separate analysis: Instead of using bird detections, using richness to run nmds ordinations</a></li>
</ul></li>
<li class="chapter" data-level="0.14" data-path=""><a href="#jackknife-estimates"><i class="fa fa-check"></i><b>0.14</b> Jackknife estimates</a>
<ul>
<li class="chapter" data-level="0.14.1" data-path=""><a href="#install-required-libraries-7"><i class="fa fa-check"></i><b>0.14.1</b> Install required libraries</a></li>
<li class="chapter" data-level="0.14.2" data-path=""><a href="#load-the-necessary-data-to-calculate-jackknife-scores"><i class="fa fa-check"></i><b>0.14.2</b> Load the necessary data to calculate Jackknife scores</a></li>
<li class="chapter" data-level="0.14.3" data-path=""><a href="#preparing-dataframe-to-extract-jacknife-scores"><i class="fa fa-check"></i><b>0.14.3</b> Preparing dataframe to extract jacknife scores</a></li>
<li class="chapter" data-level="0.14.4" data-path=""><a href="#save-scores-locally"><i class="fa fa-check"></i><b>0.14.4</b> Save scores locally</a></li>
<li class="chapter" data-level="0.14.5" data-path=""><a href="#looking-at-correlations-between-jacknife-scores-and-bootstrap-estimates"><i class="fa fa-check"></i><b>0.14.5</b> Looking at correlations between jacknife scores and bootstrap estimates</a></li>
<li class="chapter" data-level="0.14.6" data-path=""><a href="#testing-for-differences-between-treatment-types"><i class="fa fa-check"></i><b>0.14.6</b> Testing for differences between treatment types</a></li>
</ul></li>
<li class="chapter" data-level="0.15" data-path=""><a href="#generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year"><i class="fa fa-check"></i><b>0.15</b> Generalized linear mixed modeling (species richness, vegetation data and planting year)</a>
<ul>
<li class="chapter" data-level="0.15.1" data-path=""><a href="#install-required-libraries-8"><i class="fa fa-check"></i><b>0.15.1</b> Install required libraries</a></li>
<li class="chapter" data-level="0.15.2" data-path=""><a href="#load-the-necessary-data-for-statistical-modeling"><i class="fa fa-check"></i><b>0.15.2</b> Load the necessary data for statistical modeling</a></li>
<li class="chapter" data-level="0.15.3" data-path=""><a href="#getting-data-ready-in-a-format-for-generalized-linear-modeling"><i class="fa fa-check"></i><b>0.15.3</b> Getting data ready in a format for generalized linear modeling</a></li>
<li class="chapter" data-level="0.15.4" data-path=""><a href="#getting-data-ready-for-generalized-linear-mixed-modeling-with-richness-data-as-well-as-visits."><i class="fa fa-check"></i><b>0.15.4</b> Getting data ready for generalized linear mixed modeling with richness data as well as visits.</a></li>
<li class="chapter" data-level="0.15.5" data-path=""><a href="#running-the-generalized-linear-mixed-models-1"><i class="fa fa-check"></i><b>0.15.5</b> Running the generalized linear mixed models</a></li>
<li class="chapter" data-level="0.15.6" data-path=""><a href="#testing-the-role-of-habitat"><i class="fa fa-check"></i><b>0.15.6</b> Testing the role of habitat</a></li>
<li class="chapter" data-level="0.15.7" data-path=""><a href="#effect-of-planting-year"><i class="fa fa-check"></i><b>0.15.7</b> Effect of planting year</a></li>
</ul></li>
<li class="chapter" data-level="0.16" data-path=""><a href="#generalized-linear-mixed-modeling-species-proportions-vegetation-data-and-planting-year"><i class="fa fa-check"></i><b>0.16</b> Generalized linear mixed modeling (species proportions, vegetation data and planting year)</a>
<ul>
<li class="chapter" data-level="0.16.1" data-path=""><a href="#install-required-libraries-9"><i class="fa fa-check"></i><b>0.16.1</b> Install required libraries</a></li>
<li class="chapter" data-level="0.16.2" data-path=""><a href="#load-the-necessary-data-for-statistical-modeling-1"><i class="fa fa-check"></i><b>0.16.2</b> Load the necessary data for statistical modeling</a></li>
<li class="chapter" data-level="0.16.3" data-path=""><a href="#getting-data-ready-in-a-format-for-generalized-linear-mixed-modeling"><i class="fa fa-check"></i><b>0.16.3</b> Getting data ready in a format for generalized linear mixed modeling</a></li>
<li class="chapter" data-level="0.16.4" data-path=""><a href="#running-the-generalized-linear-mixed-models-2"><i class="fa fa-check"></i><b>0.16.4</b> Running the generalized linear mixed models</a></li>
<li class="chapter" data-level="0.16.5" data-path=""><a href="#examining-effect-of-restoration-type-on-proportion-of-rainforest-and-open-country-species-detections"><i class="fa fa-check"></i><b>0.16.5</b> Examining effect of restoration type on proportion of rainforest and open-country species detections</a></li>
<li class="chapter" data-level="0.16.6" data-path=""><a href="#testing-the-role-of-habitat-1"><i class="fa fa-check"></i><b>0.16.6</b> Testing the role of habitat</a></li>
<li class="chapter" data-level="0.16.7" data-path=""><a href="#effect-of-planting-year-1"><i class="fa fa-check"></i><b>0.16.7</b> Effect of planting year</a></li>
</ul></li>
<li class="chapter" data-level="0.17" data-path=""><a href="#generalized-linear-modeling-acoustic-space-use-and-proportion-of-bird-species-detections-and-time-since-restoration"><i class="fa fa-check"></i><b>0.17</b> Generalized linear modeling (acoustic space use and proportion of bird species detections and time since restoration)</a>
<ul>
<li class="chapter" data-level="0.17.1" data-path=""><a href="#install-required-libraries-10"><i class="fa fa-check"></i><b>0.17.1</b> Install required libraries</a></li>
<li class="chapter" data-level="0.17.2" data-path=""><a href="#load-necessary-data-for-statistical-modeling-1"><i class="fa fa-check"></i><b>0.17.2</b> Load necessary data for statistical modeling</a></li>
<li class="chapter" data-level="0.17.3" data-path=""><a href="#getting-data-ready-in-a-format-for-linear-modeling-1"><i class="fa fa-check"></i><b>0.17.3</b> Getting data ready in a format for linear modeling</a></li>
<li class="chapter" data-level="0.17.4" data-path=""><a href="#acoustic-space-use-and-proportion-of-bird-species-detections"><i class="fa fa-check"></i><b>0.17.4</b> Acoustic space use and proportion of bird species detections</a></li>
<li class="chapter" data-level="0.17.5" data-path=""><a href="#year-since-restoration"><i class="fa fa-check"></i><b>0.17.5</b> Year since restoration</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Source code and supporting information for <em>Using passive acoustic monitoring to examine the impacts of ecological restoration on faunal biodiversity in the Western Ghats</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Source code and supporting information for <em>Using passive acoustic monitoring to examine the impacts of ecological restoration on faunal biodiversity in the Western Ghats</em></h1>
<p class="author"><em>Vijay Ramesh</em></p>
<p class="author"><em>Priyanka Hariharan</em></p>
<p class="author"><em>VA Akshay</em></p>
<p class="author"><em>Pooja Choksi</em></p>
<p class="author"><em>Sarika Khanwilkar</em></p>
<p class="author"><em>VV Robin</em></p>
<p class="author"><em>Ruth DeFries</em></p>
<p class="date"><em>2022-08-19</em></p>
</div>
<div id="introduction" class="section level2 hasAnchor" number="0.1">
<h2><span class="header-section-number">0.1</span> Introduction<a href="#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This is the readable version that showcases analyses carried out to test the impacts of rainforest restoration on vocalizing biodiversity in the Anamalai hills of the Western Ghats biodiversity hotspot.</p>
<div id="attribution" class="section level3 hasAnchor" number="0.1.1">
<h3><span class="header-section-number">0.1.1</span> Attribution<a href="#attribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Please contact the following in case of interest in the project.</p>
<ul>
<li>Vijay Ramesh (lead author)
<ul>
<li>PhD student, Columbia University</li>
</ul></li>
</ul>
</div>
<div id="data-access" class="section level3 hasAnchor" number="0.1.2">
<h3><span class="header-section-number">0.1.2</span> Data access<a href="#data-access" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The data used in this work is archived on Zenodo.</p>
</div>
<div id="data-processing" class="section level3 hasAnchor" number="0.1.3">
<h3><span class="header-section-number">0.1.3</span> Data processing<a href="#data-processing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The data processing for this project is described in the following sections. Navigate through them using the links in the sidebar.</p>
<hr />
</div>
<div id="main-text-figure-1" class="section level3 hasAnchor" number="0.1.4">
<h3><span class="header-section-number">0.1.4</span> Main Text Figure 1<a href="#main-text-figure-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure">
<img src="figs/fig01.png" alt="" />
<p class="caption"><strong>Sites corresponding to acoustic recorder deployment locations across the Valparai plateau of the Anamalai hills.</strong>
The above figure showcases a gradient of forest regeneration across the Valparai plateau. Sites shown in green represent undisturbed benchmark rainforest sites, sites shown in orange represent actively restored forest sites and sites shown in purple represent naturally regenerating forest sites. Ecological restoration is currently being carried out in cooperation with three plantation companies in the Valparai plateau. For more information with respect to the weeding and active restoration protocol, please see methods in Hariharan and Raman (2021) and Osuri et al. (2019). Over the last two decades, the ecological restoration efforts have resulted in restoration of over 100 ha of degraded forests. This map was prepared using 30m resolution SRTM data (Farr et al. 2007) and ESRI satellite imagery is used as a basemap.</p>
</div>
</div>
<div id="main-text-figure-2" class="section level3 hasAnchor" number="0.1.5">
<h3><span class="header-section-number">0.1.5</span> Main Text Figure 2<a href="#main-text-figure-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure">
<img src="figs/fig02.png" alt="" />
<p class="caption"><strong>Ecological restoration across the Valparai plateau of the Anamalai hills.</strong>
(a) Images of an actively restored forest fragment (Selaliparai) were taken in 2007 and in 2021. Habitat and vegetation structure has responded positively to active restoration (Osuri et al. 2019) (Photo credit: T R Shankar Raman). (b) AudioMoth audio recorders were deployed across naturally regenerating, actively restored, and benchmark (not shown in picture) sites across the Valparai plateau (Photo credit: Vijay Ramesh).</p>
</div>

</div>
</div>
<div id="site-selection" class="section level2 hasAnchor" number="0.2">
<h2><span class="header-section-number">0.2</span> Site selection<a href="#site-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this script, we plot the elevation, distance to the nearest road, and distance between sites to show that the sites selected are comparable (we also followed site selection criteria outlined by Osuri et al., (2019) and Hariharan and Raman (2021) to ensure that sites are similar in terms of physiognomy and climate).</p>
<div id="install-required-libraries" class="section level3 hasAnchor" number="0.2.1">
<h3><span class="header-section-number">0.2.1</span> Install required libraries<a href="#install-required-libraries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(vegan)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(scico)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">library</span>(raster)</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co"># for plotting</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">library</span>(ggspatial)</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="fu">library</span>(colorspace)</span>
<span id="cb1-17"><a href="#cb1-17"></a></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="load-list-of-sites" class="section level2 hasAnchor" number="0.3">
<h2><span class="header-section-number">0.3</span> Load list of sites<a href="#load-list-of-sites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># read from local file</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>sites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/list-of-sites.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">filter</span>(Site.code <span class="sc">!=</span> <span class="st">&quot;OLCAP5B&quot;</span>) <span class="co"># removed this site as it was sampled in only one season and not across multiple seasons</span></span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># load a shapefile of the Western Ghats (here, I will use the boundary of the Nilgiris, Anamalais and Palanis)</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co"># this file can be used for plotting (if necessary)</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># hills &lt;- st_read(&quot;data/spatial/hillsShapefile/Nil_Ana_Pal.shp&quot;)</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># hills &lt;- st_transform(hills, 32643)</span></span></code></pre></div>
<div id="extract-elevation" class="section level3 hasAnchor" number="0.3.1">
<h3><span class="header-section-number">0.3.1</span> Extract elevation<a href="#extract-elevation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Extract elevation at each site and examine differences in elevation across treatment types</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># convert to sf object and transform</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>sites <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(sites, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="st">`</span><span class="at">st_crs&lt;-</span><span class="st">`</span>(<span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">st_transform</span>(<span class="dv">32643</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># add elevation raster</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>alt <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;data/spatial/elevation/alt&quot;</span>) <span class="co"># this layer is not added to github as a result of its large size and can be downloaded from SRTM (Farr et al. (2007))</span></span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"># extract values from that raster (note: transformation of coordinate system)</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>elev <span class="ot">&lt;-</span> <span class="fu">extract</span>(alt, sites)</span>
<span id="cb3-11"><a href="#cb3-11"></a>sites <span class="ot">&lt;-</span> <span class="fu">cbind</span>(sites, elev)</span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co"># Test if there are significant differences in elevation across treatment types</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>anovaElevAll <span class="ot">&lt;-</span> <span class="fu">aov</span>(elev<span class="sc">~</span>Restoration.type, <span class="at">data =</span> sites)</span>
<span id="cb3-15"><a href="#cb3-15"></a></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co"># Tukey test to study each pair of treatment - reveals no significant difference across treatment types</span></span>
<span id="cb3-17"><a href="#cb3-17"></a>tukeyElevAll <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anovaElevAll)</span>
<span id="cb3-18"><a href="#cb3-18"></a></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co"># Create a boxplot of elevation estimates by group (Here: group refers to Restoration Type)</span></span>
<span id="cb3-20"><a href="#cb3-20"></a></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>sites<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(sites<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co"># Add a custom set of colors</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>), <span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Paired&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb3-25"><a href="#cb3-25"></a></span>
<span id="cb3-26"><a href="#cb3-26"></a>fig_elevAll <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sites, <span class="fu">aes</span>(<span class="at">x=</span>Restoration.type, <span class="at">y=</span>elev, <span class="at">fill=</span>Restoration.type)) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb3-27"><a href="#cb3-27"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="sc">+</span> </span>
<span id="cb3-28"><a href="#cb3-28"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-29"><a href="#cb3-29"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb3-30"><a href="#cb3-30"></a>       <span class="at">y=</span><span class="st">&quot;Elevation (in meters)</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-31"><a href="#cb3-31"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb3-32"><a href="#cb3-32"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb3-33"><a href="#cb3-33"></a>      <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb3-34"><a href="#cb3-34"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb3-35"><a href="#cb3-35"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb3-36"><a href="#cb3-36"></a></span>
<span id="cb3-37"><a href="#cb3-37"></a><span class="co"># plot and save elevation</span></span>
<span id="cb3-38"><a href="#cb3-38"></a><span class="fu">ggsave</span>(fig_elevAll, <span class="at">filename =</span> <span class="st">&quot;figs/fig_elev.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>,</span>
<span id="cb3-39"><a href="#cb3-39"></a>       <span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig_elev.png" alt="" />
<p class="caption">We did not observe any significant difference in elevation across treatment types (Tukey HSD P &gt; 0.05)</p>
</div>
</div>
<div id="distance-to-nearest-road" class="section level3 hasAnchor" number="0.3.2">
<h3><span class="header-section-number">0.3.2</span> Distance to nearest road<a href="#distance-to-nearest-road" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculate distance to nearest road for each site and examine differences across treatment types.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># add roads data</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># Note: This shapefile was downloaded from Open Street Map at http://download.geofabrik.de/asia/india/southern-zone.html </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># This file is not uploaded to GitHub as it is extremely large and can be obtained from the link above</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>roads <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/spatial/roadsShapefiles/osm_roads_southIndia.shp&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">st_transform</span>(<span class="dv">32643</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># get index of the nearest road to a particular site</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>index <span class="ot">&lt;-</span> <span class="fu">st_nearest_feature</span>(sites, roads)</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co"># calculate distance between each site and the nearest road</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>distToRoad <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">st_distance</span>(sites, roads[index,], <span class="at">by_element=</span><span class="cn">TRUE</span>))</span>
<span id="cb4-12"><a href="#cb4-12"></a>sites <span class="ot">&lt;-</span> <span class="fu">cbind</span>(sites, distToRoad)</span>
<span id="cb4-13"><a href="#cb4-13"></a></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co"># Test if there are significant differences in distance to roads across treatment types</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>anovaDistAll <span class="ot">&lt;-</span> <span class="fu">aov</span>(distToRoad<span class="sc">~</span>Restoration.type, <span class="at">data =</span> sites)</span>
<span id="cb4-16"><a href="#cb4-16"></a></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co"># Tukey test to study each pair of treatment - no significant difference between AR-NR sites but a significant difference in distance to road between AR-BM and NR-BM sites</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>tukeyDistAll <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anovaDistAll)</span>
<span id="cb4-19"><a href="#cb4-19"></a></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="co"># Create a boxplot of distance to road estimates by group (Here: group refers to Restoration Type)</span></span>
<span id="cb4-21"><a href="#cb4-21"></a></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb4-23"><a href="#cb4-23"></a>sites<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(sites<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb4-24"><a href="#cb4-24"></a></span>
<span id="cb4-25"><a href="#cb4-25"></a>fig_distRoad <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sites, <span class="fu">aes</span>(<span class="at">x=</span>Restoration.type, <span class="at">y=</span>distToRoad, <span class="at">fill=</span>Restoration.type)) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb4-26"><a href="#cb4-26"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="sc">+</span></span>
<span id="cb4-27"><a href="#cb4-27"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb4-28"><a href="#cb4-28"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb4-29"><a href="#cb4-29"></a>       <span class="at">y=</span><span class="st">&quot;Distance to nearest road (in meters)</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-30"><a href="#cb4-30"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb4-31"><a href="#cb4-31"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb4-32"><a href="#cb4-32"></a>      <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb4-33"><a href="#cb4-33"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb4-34"><a href="#cb4-34"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb4-35"><a href="#cb4-35"></a></span>
<span id="cb4-36"><a href="#cb4-36"></a><span class="co"># plot and save above figure</span></span>
<span id="cb4-37"><a href="#cb4-37"></a><span class="fu">ggsave</span>(fig_distRoad, <span class="at">filename =</span> <span class="st">&quot;figs/fig_distRoad.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>,</span>
<span id="cb4-38"><a href="#cb4-38"></a>       <span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig_distRoad.png" alt="" />
<p class="caption">We did not observe any significant difference in distance to nearest road between AR and NR sites. However, the distance to nearest road for BM sites were significantly different from both AR and NR sites (Tukey HSD P &lt;0.05)</p>
</div>
</div>
<div id="distance-between-ar-nr-site-pairs" class="section level3 hasAnchor" number="0.3.3">
<h3><span class="header-section-number">0.3.3</span> Distance between AR-NR site pairs<a href="#distance-between-ar-nr-site-pairs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculate distances between actively restored and naturally regenerating sites that are paired.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Please note that there are only 12 site pairs as two AR sites and one NR site did not have a site-pair because they were too close to another AR/NR site in terms of their acoustic radius. </span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>sitePairs <span class="ot">&lt;-</span> sites <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">rename</span>(<span class="at">Site_ID =</span> Site.code) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">mutate</span>(<span class="at">Site.code =</span> <span class="fu">str_extract</span>(Site_ID, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Restoration.type <span class="sc">==</span> <span class="st">&quot;Benchmark&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Site.code <span class="sc">==</span> <span class="st">&quot;THEN10&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Site.code <span class="sc">==</span><span class="st">&quot;VAR210&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Site.code <span class="sc">==</span> <span class="st">&quot;INOA03&quot;</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a>AR <span class="ot">&lt;-</span> sitePairs[sitePairs<span class="sc">$</span>Restoration.type<span class="sc">==</span><span class="st">&quot;Active&quot;</span>,]</span>
<span id="cb5-12"><a href="#cb5-12"></a>NR <span class="ot">&lt;-</span> sitePairs[sitePairs<span class="sc">$</span>Restoration.type<span class="sc">==</span><span class="st">&quot;Passive&quot;</span>,]</span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a>sitePairDist <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(AR<span class="sc">$</span>geometry, NR<span class="sc">$</span>geometry, <span class="at">by_element =</span> T)</span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co"># The 12 site-pairs were at a minimum distance of 162 m to a maximum distance of 1.1 km.</span></span></code></pre></div>

</div>
</div>
<div id="processing-vegetation-data" class="section level2 hasAnchor" number="0.4">
<h2><span class="header-section-number">0.4</span> Processing vegetation data<a href="#processing-vegetation-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this script, we process vegetation data and examine differences in vegetation structure and composition across treatment types. Note: this analysis is provided as supporting information to showcase differences between AR, NR, and BM sites. In addition, we save results of principal component analyses for future statistical models.</p>
<div id="install-required-libraries-1" class="section level3 hasAnchor" number="0.4.1">
<h3><span class="header-section-number">0.4.1</span> Install required libraries<a href="#install-required-libraries-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="fu">library</span>(vegan)</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="fu">library</span>(scico)</span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="fu">library</span>(psych)</span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
<div id="load-the-vegetation-data" class="section level3 hasAnchor" number="0.4.2">
<h3><span class="header-section-number">0.4.2</span> Load the vegetation data<a href="#load-the-vegetation-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># load the .csv containing different vegetation variables (data collected by the Nature Conservation Foundation)</span></span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>veg <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/2020-vegetation-data.csv&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>veg<span class="sc">$</span>Site_ID <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(veg<span class="sc">$</span>Site_ID,<span class="st">&quot;_&quot;</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co"># load list of sites</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>sites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/list-of-sites.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="fu">filter</span>(Site.code <span class="sc">!=</span> <span class="st">&quot;OLCAP5B&quot;</span>)</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co"># join dataframes to obtain vegetation data for only the required list of sites</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>veg <span class="ot">&lt;-</span> <span class="fu">right_join</span>(veg,sites, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site_ID&quot;</span><span class="ot">=</span><span class="st">&quot;Site.code&quot;</span>))</span>
<span id="cb7-12"><a href="#cb7-12"></a></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co"># renaming restoration type column</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>veg<span class="sc">$</span>Site_type[veg<span class="sc">$</span>Site_type<span class="sc">==</span><span class="st">&quot;Unrestored&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Passive&quot;</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>veg<span class="sc">$</span>Site_type[veg<span class="sc">$</span>Site_type<span class="sc">==</span><span class="st">&quot;Restored&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Active&quot;</span></span></code></pre></div>
</div>
<div id="process-habitat-structure-variables" class="section level3 hasAnchor" number="0.4.3">
<h3><span class="header-section-number">0.4.3</span> Process habitat structure variables<a href="#process-habitat-structure-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Carrying out exploratory analysis and preparing a dataframe for further steps</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Counting number of tree species and unique species per plot</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>treerich <span class="ot">&lt;-</span> veg <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">group_by</span>(Site_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">summarise</span> (<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">richness =</span> <span class="fu">n_distinct</span>(tree_species))</span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># Calculate average tree height across each unique site</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>treeheight <span class="ot">&lt;-</span> veg <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">drop_na</span>(height) <span class="sc">%&gt;%</span> </span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="fu">group_by</span>(Site_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10"></a>  <span class="fu">summarise</span>(<span class="at">height =</span> <span class="fu">mean</span>(height))</span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co"># Calculate basal area and left join with other data</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>basal_area <span class="ot">&lt;-</span> veg <span class="sc">%&gt;%</span> </span>
<span id="cb8-14"><a href="#cb8-14"></a>  <span class="fu">mutate</span>(<span class="at">basal_sum =</span> <span class="fu">rowSums</span>(veg[,<span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">15</span>)]<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">4</span><span class="sc">*</span>pi)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Site_ID, Site_type) <span class="sc">%&gt;%</span> </span>
<span id="cb8-15"><a href="#cb8-15"></a>  <span class="fu">summarise</span>(<span class="at">basal_area =</span> <span class="fu">sum</span>(basal_sum)) </span>
<span id="cb8-16"><a href="#cb8-16"></a></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co"># Calculate average canopy height</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>canopy_height <span class="ot">&lt;-</span> veg <span class="sc">%&gt;%</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>  <span class="fu">group_by</span>(Site_ID) <span class="sc">%&gt;%</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>  <span class="fu">summarise</span>(<span class="at">canopy_cover =</span> <span class="fu">mean</span>(Canopy_cover))</span>
<span id="cb8-21"><a href="#cb8-21"></a></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co"># Calculate average leaf litter</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>leaf_litter <span class="ot">&lt;-</span> veg <span class="sc">%&gt;%</span></span>
<span id="cb8-24"><a href="#cb8-24"></a>  <span class="fu">group_by</span>(Site_ID) <span class="sc">%&gt;%</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>  <span class="fu">summarise</span>(<span class="at">leaf_litter =</span> <span class="fu">mean</span>(Leaf_litter))</span>
<span id="cb8-26"><a href="#cb8-26"></a></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co"># Calculate average vertical stratification</span></span>
<span id="cb8-28"><a href="#cb8-28"></a>vert_strat <span class="ot">&lt;-</span> veg <span class="sc">%&gt;%</span></span>
<span id="cb8-29"><a href="#cb8-29"></a>  <span class="fu">group_by</span>(Site_ID) <span class="sc">%&gt;%</span></span>
<span id="cb8-30"><a href="#cb8-30"></a>  <span class="fu">summarise</span>(<span class="at">vert_strat =</span> <span class="fu">mean</span>(Foliage_score))</span>
<span id="cb8-31"><a href="#cb8-31"></a></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="co"># Year of planting</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>plantingYear <span class="ot">&lt;-</span> veg <span class="sc">%&gt;%</span></span>
<span id="cb8-34"><a href="#cb8-34"></a>  <span class="fu">group_by</span>(Site_ID) <span class="sc">%&gt;%</span></span>
<span id="cb8-35"><a href="#cb8-35"></a>  <span class="fu">summarise</span>(<span class="at">plantingYear =</span> <span class="fu">unique</span>(Year.of.planting))</span>
<span id="cb8-36"><a href="#cb8-36"></a></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="co"># Creating a final dataframe for further analysis</span></span>
<span id="cb8-38"><a href="#cb8-38"></a>allVeg <span class="ot">&lt;-</span> basal_area <span class="sc">%&gt;%</span> </span>
<span id="cb8-39"><a href="#cb8-39"></a>  <span class="fu">left_join</span>(treeheight) <span class="sc">%&gt;%</span></span>
<span id="cb8-40"><a href="#cb8-40"></a>  <span class="fu">left_join</span>(treerich) <span class="sc">%&gt;%</span></span>
<span id="cb8-41"><a href="#cb8-41"></a>  <span class="fu">left_join</span>(canopy_height) <span class="sc">%&gt;%</span></span>
<span id="cb8-42"><a href="#cb8-42"></a>  <span class="fu">left_join</span>(leaf_litter) <span class="sc">%&gt;%</span></span>
<span id="cb8-43"><a href="#cb8-43"></a>  <span class="fu">left_join</span>(vert_strat) <span class="sc">%&gt;%</span></span>
<span id="cb8-44"><a href="#cb8-44"></a>  <span class="fu">left_join</span>(plantingYear)</span>
<span id="cb8-45"><a href="#cb8-45"></a></span>
<span id="cb8-46"><a href="#cb8-46"></a><span class="fu">write.csv</span>(allVeg, <span class="st">&quot;data/summaryVeg.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="principal-component-analysis-of-vegetation-data" class="section level3 hasAnchor" number="0.4.4">
<h3><span class="header-section-number">0.4.4</span> Principal component analysis of vegetation data<a href="#principal-component-analysis-of-vegetation-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Check for correlations among vegetation predictors</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">pairs.panels</span>(allVeg[,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>])</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># The above panel suggests that richness is highly correlated with a number of predictors including canopy cover, count and basal area. We will calculate a PCA and keep the top two explanatory axes</span></span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a>vegPca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(allVeg[, <span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>], <span class="at">scale=</span><span class="cn">TRUE</span>, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">retx=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="fu">summary</span>(vegPca)</span>
<span id="cb9-8"><a href="#cb9-8"></a></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co"># The proportion of variance explained by the first two axes account for ~73.42%</span></span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co"># Extract PCA values</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>PCAvalues <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;Site_ID&#39;</span><span class="ot">=</span>allVeg<span class="sc">$</span>Site_ID, <span class="st">&#39;Site_type&#39;</span> <span class="ot">=</span> allVeg<span class="sc">$</span>Site_type, vegPca<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="co"># the first two components are selected </span></span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co"># save the data for use in a GLM later</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="fu">write.csv</span>(PCAvalues,<span class="st">&quot;data/pcaVeg.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb9-16"><a href="#cb9-16"></a></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co"># Extract loadings of the variables</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>PCAloadings <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variables =</span> <span class="fu">rownames</span>(vegPca<span class="sc">$</span>rotation), vegPca<span class="sc">$</span>rotation)</span>
<span id="cb9-19"><a href="#cb9-19"></a></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co"># figure below</span></span>
<span id="cb9-21"><a href="#cb9-21"></a></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co"># Add a custom set of colors</span></span>
<span id="cb9-23"><a href="#cb9-23"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>), <span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Paired&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb9-24"><a href="#cb9-24"></a></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>PCAvalues<span class="sc">$</span>Site_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(PCAvalues<span class="sc">$</span>Site_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb9-27"><a href="#cb9-27"></a></span>
<span id="cb9-28"><a href="#cb9-28"></a>fig_pca <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PCAvalues, <span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">colour =</span> Site_type)) <span class="sc">+</span> </span>
<span id="cb9-29"><a href="#cb9-29"></a>       <span class="fu">geom_segment</span>(<span class="at">data =</span> PCAloadings, <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> (PC1<span class="sc">*</span><span class="dv">5</span>),</span>
<span id="cb9-30"><a href="#cb9-30"></a>     <span class="at">yend =</span> (PC2<span class="sc">*</span><span class="dv">5</span>)), <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="st">&quot;picas&quot;</span>)),</span>
<span id="cb9-31"><a href="#cb9-31"></a>     <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-32"><a href="#cb9-32"></a>     <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">shape=</span> Site_type, <span class="at">colour =</span> Site_type),<span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span>        <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> (PCAloadings<span class="sc">$</span>PC1<span class="sc">*</span><span class="dv">3</span>), <span class="at">y =</span> (PCAloadings<span class="sc">$</span>PC2<span class="sc">*</span><span class="dv">3</span>),</span>
<span id="cb9-33"><a href="#cb9-33"></a>     <span class="at">label =</span> PCAloadings<span class="sc">$</span>variables, <span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb9-34"><a href="#cb9-34"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb9-35"><a href="#cb9-35"></a>     <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&quot;PC1 (54.67%)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9-36"><a href="#cb9-36"></a>     <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">&quot;PC2 (18.74%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-37"><a href="#cb9-37"></a>     <span class="fu">scale_color_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values =</span> mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>)) <span class="sc">+</span>     <span class="fu">scale_shape_manual</span>(<span class="st">&quot;Treatment type&quot;</span>, <span class="at">values=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(PCAvalues<span class="sc">$</span>Site_type)), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="sc">+</span></span>
<span id="cb9-38"><a href="#cb9-38"></a>     <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb9-39"><a href="#cb9-39"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb9-40"><a href="#cb9-40"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb9-41"><a href="#cb9-41"></a>                                    <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb9-42"><a href="#cb9-42"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb9-43"><a href="#cb9-43"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb9-44"><a href="#cb9-44"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb9-45"><a href="#cb9-45"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb9-46"><a href="#cb9-46"></a></span>
<span id="cb9-47"><a href="#cb9-47"></a><span class="fu">ggsave</span>(fig_pca, <span class="at">filename =</span> <span class="st">&quot;figs/fig_pca.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>,<span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig_pca.png" alt="" />
<p class="caption">Principal component analysis of vegetation data shows that AR sites were situated between BM and NR sites. Please see Hariharan and Raman 2021 and Osuri et al. 2019 for more analysis using vegetation data.</p>
</div>

</div>
</div>
<div id="acoustic-space-use" class="section level2 hasAnchor" number="0.5">
<h2><span class="header-section-number">0.5</span> Acoustic space use<a href="#acoustic-space-use" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this study, acoustic space use reflects the amount and pattern of vocalizations within each frequency bin for a given time period.</p>
<p>Previous papers calculated acoustic space use by ascertaining the proportion of recordings in a particular time and frequency bin that is above a certain amplitude. However, this proportion was estimated by counting the number of frequency peaks within a given recording (see <em>seewave::fpeaks()</em>) and then scaling it to go from 0 to 1. In our analysis, we want to obtain an understanding of the overall acoustic activity for a given time and frequency bin. In other words, we want the area under the curve for a particular frequency contour.</p>
<p><em>Note</em> From Sound Analysis and Synthesis with R by Jerome Sueur</p>
<p>“The basic premise in calculating ASU is that we compute a Short-time discrete fourier transform for a given frequency bin size (obtained by dividing the sampling frequency/window length over which the fourier transform is computed, for example 48000Hz/256 = 187.5 is the bin size). However, the size of the frequency bin is inversely proportional to time (Uncertainty principle; Pg.312) which would mean a bin size of 187.5 corresponds to a time duration of 0.005s (1/187.5=0.005s). Ultimately what matters is a compromise between frequency resolution and temporal resolution (Fig 11.3; Pg. 313).”</p>
<div id="install-necessary-libraries" class="section level3 hasAnchor" number="0.5.1">
<h3><span class="header-section-number">0.5.1</span> Install necessary libraries<a href="#install-necessary-libraries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">library</span>(seewave)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">library</span>(warbleR)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="fu">library</span>(tuneR)</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="fu">library</span>(stringi)</span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="fu">library</span>(foreach)</span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="fu">library</span>(doSNOW)</span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="fu">library</span>(rlist)</span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb10-13"><a href="#cb10-13"></a></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
<p>Below, we have summarized approaches taken by previous studies:</p>
<p>Aide et al. 2017 aggregated recordings at time scale of hour of day and used a frequency bin size of 86.13 Hz and an amplitude filtering threshold of 0.02. So if the sampling rate is 22000 Hz, that would mean - 22000/86.13 ~ 256 frequency bins to divide up the frequency space. In this paper, there would be 24hr*256 bins = 6144 time/frequency bins.</p>
<p>Campos-Cerqueira et al. 2019 aggregated recordings at the time scale of hour of day (24 h), used a frequency bin size of 172 Hz, and an amplitude filtering threshold of 0.003. So if the sampling rate is 22000 Hz, that would mean - 22000/172 ~ 128 frequency bins. This resulted in a three‐dimensional (x = hour, y = acoustic frequency, z = proportion of all recordings in each time/frequency bin with a frequency peak value &gt; 0.003 amplitude) matrix of acoustic activity with a total of 3,072 time/frequency bins (24 h × 128 frequency bins).</p>
<p>Campos-Cerqueira and Aide 2017 used the meanspec (f = 44,100, wl = 256, wn = “hanning”) and fpeaks (threshold = 0.1, freq = 172) function from the seewave package in R (Sueur et al., 2008a). The value of each peak was normalized using the maximum amplitude value within all recordings in the soundscape (i.e., site), and thus values ranged from 0 to 1. The number of frequency peaks was determined by counting the number of recordings with a peak within each of the 128 frequency bins that were equal or greater than the amplitude threshold. To control for the different number of recordings in each site and each time interval (i.e., hour), we divided the number of recordings with a peak in each time/frequency class by the total number of recordings collected during each hourly interval.</p>
</div>
<div id="load-recordings-across-multiple-days-and-sites" class="section level3 hasAnchor" number="0.5.2">
<h3><span class="header-section-number">0.5.2</span> Load recordings across multiple days and sites<a href="#load-recordings-across-multiple-days-and-sites" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we examined all unique sites and dates for which we had a continuous 24 hours of recordings.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># List the path that contains all folders, which contain the audiomoth data</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;D:</span><span class="sc">\\</span><span class="st">2020-summer</span><span class="sc">\\</span><span class="st">&quot;</span> <span class="co"># change the path depending on where the raw data is</span></span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co"># Listing the folders within which .WAV files are stored</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>folders <span class="ot">&lt;-</span> <span class="fu">dir</span>(path, <span class="at">recursive=</span>F,<span class="at">full.names=</span>T)</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="do">###### Please note ######</span></span>
<span id="cb11-8"><a href="#cb11-8"></a></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co"># The below set of lines need to be run only once for a given set of sites and days. </span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co"># Let&#39;s first rename the files by name of each site (as prefix)</span></span>
<span id="cb11-11"><a href="#cb11-11"></a></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(folders)){</span>
<span id="cb11-13"><a href="#cb11-13"></a></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="fu">setwd</span>(folders[i])</span>
<span id="cb11-15"><a href="#cb11-15"></a>  </span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co"># List the files within each folder and renaming the files with the prefix - SITE_ID</span></span>
<span id="cb11-17"><a href="#cb11-17"></a>a <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">paste0</span>(path,<span class="fu">basename</span>(folders)[i],<span class="st">&quot;</span><span class="sc">\\</span><span class="st">&quot;</span>), <span class="at">full.names =</span> T)</span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="fu">file.rename</span>(<span class="at">from =</span> a, <span class="at">to=</span><span class="fu">paste0</span>(<span class="fu">basename</span>(folders)[i],<span class="st">&quot;_&quot;</span>,<span class="fu">basename</span>(a)))</span>
<span id="cb11-19"><a href="#cb11-19"></a>}</span>
<span id="cb11-20"><a href="#cb11-20"></a></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="do">###### Ending note here ######</span></span>
<span id="cb11-22"><a href="#cb11-22"></a></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="co"># Now get only those files for a full 24 hours across every unique site</span></span>
<span id="cb11-24"><a href="#cb11-24"></a>files <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-25"><a href="#cb11-25"></a></span>
<span id="cb11-26"><a href="#cb11-26"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(folders)){</span>
<span id="cb11-27"><a href="#cb11-27"></a></span>
<span id="cb11-28"><a href="#cb11-28"></a>a <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">paste0</span>(path,<span class="fu">basename</span>(folders)[i],<span class="st">&quot;</span><span class="sc">\\</span><span class="st">&quot;</span>), <span class="at">full.names =</span> T)</span>
<span id="cb11-29"><a href="#cb11-29"></a>site_date <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(<span class="fu">basename</span>(a),<span class="st">&#39;</span><span class="sc">\\</span><span class="st">w+_</span><span class="sc">\\</span><span class="st">d+_&#39;</span>)</span>
<span id="cb11-30"><a href="#cb11-30"></a></span>
<span id="cb11-31"><a href="#cb11-31"></a><span class="co"># Choosing all 24 hours of data across every unique site (288 corresponds to 12 files every 1 hour)</span></span>
<span id="cb11-32"><a href="#cb11-32"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(site_date))){</span>
<span id="cb11-33"><a href="#cb11-33"></a>    dat <span class="ot">&lt;-</span> a[<span class="fu">str_detect</span>(a,<span class="fu">unique</span>(site_date)[j])]</span>
<span id="cb11-34"><a href="#cb11-34"></a>    <span class="cf">if</span>((<span class="fu">length</span>(dat)<span class="sc">&lt;</span><span class="dv">288</span>)<span class="sc">==</span><span class="cn">TRUE</span>){</span>
<span id="cb11-35"><a href="#cb11-35"></a>      <span class="cf">next</span></span>
<span id="cb11-36"><a href="#cb11-36"></a>    } <span class="cf">else</span> {</span>
<span id="cb11-37"><a href="#cb11-37"></a>      files <span class="ot">&lt;-</span> <span class="fu">c</span>(files, dat) </span>
<span id="cb11-38"><a href="#cb11-38"></a>    }</span>
<span id="cb11-39"><a href="#cb11-39"></a>  }</span>
<span id="cb11-40"><a href="#cb11-40"></a>}</span>
<span id="cb11-41"><a href="#cb11-41"></a></span>
<span id="cb11-42"><a href="#cb11-42"></a>files <span class="ot">&lt;-</span> <span class="fu">unlist</span>(files)</span></code></pre></div>
</div>
<div id="short-time-discrete-fourier-transform-stdft" class="section level3 hasAnchor" number="0.5.3">
<h3><span class="header-section-number">0.5.3</span> Short-time discrete fourier transform (STDFT)<a href="#short-time-discrete-fourier-transform-stdft" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To compute an STDFT, we shall begin with an audio recording that has a sampling rate of s = 48,000 Hz and a window length (for the STDFT) wl = 256 samples, which results in a frequency bin size of z = 187.5 Hz (where z = s/wl). Given the sampling rate s, our Nyquist frequency f = 24,000 Hz (where f = s/2), and therefore, the total number of frequency bins across which an STDFT was run is n = 128 frequency bins (n = f/z). The final output of an STDFT corresponds to a matrix of N * m fourier coefficients (N = length of the audio recording and m = number of frequency bins). In this study, we computed STDFT across 24 hours of audio recordings, which translates to a matrix of 3072 (24 hours * 128 bins) fourier coefficients (Campos-Cerqueira et al. 2019). This matrix of coefficients essentially corresponds to ASU (or a measure of space ’used, for every hour of a day across the 128 bins in this study). Prior to computing STDFTs and ASU values, we set a threshold amplitude of 0.003 dB for audio recordings (following Campos-Cerqueira et al. 2019 and examination of our data).</p>
<p>To calculate ASU, we selected five consecutive days of acoustic data (24 continuous hours of data) across each site. Five days was the minimum number of days of consecutive sampling without disruptions across sites (eg. memory card switching/battery replacements/failure of equipment etc.).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Select all unique site_date combinations for each unique site</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>site_date <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(<span class="fu">basename</span>(files),<span class="st">&#39;</span><span class="sc">\\</span><span class="st">w+_</span><span class="sc">\\</span><span class="st">d+_&#39;</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="fu">unique</span>(site_date)</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># The only step that involves sub-selection (Selecting 5 days across each site; Note: IPTO06R has 3 days sampled and OLV110R has only 2 days sampled)</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>site_date <span class="ot">&lt;-</span> <span class="fu">unique</span>(site_date)[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">14</span>,<span class="dv">19</span><span class="sc">:</span><span class="dv">23</span>,<span class="dv">28</span><span class="sc">:</span><span class="dv">47</span>,<span class="dv">52</span><span class="sc">:</span><span class="dv">61</span>,<span class="dv">71</span><span class="sc">:</span><span class="dv">75</span>,</span>
<span id="cb12-7"><a href="#cb12-7"></a>                             <span class="dv">86</span><span class="sc">:</span><span class="dv">90</span>,<span class="dv">97</span><span class="sc">:</span><span class="dv">101</span>,<span class="dv">107</span><span class="sc">:</span><span class="dv">111</span>,<span class="dv">118</span><span class="sc">:</span><span class="dv">122</span>,<span class="dv">130</span><span class="sc">:</span><span class="dv">134</span>,</span>
<span id="cb12-8"><a href="#cb12-8"></a>                             <span class="dv">141</span><span class="sc">:</span><span class="dv">143</span>,<span class="dv">150</span><span class="sc">:</span><span class="dv">154</span>,<span class="dv">161</span><span class="sc">:</span><span class="dv">165</span>,<span class="dv">173</span><span class="sc">:</span><span class="dv">177</span>,<span class="dv">188</span><span class="sc">:</span><span class="dv">189</span>,</span>
<span id="cb12-9"><a href="#cb12-9"></a>                             <span class="dv">193</span><span class="sc">:</span><span class="dv">197</span>,<span class="dv">202</span><span class="sc">:</span><span class="dv">206</span>,<span class="dv">211</span><span class="sc">:</span><span class="dv">215</span>,<span class="dv">219</span><span class="sc">:</span><span class="dv">223</span>,<span class="dv">225</span><span class="sc">:</span><span class="dv">229</span>,</span>
<span id="cb12-10"><a href="#cb12-10"></a>                             <span class="dv">231</span><span class="sc">:</span><span class="dv">235</span>,<span class="dv">237</span><span class="sc">:</span><span class="dv">241</span>,<span class="dv">249</span><span class="sc">:</span><span class="dv">253</span>,<span class="dv">261</span><span class="sc">:</span><span class="dv">265</span>,<span class="dv">269</span><span class="sc">:</span><span class="dv">273</span>,</span>
<span id="cb12-11"><a href="#cb12-11"></a>                             <span class="dv">281</span><span class="sc">:</span><span class="dv">285</span>,<span class="dv">289</span><span class="sc">:</span><span class="dv">293</span>,<span class="dv">300</span><span class="sc">:</span><span class="dv">304</span>,<span class="dv">309</span><span class="sc">:</span><span class="dv">313</span>,<span class="dv">319</span><span class="sc">:</span><span class="dv">323</span>,</span>
<span id="cb12-12"><a href="#cb12-12"></a>                             <span class="dv">329</span><span class="sc">:</span><span class="dv">333</span>,<span class="dv">340</span><span class="sc">:</span><span class="dv">344</span>,<span class="dv">351</span><span class="sc">:</span><span class="dv">355</span>,<span class="dv">361</span><span class="sc">:</span><span class="dv">365</span>,<span class="dv">370</span><span class="sc">:</span><span class="dv">374</span>,</span>
<span id="cb12-13"><a href="#cb12-13"></a>                             <span class="dv">378</span><span class="sc">:</span><span class="dv">382</span>,<span class="dv">387</span><span class="sc">:</span><span class="dv">391</span>,<span class="dv">396</span><span class="sc">:</span><span class="dv">400</span>)]</span>
<span id="cb12-14"><a href="#cb12-14"></a></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co"># Create a sequence of numbers to combine files by 1 hour</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>hour_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">288</span>, <span class="at">by=</span><span class="dv">12</span>)</span>
<span id="cb12-17"><a href="#cb12-17"></a></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co"># To name files with a suffix for each hour</span></span>
<span id="cb12-19"><a href="#cb12-19"></a>time_of_day <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;00:00-01:00&quot;</span>,<span class="st">&quot;01:00-02:00&quot;</span>,<span class="st">&quot;02:00-03:00&quot;</span>,<span class="st">&quot;03:00-04:00&quot;</span>,</span>
<span id="cb12-20"><a href="#cb12-20"></a>                 <span class="st">&quot;04:00-05:00&quot;</span>,<span class="st">&quot;05:00-06:00&quot;</span>,<span class="st">&quot;06:00-07:00&quot;</span>,<span class="st">&quot;07:00-08:00&quot;</span>,</span>
<span id="cb12-21"><a href="#cb12-21"></a>                 <span class="st">&quot;08:00-09:00&quot;</span>,<span class="st">&quot;09:00-10:00&quot;</span>,<span class="st">&quot;10:00-11:00&quot;</span>,<span class="st">&quot;11:00-12:00&quot;</span>,</span>
<span id="cb12-22"><a href="#cb12-22"></a>                 <span class="st">&quot;12:00-13:00&quot;</span>,<span class="st">&quot;13:00-14:00&quot;</span>,<span class="st">&quot;14:00-15:00&quot;</span>,<span class="st">&quot;15:00-16:00&quot;</span>,</span>
<span id="cb12-23"><a href="#cb12-23"></a>                 <span class="st">&quot;16:00-17:00&quot;</span>,<span class="st">&quot;17:00-18:00&quot;</span>,<span class="st">&quot;18:00-19:00&quot;</span>,<span class="st">&quot;19:00-20:00&quot;</span>,</span>
<span id="cb12-24"><a href="#cb12-24"></a>                 <span class="st">&quot;20:00-21:00&quot;</span>,<span class="st">&quot;21:00-22:00&quot;</span>,<span class="st">&quot;22:00-23:00&quot;</span>,<span class="st">&quot;23:00-24:00&quot;</span>)</span>
<span id="cb12-25"><a href="#cb12-25"></a></span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="co"># Loading parameters necessary for the Short-term fourier transform to be performed on hourly aggregates of data for each site_date combination</span></span>
<span id="cb12-27"><a href="#cb12-27"></a>f <span class="ot">&lt;-</span> <span class="dv">48000</span></span>
<span id="cb12-28"><a href="#cb12-28"></a>wl <span class="ot">&lt;-</span> <span class="dv">256</span> <span class="co"># This window length should be changed as a function of the frequency resolution (ie. bin size) and temporal resolution (ie. time)</span></span>
<span id="cb12-29"><a href="#cb12-29"></a>ovlp <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb12-30"><a href="#cb12-30"></a>wn <span class="ot">&lt;-</span> <span class="st">&quot;hanning&quot;</span></span>
<span id="cb12-31"><a href="#cb12-31"></a></span>
<span id="cb12-32"><a href="#cb12-32"></a><span class="co"># Store the 24 hour acoustic space use data in a list and name it by a unique site and date</span></span>
<span id="cb12-33"><a href="#cb12-33"></a>site_date_asu <span class="ot">&lt;-</span>  <span class="fu">list</span>()</span>
<span id="cb12-34"><a href="#cb12-34"></a></span>
<span id="cb12-35"><a href="#cb12-35"></a><span class="co"># Add a progress bar for the loop</span></span>
<span id="cb12-36"><a href="#cb12-36"></a>pb <span class="ot">&lt;-</span> <span class="fu">txtProgressBar</span>(</span>
<span id="cb12-37"><a href="#cb12-37"></a>  <span class="at">min =</span> <span class="dv">0</span>,</span>
<span id="cb12-38"><a href="#cb12-38"></a>  <span class="at">max =</span> <span class="fu">length</span>(<span class="fu">unique</span>(site_date)),</span>
<span id="cb12-39"><a href="#cb12-39"></a>  <span class="at">style =</span> <span class="dv">3</span></span>
<span id="cb12-40"><a href="#cb12-40"></a>)</span>
<span id="cb12-41"><a href="#cb12-41"></a></span>
<span id="cb12-42"><a href="#cb12-42"></a><span class="co"># Select only 24 hours of data (00:00:00 to 23:55:00) for every unique site-date</span></span>
<span id="cb12-43"><a href="#cb12-43"></a></span>
<span id="cb12-44"><a href="#cb12-44"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(site_date))){ </span>
<span id="cb12-45"><a href="#cb12-45"></a>  </span>
<span id="cb12-46"><a href="#cb12-46"></a>  <span class="fu">tic</span>(<span class="st">&quot;Total time for a single site-day combination&quot;</span>)</span>
<span id="cb12-47"><a href="#cb12-47"></a>  </span>
<span id="cb12-48"><a href="#cb12-48"></a>  <span class="co"># Store the acoustic space use data in a data.frame for plotting and analysis</span></span>
<span id="cb12-49"><a href="#cb12-49"></a>  space_use <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb12-50"><a href="#cb12-50"></a></span>
<span id="cb12-51"><a href="#cb12-51"></a>  <span class="co"># Extract the strings first by site </span></span>
<span id="cb12-52"><a href="#cb12-52"></a>  dat <span class="ot">&lt;-</span> files[stringr<span class="sc">::</span><span class="fu">str_detect</span>(files,<span class="fu">unique</span>(site_date)[i])]</span>
<span id="cb12-53"><a href="#cb12-53"></a>  </span>
<span id="cb12-54"><a href="#cb12-54"></a>  <span class="co"># Parallelize the runs</span></span>
<span id="cb12-55"><a href="#cb12-55"></a>  cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">6</span>, <span class="at">type =</span> <span class="st">&quot;SOCK&quot;</span>)</span>
<span id="cb12-56"><a href="#cb12-56"></a>  <span class="fu">registerDoSNOW</span>(cl)</span>
<span id="cb12-57"><a href="#cb12-57"></a>  </span>
<span id="cb12-58"><a href="#cb12-58"></a>  <span class="co"># Store the each hour of data for an entire day as a list here (raw audio files read by tuneR::readWave())</span></span>
<span id="cb12-59"><a href="#cb12-59"></a>  <span class="fu">tic</span>(<span class="st">&quot;Reading in .WAV files&quot;</span>)</span>
<span id="cb12-60"><a href="#cb12-60"></a>  dailydata <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">k=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dat), <span class="at">.combine =</span> <span class="st">&#39;c&#39;</span>, <span class="at">.inorder =</span> T, <span class="at">.packages =</span> <span class="st">&#39;tuneR&#39;</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb12-61"><a href="#cb12-61"></a>    r <span class="ot">&lt;-</span> <span class="fu">readWave</span>(dat[k])</span>
<span id="cb12-62"><a href="#cb12-62"></a>  }</span>
<span id="cb12-63"><a href="#cb12-63"></a>  <span class="fu">toc</span>()</span>
<span id="cb12-64"><a href="#cb12-64"></a>  <span class="fu">gc</span>()</span>
<span id="cb12-65"><a href="#cb12-65"></a>  <span class="fu">stopCluster</span>(cl)</span>
<span id="cb12-66"><a href="#cb12-66"></a>  </span>
<span id="cb12-67"><a href="#cb12-67"></a>  <span class="co"># renaming the files to ensure that data is read in hour by hour and stored in a separate object called hourlydata</span></span>
<span id="cb12-68"><a href="#cb12-68"></a>  <span class="co"># Below we read the first 12 files in and then save it after computing the STDFT and then repeating it for the next 12 files and so on</span></span>
<span id="cb12-69"><a href="#cb12-69"></a>  </span>
<span id="cb12-70"><a href="#cb12-70"></a>  <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(hour_seq)<span class="sc">-</span><span class="dv">1</span>)) { <span class="co"># Every 12 files correspond to one hour </span></span>
<span id="cb12-71"><a href="#cb12-71"></a>    <span class="fu">tic</span>(<span class="st">&quot;Computing Short-term fourier transforms for each hour&quot;</span>)</span>
<span id="cb12-72"><a href="#cb12-72"></a>    <span class="cf">if</span> (t <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb12-73"><a href="#cb12-73"></a>    hourlydata <span class="ot">&lt;-</span> dailydata[hour_seq[t]<span class="sc">:</span>hour_seq[t<span class="sc">+</span><span class="dv">1</span>]]</span>
<span id="cb12-74"><a href="#cb12-74"></a>    } <span class="cf">else</span> {</span>
<span id="cb12-75"><a href="#cb12-75"></a>    hourlydata <span class="ot">&lt;-</span> dailydata[(hour_seq[t]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>hour_seq[t<span class="sc">+</span><span class="dv">1</span>]]</span>
<span id="cb12-76"><a href="#cb12-76"></a>    }</span>
<span id="cb12-77"><a href="#cb12-77"></a>    </span>
<span id="cb12-78"><a href="#cb12-78"></a>  <span class="fu">gc</span>()</span>
<span id="cb12-79"><a href="#cb12-79"></a>  </span>
<span id="cb12-80"><a href="#cb12-80"></a>  <span class="co"># Parallelize the runs</span></span>
<span id="cb12-81"><a href="#cb12-81"></a>  cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">6</span>, <span class="at">type =</span> <span class="st">&quot;SOCK&quot;</span>)</span>
<span id="cb12-82"><a href="#cb12-82"></a>  <span class="fu">registerDoSNOW</span>(cl)</span>
<span id="cb12-83"><a href="#cb12-83"></a>  </span>
<span id="cb12-84"><a href="#cb12-84"></a>  <span class="co"># Store every hour&#39;s ASU data here</span></span>
<span id="cb12-85"><a href="#cb12-85"></a>  data_per_hour <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">z =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(hourlydata), <span class="at">.combine =</span> <span class="st">&#39;rbind&#39;</span>,</span>
<span id="cb12-86"><a href="#cb12-86"></a>                           <span class="at">.inorder=</span>T, <span class="at">.packages =</span> <span class="st">&#39;seewave&#39;</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb12-87"><a href="#cb12-87"></a>      wave <span class="ot">&lt;-</span> hourlydata[[z]] </span>
<span id="cb12-88"><a href="#cb12-88"></a>      n <span class="ot">&lt;-</span> <span class="fu">length</span>(wave)</span>
<span id="cb12-89"><a href="#cb12-89"></a>        </span>
<span id="cb12-90"><a href="#cb12-90"></a>      <span class="do">## Short-term Fourier transform (using a seewave internal function)</span></span>
<span id="cb12-91"><a href="#cb12-91"></a>      m <span class="ot">&lt;-</span> <span class="fu">sspectro</span>(wave, <span class="at">f =</span> f, <span class="at">wl =</span> wl, <span class="at">ovlp =</span> ovlp, <span class="at">wn =</span> wn)</span>
<span id="cb12-92"><a href="#cb12-92"></a></span>
<span id="cb12-93"><a href="#cb12-93"></a>      <span class="co"># Frequency selection and frequency axis</span></span>
<span id="cb12-94"><a href="#cb12-94"></a>      <span class="co"># Here, want only a sequence of numbers that correspond to the length of rows       # of the short-time fourier transform and we divide it by 1000 to get values        # in kHz</span></span>
<span id="cb12-95"><a href="#cb12-95"></a>      freq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, (f<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> (f<span class="sc">/</span>wl), <span class="at">length.out =</span> <span class="fu">nrow</span>(m))<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb12-96"><a href="#cb12-96"></a>        </span>
<span id="cb12-97"><a href="#cb12-97"></a>      <span class="co"># Calculate acoustic space use per frequency bin </span></span>
<span id="cb12-98"><a href="#cb12-98"></a>      f.cont <span class="ot">&lt;-</span> <span class="fu">apply</span>(m, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> sum)</span>
<span id="cb12-99"><a href="#cb12-99"></a>        </span>
<span id="cb12-100"><a href="#cb12-100"></a>      <span class="co"># Store the space use data in a dataframe for plotting later</span></span>
<span id="cb12-101"><a href="#cb12-101"></a>      a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(freq, f.cont)</span>
<span id="cb12-102"><a href="#cb12-102"></a>    }</span>
<span id="cb12-103"><a href="#cb12-103"></a>  </span>
<span id="cb12-104"><a href="#cb12-104"></a>  <span class="fu">rm</span>(hourlydata); <span class="fu">gc</span>()</span>
<span id="cb12-105"><a href="#cb12-105"></a>    </span>
<span id="cb12-106"><a href="#cb12-106"></a>  data_per_hour  <span class="ot">&lt;-</span> data_per_hour <span class="sc">%&gt;%</span></span>
<span id="cb12-107"><a href="#cb12-107"></a>  <span class="fu">group_by</span>(freq) <span class="sc">%&gt;%</span></span>
<span id="cb12-108"><a href="#cb12-108"></a>  <span class="fu">summarise</span>(<span class="at">f.cont=</span><span class="fu">sum</span>(f.cont)) </span>
<span id="cb12-109"><a href="#cb12-109"></a>  </span>
<span id="cb12-110"><a href="#cb12-110"></a>  data_per_hour<span class="sc">$</span>f.cont <span class="ot">&lt;-</span> (data_per_hour<span class="sc">$</span>f.cont)<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb12-111"><a href="#cb12-111"></a>  data_per_hour<span class="sc">$</span>time_of_day <span class="ot">&lt;-</span> time_of_day[t]</span>
<span id="cb12-112"><a href="#cb12-112"></a>  </span>
<span id="cb12-113"><a href="#cb12-113"></a>  space_use <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_per_hour, space_use)</span>
<span id="cb12-114"><a href="#cb12-114"></a>  <span class="fu">stopCluster</span>(cl); <span class="fu">gc</span>()</span>
<span id="cb12-115"><a href="#cb12-115"></a>  <span class="fu">toc</span>()</span>
<span id="cb12-116"><a href="#cb12-116"></a>}</span>
<span id="cb12-117"><a href="#cb12-117"></a>  space_use <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(space_use)</span>
<span id="cb12-118"><a href="#cb12-118"></a>  site_date_asu <span class="ot">&lt;-</span> <span class="fu">c</span>(site_date_asu,<span class="fu">list</span>(space_use))</span>
<span id="cb12-119"><a href="#cb12-119"></a>  <span class="fu">names</span>(site_date_asu)[i] <span class="ot">&lt;-</span> <span class="fu">unique</span>(site_date)[i] </span>
<span id="cb12-120"><a href="#cb12-120"></a>  <span class="fu">rm</span>(space_use, dailydata, data_per_hour); <span class="fu">gc</span>()</span>
<span id="cb12-121"><a href="#cb12-121"></a>  <span class="fu">setTxtProgressBar</span>(pb, i)</span>
<span id="cb12-122"><a href="#cb12-122"></a>  <span class="fu">toc</span>()</span>
<span id="cb12-123"><a href="#cb12-123"></a>}</span>
<span id="cb12-124"><a href="#cb12-124"></a><span class="fu">close</span>(pb)</span>
<span id="cb12-125"><a href="#cb12-125"></a></span>
<span id="cb12-126"><a href="#cb12-126"></a><span class="co"># store the list object for later</span></span>
<span id="cb12-127"><a href="#cb12-127"></a><span class="fu">list.save</span>(site_date_asu, <span class="st">&quot;data/site_date_asu.rdata&quot;</span>)</span>
<span id="cb12-128"><a href="#cb12-128"></a></span>
<span id="cb12-129"><a href="#cb12-129"></a><span class="co"># Save the list of dataframes for future analysis</span></span>
<span id="cb12-130"><a href="#cb12-130"></a>siteByDayAsu <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(site_date_asu, <span class="at">.id =</span> <span class="st">&quot;Site_Day&quot;</span>)</span>
<span id="cb12-131"><a href="#cb12-131"></a></span>
<span id="cb12-132"><a href="#cb12-132"></a><span class="co"># Write to .csv</span></span>
<span id="cb12-133"><a href="#cb12-133"></a><span class="fu">write.csv</span>(siteByDayAsu, <span class="st">&quot;data/site-by-day-asu.csv&quot;</span>, <span class="at">row.names =</span> F) </span></code></pre></div>
</div>
<div id="average-acoustic-space-use" class="section level3 hasAnchor" number="0.5.4">
<h3><span class="header-section-number">0.5.4</span> Average acoustic space use<a href="#average-acoustic-space-use" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have calculated acoustic space use values for a given frequency bin size and time resolution for every unique site-date combination, we would like to obtain a single set of space use values for every unique site. In other words, we would like to average space use values across all frequency bins for five days.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># All unique sites</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>site <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(<span class="fu">basename</span>(files),<span class="st">&#39;^([[:alnum:]])+&#39;</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="fu">unique</span>(site)</span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co"># Store the site-wise ASU values</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>site_asu <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co"># Loop through site-wise data and average data for each site</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(site))) {</span>
<span id="cb13-10"><a href="#cb13-10"></a>  </span>
<span id="cb13-11"><a href="#cb13-11"></a>  <span class="co"># Extract data needed for every unique site</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>  dat <span class="ot">&lt;-</span> site_date_asu[stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="fu">names</span>(site_date_asu),<span class="fu">unique</span>(site)[i])]</span>
<span id="cb13-13"><a href="#cb13-13"></a>  </span>
<span id="cb13-14"><a href="#cb13-14"></a>  <span class="co"># Sum up values of acoustic space use across X no. of days for every unique site</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>  asu_sum <span class="ot">&lt;-</span>  dat <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>    <span class="fu">bind_rows</span>(<span class="at">.id=</span><span class="st">&quot;data&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-17"><a href="#cb13-17"></a>    <span class="fu">group_by</span>(freq, time_of_day) <span class="sc">%&gt;%</span> </span>
<span id="cb13-18"><a href="#cb13-18"></a>    <span class="fu">summarize</span>(<span class="at">f.cont.sum=</span><span class="fu">sum</span>(f.cont))</span>
<span id="cb13-19"><a href="#cb13-19"></a>  </span>
<span id="cb13-20"><a href="#cb13-20"></a>  <span class="co"># Averaging data as a function of number of days for a given site over which data was summed</span></span>
<span id="cb13-21"><a href="#cb13-21"></a>  asu_sum<span class="sc">$</span>f.cont.sum <span class="ot">&lt;-</span> (asu_sum<span class="sc">$</span>f.cont.sum)<span class="sc">/</span><span class="fu">length</span>(dat)</span>
<span id="cb13-22"><a href="#cb13-22"></a>  </span>
<span id="cb13-23"><a href="#cb13-23"></a>  <span class="co"># Scaling the data between 0 to 1 for the sake of comparison across sites</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>  asu_sum<span class="sc">$</span>f.cont.sum <span class="ot">&lt;-</span> <span class="fu">range01</span>(asu_sum<span class="sc">$</span>f.cont.sum)</span>
<span id="cb13-25"><a href="#cb13-25"></a>  </span>
<span id="cb13-26"><a href="#cb13-26"></a>  asu_sum <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(asu_sum)</span>
<span id="cb13-27"><a href="#cb13-27"></a>  site_asu <span class="ot">&lt;-</span> <span class="fu">c</span>(site_asu, <span class="fu">list</span>(asu_sum))</span>
<span id="cb13-28"><a href="#cb13-28"></a>  <span class="fu">names</span>(site_asu)[i] <span class="ot">&lt;-</span> <span class="fu">unique</span>(site)[i] </span>
<span id="cb13-29"><a href="#cb13-29"></a>  <span class="fu">rm</span>(dat,asu_sum)</span>
<span id="cb13-30"><a href="#cb13-30"></a>}</span>
<span id="cb13-31"><a href="#cb13-31"></a></span>
<span id="cb13-32"><a href="#cb13-32"></a><span class="co"># store the list object for later</span></span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="fu">list.save</span>(site_asu, <span class="st">&quot;data/site_asu.rdata&quot;</span>)</span>
<span id="cb13-34"><a href="#cb13-34"></a></span>
<span id="cb13-35"><a href="#cb13-35"></a><span class="co"># Save the list of dataframes for future analysis</span></span>
<span id="cb13-36"><a href="#cb13-36"></a>siteWiseAsu <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(site_asu, <span class="at">.id =</span> <span class="st">&quot;Site&quot;</span>)</span>
<span id="cb13-37"><a href="#cb13-37"></a></span>
<span id="cb13-38"><a href="#cb13-38"></a><span class="co"># Write to .csv</span></span>
<span id="cb13-39"><a href="#cb13-39"></a><span class="fu">write.csv</span>(siteWiseAsu, <span class="st">&quot;data/site-wise-asu.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="visual-examination-of-asu" class="section level3 hasAnchor" number="0.5.5">
<h3><span class="header-section-number">0.5.5</span> Visual examination of ASU<a href="#visual-examination-of-asu" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will use ggplot2 to plot and save individual ASU plots for each unique site-date combination. This will then be repeated for each unique site (calculated in the previous chunk of code)</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Saving the ggplots to a folder for every unique site-date combination</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(site_date_asu)){</span>
<span id="cb14-3"><a href="#cb14-3"></a>  </span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="co"># Get the data out from a list to a dataframe (else ggplot won&#39;t accept it)</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(site_date_asu[i])</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="fu">names</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;freq&quot;</span>,<span class="st">&quot;f.cont&quot;</span>,<span class="st">&quot;time_of_day&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a>  </span>
<span id="cb14-8"><a href="#cb14-8"></a>  <span class="co"># Plot the data</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>  g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x=</span>time_of_day, <span class="at">y=</span>freq)) <span class="sc">+</span>  </span>
<span id="cb14-10"><a href="#cb14-10"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> f.cont)) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Reds&quot;</span>))<span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12"></a>    <span class="co"># scale_fill_scico(palette = &quot;vikO&quot;) +</span></span>
<span id="cb14-13"><a href="#cb14-13"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Time of Day (in hours)&quot;</span>,</span>
<span id="cb14-15"><a href="#cb14-15"></a>       <span class="at">y=</span><span class="st">&quot;Frequency (in kHz) &quot;</span>) <span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb14-17"><a href="#cb14-17"></a>        <span class="at">axis.ticks.length.x =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb14-18"><a href="#cb14-18"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb14-19"><a href="#cb14-19"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb14-20"><a href="#cb14-20"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-21"><a href="#cb14-21"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb14-22"><a href="#cb14-22"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb14-23"><a href="#cb14-23"></a>  </span>
<span id="cb14-24"><a href="#cb14-24"></a>  <span class="co"># Save the data to a folder</span></span>
<span id="cb14-25"><a href="#cb14-25"></a>  <span class="fu">ggsave</span>(<span class="at">filename=</span><span class="st">&quot;&quot;</span>,<span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>, <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, </span>
<span id="cb14-26"><a href="#cb14-26"></a>         <span class="at">plot=</span>g1, <span class="at">device=</span><span class="st">&quot;png&quot;</span>, <span class="at">path =</span> <span class="fu">paste</span>(<span class="st">&quot;figs/siteByDayAsu/&quot;</span>,  <span class="fu">paste</span>(<span class="fu">names</span>(site_date_asu)[i], <span class="st">&quot;.png&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>), <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb14-27"><a href="#cb14-27"></a>}</span>
<span id="cb14-28"><a href="#cb14-28"></a></span>
<span id="cb14-29"><a href="#cb14-29"></a></span>
<span id="cb14-30"><a href="#cb14-30"></a><span class="co"># Saving the ggplots to a folder for every unique site</span></span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(site_asu)){</span>
<span id="cb14-32"><a href="#cb14-32"></a>  </span>
<span id="cb14-33"><a href="#cb14-33"></a>  <span class="co"># Get the data out from a list to a .dataframe (else ggplot won&#39;t accept it)</span></span>
<span id="cb14-34"><a href="#cb14-34"></a>  dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(site_asu[j])</span>
<span id="cb14-35"><a href="#cb14-35"></a>  <span class="fu">names</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;freq&quot;</span>,<span class="st">&quot;time_of_day&quot;</span>,<span class="st">&quot;f.cont.sum&quot;</span>)</span>
<span id="cb14-36"><a href="#cb14-36"></a>  </span>
<span id="cb14-37"><a href="#cb14-37"></a>  <span class="co"># Plot the data</span></span>
<span id="cb14-38"><a href="#cb14-38"></a>  g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x=</span>time_of_day, <span class="at">y=</span>freq)) <span class="sc">+</span>  </span>
<span id="cb14-39"><a href="#cb14-39"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> f.cont.sum)) <span class="sc">+</span></span>
<span id="cb14-40"><a href="#cb14-40"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Reds&quot;</span>))<span class="sc">+</span></span>
<span id="cb14-41"><a href="#cb14-41"></a>    <span class="co"># scale_fill_scico(palette = &quot;vikO&quot;) +</span></span>
<span id="cb14-42"><a href="#cb14-42"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb14-43"><a href="#cb14-43"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Time of Day (in hours)&quot;</span>,</span>
<span id="cb14-44"><a href="#cb14-44"></a>       <span class="at">y=</span><span class="st">&quot;Frequency (in kHz) &quot;</span>) <span class="sc">+</span></span>
<span id="cb14-45"><a href="#cb14-45"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb14-46"><a href="#cb14-46"></a>        <span class="at">axis.ticks.length.x =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb14-47"><a href="#cb14-47"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb14-48"><a href="#cb14-48"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb14-49"><a href="#cb14-49"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-50"><a href="#cb14-50"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb14-51"><a href="#cb14-51"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb14-52"><a href="#cb14-52"></a>  </span>
<span id="cb14-53"><a href="#cb14-53"></a>  <span class="co"># Save the data to a folder</span></span>
<span id="cb14-54"><a href="#cb14-54"></a>  <span class="fu">ggsave</span>(<span class="at">filename=</span><span class="st">&quot;&quot;</span>,<span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>, <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, </span>
<span id="cb14-55"><a href="#cb14-55"></a>         <span class="at">plot=</span>g1, <span class="at">device=</span><span class="st">&quot;png&quot;</span>, <span class="at">path =</span> <span class="fu">paste</span>(<span class="st">&quot;figs/siteWiseAsu/&quot;</span>,  <span class="fu">paste</span>(<span class="fu">names</span>(site_asu)[j], <span class="st">&quot;.png&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>), <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb14-56"><a href="#cb14-56"></a>}</span></code></pre></div>
</div>
<div id="representative-figure-for-publication" class="section level3 hasAnchor" number="0.5.6">
<h3><span class="header-section-number">0.5.6</span> Representative figure for publication<a href="#representative-figure-for-publication" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># load .rdata to plot select figures for publication</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>site_asu <span class="ot">&lt;-</span> <span class="fu">load</span>(<span class="st">&quot;data/site_asu.rdata&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a>site_asu <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(site_asu, <span class="at">.id=</span><span class="st">&quot;Site&quot;</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co"># Selecting three representative sites (PANMP1B, INBS04R, INBS04U)</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>bm <span class="ot">&lt;-</span> site_asu <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>   <span class="fu">filter</span>(Site<span class="sc">==</span><span class="st">&quot;PANMP1B&quot;</span>)</span>
<span id="cb15-9"><a href="#cb15-9"></a> </span>
<span id="cb15-10"><a href="#cb15-10"></a>ar <span class="ot">&lt;-</span> site_asu <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>   <span class="fu">filter</span>(Site<span class="sc">==</span><span class="st">&quot;INBS04R&quot;</span>)</span>
<span id="cb15-12"><a href="#cb15-12"></a> </span>
<span id="cb15-13"><a href="#cb15-13"></a>nr <span class="ot">&lt;-</span> site_asu <span class="sc">%&gt;%</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>   <span class="fu">filter</span>(Site<span class="sc">==</span><span class="st">&quot;INBS04U&quot;</span>)</span>
<span id="cb15-15"><a href="#cb15-15"></a></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co"># create separate figures for benchmark, active and passive sites and then patchwork them</span></span>
<span id="cb15-17"><a href="#cb15-17"></a></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co"># benchmark site</span></span>
<span id="cb15-19"><a href="#cb15-19"></a>fig_bm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bm, <span class="fu">aes</span>(<span class="at">x=</span>time_of_day, <span class="at">y=</span>freq)) <span class="sc">+</span>  </span>
<span id="cb15-20"><a href="#cb15-20"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> f.cont.sum)) <span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Reds&quot;</span>))<span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23"></a>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Acoustic Space Use</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb15-25"><a href="#cb15-25"></a>        <span class="at">axis.ticks.length.x =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb15-26"><a href="#cb15-26"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb15-27"><a href="#cb15-27"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb15-28"><a href="#cb15-28"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb15-29"><a href="#cb15-29"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb15-30"><a href="#cb15-30"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb15-31"><a href="#cb15-31"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb15-32"><a href="#cb15-32"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">max</span>(bm<span class="sc">$</span>time_of_day), <span class="at">y =</span> <span class="dv">23</span>,  <span class="at">label =</span> <span class="st">&quot;Benchmark site&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)</span>
<span id="cb15-33"><a href="#cb15-33"></a></span>
<span id="cb15-34"><a href="#cb15-34"></a><span class="co"># actively restored site</span></span>
<span id="cb15-35"><a href="#cb15-35"></a>fig_ar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ar, <span class="fu">aes</span>(<span class="at">x=</span>time_of_day, <span class="at">y=</span>freq)) <span class="sc">+</span>  </span>
<span id="cb15-36"><a href="#cb15-36"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> f.cont.sum)) <span class="sc">+</span></span>
<span id="cb15-37"><a href="#cb15-37"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Reds&quot;</span>))<span class="sc">+</span></span>
<span id="cb15-38"><a href="#cb15-38"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-39"><a href="#cb15-39"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Time of Day (in hours)&quot;</span>,</span>
<span id="cb15-40"><a href="#cb15-40"></a>       <span class="at">fill =</span> <span class="st">&quot;Acoustic Space Use</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-41"><a href="#cb15-41"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb15-42"><a href="#cb15-42"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb15-43"><a href="#cb15-43"></a>        <span class="at">axis.ticks.length.x =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb15-44"><a href="#cb15-44"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb15-45"><a href="#cb15-45"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb15-46"><a href="#cb15-46"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-47"><a href="#cb15-47"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">max</span>(ar<span class="sc">$</span>time_of_day), <span class="at">y =</span> <span class="dv">23</span>,  <span class="at">label =</span> <span class="st">&quot;Actively restored site&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)</span>
<span id="cb15-49"><a href="#cb15-49"></a></span>
<span id="cb15-50"><a href="#cb15-50"></a><span class="co"># naturally regenerating site</span></span>
<span id="cb15-51"><a href="#cb15-51"></a>fig_nr <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(nr, <span class="fu">aes</span>(<span class="at">x=</span>time_of_day, <span class="at">y=</span>freq)) <span class="sc">+</span>  </span>
<span id="cb15-52"><a href="#cb15-52"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> f.cont.sum)) <span class="sc">+</span></span>
<span id="cb15-53"><a href="#cb15-53"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Reds&quot;</span>))<span class="sc">+</span></span>
<span id="cb15-54"><a href="#cb15-54"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-55"><a href="#cb15-55"></a>    <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Frequency (in kHz)</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb15-56"><a href="#cb15-56"></a>       <span class="at">fill =</span> <span class="st">&quot;Acoustic Space Use</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-57"><a href="#cb15-57"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb15-58"><a href="#cb15-58"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb15-59"><a href="#cb15-59"></a>        <span class="at">axis.ticks.length.x =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb15-60"><a href="#cb15-60"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb15-61"><a href="#cb15-61"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-62"><a href="#cb15-62"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb15-63"><a href="#cb15-63"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-64"><a href="#cb15-64"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">max</span>(nr<span class="sc">$</span>time_of_day), <span class="at">y =</span> <span class="dv">23</span>,  <span class="at">label =</span> <span class="st">&quot;Naturally regenerating site&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)</span>
<span id="cb15-65"><a href="#cb15-65"></a></span>
<span id="cb15-66"><a href="#cb15-66"></a><span class="co"># patchwork the above three for the Fig. 3</span></span>
<span id="cb15-67"><a href="#cb15-67"></a>fig_asu <span class="ot">&lt;-</span> fig_nr <span class="sc">+</span> fig_ar <span class="sc">+</span> fig_bm</span>
<span id="cb15-68"><a href="#cb15-68"></a></span>
<span id="cb15-69"><a href="#cb15-69"></a><span class="fu">ggsave</span>(fig_asu, <span class="at">filename =</span> <span class="st">&quot;figs/fig3.png&quot;</span>, <span class="at">width=</span><span class="dv">52</span>, <span class="at">height=</span><span class="dv">17</span>,<span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;cm&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig04.png" alt="" />
<p class="caption"><strong>Visual examination of acoustic space use across a naturally regenerating, actively restored and benchmark site</strong>
In this figure, we visually examined ASU for each of the 128 frequency bins and 24 hours across each site and treatment type. Shown here are representative figures for an NR, AR, and BM site. In this visualization, we estimated the proportion of frequency space (values between 0 to 1) that was occupied by vocalizations/sounds above 0.003 dB for every single hour of recording across 24 hours in a day. We observed largely empty frequency bins between 12 kHz to 24 kHz for the majority of AR and NR sites. For the sake of this representative figure, we show the average ASU calculated across five days for each site. However, the patterns described here are broadly consistent across days and sites (Supporting Information). In the above figure, BM = undisturbed benchmark rainforest sites, AR = Actively restored forest sites, and NR = Naturally regenerating forest sites.</p>
</div>

</div>
</div>
<div id="non-metric-multidimensional-scaling-of-acoustic-space-use-data" class="section level2 hasAnchor" number="0.6">
<h2><span class="header-section-number">0.6</span> Non-metric multidimensional scaling of acoustic space use data<a href="#non-metric-multidimensional-scaling-of-acoustic-space-use-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here, we will use ordinations as a method of analyzing how acoustic space use (defined in terms of frequency and time, across 24 hours in a day) varies between treatment types.</p>
<div id="load-necessary-libraries-for-analysis" class="section level3 hasAnchor" number="0.6.1">
<h3><span class="header-section-number">0.6.1</span> Load necessary libraries for analysis<a href="#load-necessary-libraries-for-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="fu">library</span>(vegan)</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="fu">library</span>(scico)</span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="fu">library</span>(psych)</span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="fu">library</span>(ecodist)</span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="fu">library</span>(ggalt)</span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co"># loadfonts(device = &quot;win&quot;) # run this prior to creating publication figures </span></span>
<span id="cb16-14"><a href="#cb16-14"></a></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
<div id="load-the-necessary-data-for-nmds-calculations" class="section level3 hasAnchor" number="0.6.2">
<h3><span class="header-section-number">0.6.2</span> Load the necessary data for nmds calculations<a href="#load-the-necessary-data-for-nmds-calculations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># load the site-wise space use data</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>sitebyDayAsu <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/site-by-day-asu.csv&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># separate the columns</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>sitebyDayAsu <span class="ot">&lt;-</span> <span class="fu">separate</span>(sitebyDayAsu, <span class="at">col =</span> Site_Day, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;Day&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co"># load list of sites</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>sites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/list-of-sites.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;Site.code&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="fu">filter</span>(Site.code <span class="sc">!=</span> <span class="st">&quot;OLCAP5B&quot;</span>)</span>
<span id="cb17-11"><a href="#cb17-11"></a></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co"># Add restoration type column to the space use data</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>sitebyDayAsu <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sitebyDayAsu,sites, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span><span class="ot">=</span><span class="st">&quot;Site.code&quot;</span>))</span>
<span id="cb17-14"><a href="#cb17-14"></a></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="co"># Supplementary analysis: space use during diurnal and nocturnal periods</span></span>
<span id="cb17-16"><a href="#cb17-16"></a>diurnal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;06:00-07:00&quot;</span>,<span class="st">&quot;07:00-08:00&quot;</span>,<span class="st">&quot;08:00-09:00&quot;</span>,</span>
<span id="cb17-17"><a href="#cb17-17"></a>          <span class="st">&quot;09:00-10:00&quot;</span>,<span class="st">&quot;10:00-11:00&quot;</span>,<span class="st">&quot;11:00-12:00&quot;</span>,</span>
<span id="cb17-18"><a href="#cb17-18"></a>          <span class="st">&quot;12:00-13:00&quot;</span>,<span class="st">&quot;13:00-14:00&quot;</span>,<span class="st">&quot;14:00-15:00&quot;</span>,</span>
<span id="cb17-19"><a href="#cb17-19"></a>          <span class="st">&quot;15:00-16:00&quot;</span>,<span class="st">&quot;16:00-17:00&quot;</span>,<span class="st">&quot;17:00-18:00&quot;</span>)</span>
<span id="cb17-20"><a href="#cb17-20"></a>diurnalAsu <span class="ot">&lt;-</span> sitebyDayAsu <span class="sc">%&gt;%</span></span>
<span id="cb17-21"><a href="#cb17-21"></a>  <span class="fu">filter</span>(time_of_day <span class="sc">%in%</span> diurnal)</span>
<span id="cb17-22"><a href="#cb17-22"></a></span>
<span id="cb17-23"><a href="#cb17-23"></a>nocturnal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;18:00-19:00&quot;</span>,<span class="st">&quot;19:00-20:00&quot;</span>,<span class="st">&quot;20:00-21:00&quot;</span>,<span class="st">&quot;21:00-22:00&quot;</span>,</span>
<span id="cb17-24"><a href="#cb17-24"></a>               <span class="st">&quot;22:00-23:00&quot;</span>,<span class="st">&quot;23:00-00:00&quot;</span>,<span class="st">&quot;00:00-01:00&quot;</span>,<span class="st">&quot;01:00-02:00&quot;</span>,</span>
<span id="cb17-25"><a href="#cb17-25"></a>               <span class="st">&quot;02:00-03:00&quot;</span>,<span class="st">&quot;03:00-04:00&quot;</span>,<span class="st">&quot;04:00-05:00&quot;</span>,<span class="st">&quot;05:00-06:00&quot;</span>)</span>
<span id="cb17-26"><a href="#cb17-26"></a>nocturnalAsu <span class="ot">&lt;-</span> sitebyDayAsu <span class="sc">%&gt;%</span></span>
<span id="cb17-27"><a href="#cb17-27"></a>  <span class="fu">filter</span>(time_of_day <span class="sc">%in%</span> nocturnal)</span></code></pre></div>
</div>
<div id="preparing-a-dataframe-of-space-use-to-run-ordinations" class="section level3 hasAnchor" number="0.6.3">
<h3><span class="header-section-number">0.6.3</span> Preparing a dataframe of space use to run ordinations<a href="#preparing-a-dataframe-of-space-use-to-run-ordinations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Please note that while creating this dataframe for ordinations, the overall acoustic space use (sum of f.cont.sum column) was calculated by frequency bin, irrespective of the time of day for a given site. In other words, for 24 hours of data, a single value of space use was obtained for a given frequency bin. The frequency bin was pivoted from long to wide and each column essentially corresponded to a frequency bin. Within that frequency bin, grouped for each site, an overall value of space use was computed. </span></span>
<span id="cb18-2"><a href="#cb18-2"></a></span>
<span id="cb18-3"><a href="#cb18-3"></a>nmdsDat <span class="ot">&lt;-</span> sitebyDayAsu <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, freq, f.cont, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="fu">group_by</span>(Site, Restoration.type, freq) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>  <span class="fu">summarise</span>(<span class="at">totSpaceuse =</span> <span class="fu">sum</span>(f.cont)) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="fu">arrange</span>(Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>  <span class="fu">pivot_wider</span> (<span class="at">names_from =</span> freq, <span class="at">values_from =</span> totSpaceuse, <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">totSpaceuse=</span><span class="dv">0</span>))</span>
<span id="cb18-9"><a href="#cb18-9"></a></span>
<span id="cb18-10"><a href="#cb18-10"></a>nmdsDiurnal <span class="ot">&lt;-</span> diurnalAsu <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, freq, f.cont, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12"></a>  <span class="fu">group_by</span>(Site, Restoration.type, freq) <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13"></a>  <span class="fu">summarise</span>(<span class="at">totSpaceuse =</span> <span class="fu">sum</span>(f.cont)) <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="#cb18-14"></a>  <span class="fu">arrange</span>(Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15"></a>  <span class="fu">pivot_wider</span> (<span class="at">names_from =</span> freq, <span class="at">values_from =</span> totSpaceuse, <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">totSpaceuse=</span><span class="dv">0</span>))</span>
<span id="cb18-16"><a href="#cb18-16"></a></span>
<span id="cb18-17"><a href="#cb18-17"></a>nmdsNocturnal <span class="ot">&lt;-</span> nocturnalAsu <span class="sc">%&gt;%</span> </span>
<span id="cb18-18"><a href="#cb18-18"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, freq, f.cont, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19"></a>  <span class="fu">group_by</span>(Site, Restoration.type, freq) <span class="sc">%&gt;%</span></span>
<span id="cb18-20"><a href="#cb18-20"></a>  <span class="fu">summarise</span>(<span class="at">totSpaceuse =</span> <span class="fu">sum</span>(f.cont)) <span class="sc">%&gt;%</span></span>
<span id="cb18-21"><a href="#cb18-21"></a>  <span class="fu">arrange</span>(Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb18-22"><a href="#cb18-22"></a>  <span class="fu">pivot_wider</span> (<span class="at">names_from =</span> freq, <span class="at">values_from =</span> totSpaceuse, <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">totSpaceuse=</span><span class="dv">0</span>))</span>
<span id="cb18-23"><a href="#cb18-23"></a></span>
<span id="cb18-24"><a href="#cb18-24"></a><span class="co"># Convert to matrix form</span></span>
<span id="cb18-25"><a href="#cb18-25"></a>nmdsDatMatrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(nmdsDat[, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(nmdsDat)])</span>
<span id="cb18-26"><a href="#cb18-26"></a>nmdsDiurnalMatrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(nmdsDiurnal[, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(nmdsDiurnal)])</span>
<span id="cb18-27"><a href="#cb18-27"></a>nmdsNocturnalMatrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(nmdsNocturnal[, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(nmdsNocturnal)])</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Run a euclidean dissimilarity distance and use metaMDS function from vegan to run ordinations</span></span>
<span id="cb19-2"><a href="#cb19-2"></a></span>
<span id="cb19-3"><a href="#cb19-3"></a>disEuclidean <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(nmdsDatMatrix, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a>disEuclideanDiurnal <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(nmdsDiurnalMatrix, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb19-5"><a href="#cb19-5"></a>disEuclideanNocturnal <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(nmdsNocturnalMatrix, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a>nmdsEuclidean <span class="ot">&lt;-</span> <span class="fu">vegdist</span> (nmdsDatMatrix, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-8"><a href="#cb19-8"></a>  <span class="fu">metaMDS</span> (nmdsEuclidean, <span class="at">k=</span><span class="dv">6</span>) <span class="co"># stress =  0.007478165</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>nmdsEuclideanDiurnal <span class="ot">&lt;-</span> <span class="fu">vegdist</span> (nmdsDiurnalMatrix, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="fu">metaMDS</span> (nmdsEuclideanDiurnal, <span class="at">k=</span><span class="dv">6</span>) <span class="co"># stress = 0.003387608</span></span>
<span id="cb19-11"><a href="#cb19-11"></a>nmdsEuclideanNocturnal <span class="ot">&lt;-</span> <span class="fu">vegdist</span> (nmdsNocturnalMatrix, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-12"><a href="#cb19-12"></a>  <span class="fu">metaMDS</span> (nmdsEuclideanNocturnal, <span class="at">k=</span><span class="dv">6</span>) <span class="co"># stress = 0.01572579</span></span>
<span id="cb19-13"><a href="#cb19-13"></a></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co"># extract nmds scores</span></span>
<span id="cb19-15"><a href="#cb19-15"></a>nmdsScores <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">scores</span>(nmdsEuclidean, <span class="at">display =</span> <span class="st">&quot;site&quot;</span>))</span>
<span id="cb19-16"><a href="#cb19-16"></a>nmdsScoresDiurnal <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">scores</span>(nmdsEuclideanDiurnal, <span class="at">display =</span> <span class="st">&quot;site&quot;</span>))</span>
<span id="cb19-17"><a href="#cb19-17"></a>nmdsScoresNocturnal <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">scores</span>(nmdsEuclideanNocturnal, <span class="at">display =</span> <span class="st">&quot;site&quot;</span>))</span>
<span id="cb19-18"><a href="#cb19-18"></a></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co"># Write the scores to a separate .csv</span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="fu">write.csv</span>(nmdsScores, <span class="st">&quot;results/nmds-acousticSpaceUse.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb19-21"><a href="#cb19-21"></a></span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="co"># With the above analysis, we note the stress is 0.008131476. However, if stress is high, we should reposition the points in 2 dimensions in the direction of decreasing stress, and repeat until stress is below some threshold.**A good rule of thumb: stress &lt; 0.05 provides an excellent representation in reduced dimensions, &lt; 0.1 is great, &lt; 0.2 is good/ok, and stress &lt; 0.3 provides a poor representation.** To reiterate: high stress is bad, low stress is good!</span></span>
<span id="cb19-23"><a href="#cb19-23"></a></span>
<span id="cb19-24"><a href="#cb19-24"></a><span class="co"># write scores for diurnal and nocturnal data</span></span>
<span id="cb19-25"><a href="#cb19-25"></a><span class="fu">write.csv</span>(nmdsScoresDiurnal, <span class="st">&quot;results/nmds-acousticSpaceUse-diurnal.csv&quot;</span>, </span>
<span id="cb19-26"><a href="#cb19-26"></a>          <span class="at">row.names =</span> F)</span>
<span id="cb19-27"><a href="#cb19-27"></a><span class="fu">write.csv</span>(nmdsScoresNocturnal, <span class="st">&quot;results/nmds-acousticSpaceUse-nocturnal.csv&quot;</span>, </span>
<span id="cb19-28"><a href="#cb19-28"></a>          <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="plotting-the-nmds-scores" class="section level3 hasAnchor" number="0.6.4">
<h3><span class="header-section-number">0.6.4</span> Plotting the NMDS scores<a href="#plotting-the-nmds-scores" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># First let&#39;s add the treatment type back to the nmds scores</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>nmdsScores<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> nmdsDat<span class="sc">$</span>Restoration.type</span>
<span id="cb20-3"><a href="#cb20-3"></a>nmdsScoresDiurnal<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> nmdsDiurnal<span class="sc">$</span>Restoration.type</span>
<span id="cb20-4"><a href="#cb20-4"></a>nmdsScoresNocturnal<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> nmdsNocturnal<span class="sc">$</span>Restoration.type</span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co"># Add a custom set of colors</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>), <span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Paired&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb20-8"><a href="#cb20-8"></a></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>nmdsScores<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(nmdsScores<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb20-11"><a href="#cb20-11"></a>nmdsScoresDiurnal<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(nmdsScoresDiurnal<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb20-12"><a href="#cb20-12"></a>nmdsScoresNocturnal<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(nmdsScoresNocturnal<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb20-13"><a href="#cb20-13"></a></span>
<span id="cb20-14"><a href="#cb20-14"></a>fig_nmds <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>nmdsScores) <span class="sc">+</span> </span>
<span id="cb20-15"><a href="#cb20-15"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">x=</span>NMDS1,<span class="at">y=</span>NMDS2,<span class="at">colour=</span>Restoration.type),<span class="at">level =</span> <span class="fl">0.50</span>) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>NMDS1,<span class="at">y=</span>NMDS2,<span class="at">shape=</span>Restoration.type,<span class="at">colour=</span>Restoration.type),<span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb20-17"><a href="#cb20-17"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb20-18"><a href="#cb20-18"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&quot;NMDS 1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb20-19"><a href="#cb20-19"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">&quot;NMDS 2&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(nmdsScores<span class="sc">$</span>Restoration.type)), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb20-21"><a href="#cb20-21"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="sc">+</span> </span>
<span id="cb20-22"><a href="#cb20-22"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb20-23"><a href="#cb20-23"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb20-24"><a href="#cb20-24"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb20-25"><a href="#cb20-25"></a>                                    <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb20-26"><a href="#cb20-26"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb20-27"><a href="#cb20-27"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb20-28"><a href="#cb20-28"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb20-29"><a href="#cb20-29"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30"></a>   <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">max</span>(nmdsScores<span class="sc">$</span>NMDS1), <span class="at">y =</span> <span class="fu">max</span>(nmdsScores<span class="sc">$</span>NMDS2),  <span class="at">label =</span> <span class="st">&quot;Stress = 0.008&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>, <span class="at">size=</span><span class="dv">5</span>)</span>
<span id="cb20-31"><a href="#cb20-31"></a></span>
<span id="cb20-32"><a href="#cb20-32"></a>fig_nmds_diurnal <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>nmdsScoresDiurnal) <span class="sc">+</span> </span>
<span id="cb20-33"><a href="#cb20-33"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">x=</span>NMDS1,<span class="at">y=</span>NMDS2,<span class="at">colour=</span>Restoration.type),<span class="at">level =</span> <span class="fl">0.50</span>) <span class="sc">+</span></span>
<span id="cb20-34"><a href="#cb20-34"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>NMDS1,<span class="at">y=</span>NMDS2,<span class="at">shape=</span>Restoration.type,<span class="at">colour=</span>Restoration.type),<span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb20-35"><a href="#cb20-35"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb20-36"><a href="#cb20-36"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&quot;NMDS 1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb20-37"><a href="#cb20-37"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">&quot;NMDS 2&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-38"><a href="#cb20-38"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(nmdsScoresDiurnal<span class="sc">$</span>Restoration.type)), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb20-39"><a href="#cb20-39"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="sc">+</span> </span>
<span id="cb20-40"><a href="#cb20-40"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb20-41"><a href="#cb20-41"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb20-42"><a href="#cb20-42"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb20-43"><a href="#cb20-43"></a>                                    <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb20-44"><a href="#cb20-44"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb20-45"><a href="#cb20-45"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb20-46"><a href="#cb20-46"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb20-47"><a href="#cb20-47"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb20-48"><a href="#cb20-48"></a>   <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">max</span>(nmdsScoresDiurnal<span class="sc">$</span>NMDS1), <span class="at">y =</span> <span class="fu">max</span>(nmdsScoresDiurnal<span class="sc">$</span>NMDS2),  <span class="at">label =</span> <span class="st">&quot;Stress = 0.003&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>, <span class="at">size=</span><span class="dv">5</span>)</span>
<span id="cb20-49"><a href="#cb20-49"></a></span>
<span id="cb20-50"><a href="#cb20-50"></a>fig_nmds_nocturnal <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>nmdsScoresNocturnal) <span class="sc">+</span> </span>
<span id="cb20-51"><a href="#cb20-51"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">x=</span>NMDS1,<span class="at">y=</span>NMDS2,<span class="at">colour=</span>Restoration.type),<span class="at">level =</span> <span class="fl">0.50</span>) <span class="sc">+</span></span>
<span id="cb20-52"><a href="#cb20-52"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>NMDS1,<span class="at">y=</span>NMDS2,<span class="at">shape=</span>Restoration.type,<span class="at">colour=</span>Restoration.type),<span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb20-53"><a href="#cb20-53"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb20-54"><a href="#cb20-54"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&quot;NMDS 1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb20-55"><a href="#cb20-55"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">&quot;NMDS 2&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-56"><a href="#cb20-56"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(nmdsScoresNocturnal<span class="sc">$</span>Restoration.type)), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb20-57"><a href="#cb20-57"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="sc">+</span> </span>
<span id="cb20-58"><a href="#cb20-58"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb20-59"><a href="#cb20-59"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb20-60"><a href="#cb20-60"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb20-61"><a href="#cb20-61"></a>                                    <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb20-62"><a href="#cb20-62"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb20-63"><a href="#cb20-63"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb20-64"><a href="#cb20-64"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb20-65"><a href="#cb20-65"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb20-66"><a href="#cb20-66"></a>   <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">max</span>(nmdsScoresNocturnal<span class="sc">$</span>NMDS1), <span class="at">y =</span> <span class="fu">max</span>(nmdsScoresNocturnal<span class="sc">$</span>NMDS2),  <span class="at">label =</span> <span class="st">&quot;Stress = 0.01&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>, <span class="at">size=</span><span class="dv">5</span>)</span>
<span id="cb20-67"><a href="#cb20-67"></a></span>
<span id="cb20-68"><a href="#cb20-68"></a><span class="fu">ggsave</span>(fig_nmds, <span class="at">filename =</span> <span class="st">&quot;figs/fig_nmds_overallSpaceUse.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>,<span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span>
<span id="cb20-69"><a href="#cb20-69"></a><span class="fu">ggsave</span>(fig_nmds_diurnal, <span class="at">filename =</span> <span class="st">&quot;figs/fig_nmds_diurnalSpaceUse.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>,<span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span>
<span id="cb20-70"><a href="#cb20-70"></a><span class="fu">ggsave</span>(fig_nmds_nocturnal, <span class="at">filename =</span> <span class="st">&quot;figs/fig_nmds_nocturnalSpaceUse.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>,<span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig_nmds_overallSpaceUse.png" alt="" />
<p class="caption">NMDS ordination of overall acoustic space use values revealed a distinct cluster for BM sites but overlapping clusters for AR and NR sites</p>
</div>
<p><img src="figs/fig_nmds_diurnalSpaceUse.png" alt="NMDS ordination of diurnal acoustic space use values revealed similar results as seen for overall acoustic space use. However, there was slightly more overlap observed across the three treatment types." />
<img src="figs/fig_nmds_nocturnalSpaceUse.png" alt="NMDS ordination of nocturnal acoustic space use values revealed similar results as seen for overall acoustic space use. However, there the BM sites were distinctly different in ordination space when compared to AR and NR sites." /></p>
</div>
<div id="testing-multivariate-homogeneity-of-group-dispersions" class="section level3 hasAnchor" number="0.6.5">
<h3><span class="header-section-number">0.6.5</span> Testing multivariate homogeneity of group dispersions<a href="#testing-multivariate-homogeneity-of-group-dispersions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One measure of multivariate dispersion (variance) for a group of samples is to calculate the average distance of group members to the group centroid or spatial median in multivariate space. To test if the dispersions (variances) of one or more groups are different, the distances of group members to the group centroid are subject to ANOVA.</p>
<p>Betadisper tests whether two or more groups (for example, restored and unrestored sites) are homogeneously dispersed in relation to their species in studied samples. This test can be done to see if one group has more compositional variance than another. Moreover, homogeneity of dispersion among groups is very advisable to have if you want to test if two or more groups have different compositions, which is tested by adonis.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>nmdsVariance <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(disEuclidean, <span class="at">group =</span> nmdsDat<span class="sc">$</span>Restoration.type)</span>
<span id="cb21-2"><a href="#cb21-2"></a>nmdsVariance</span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="fu">anova</span>(nmdsVariance)</span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="fu">permutest</span>(nmdsVariance, <span class="at">pairwise =</span> <span class="cn">TRUE</span>, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="fu">TukeyHSD</span>(nmdsVariance)</span>
<span id="cb21-7"><a href="#cb21-7"></a></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="co"># For overall space use, there is a significant difference in within group variance between one group and another (For Benchmark-Active sites and Passive-Benchmark sites, but not between Active-Passive)</span></span>
<span id="cb21-9"><a href="#cb21-9"></a></span>
<span id="cb21-10"><a href="#cb21-10"></a>nmdsVarianceDiurnal <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(disEuclideanDiurnal, <span class="at">group =</span> nmdsDiurnal<span class="sc">$</span>Restoration.type)</span>
<span id="cb21-11"><a href="#cb21-11"></a>nmdsVarianceDiurnal</span>
<span id="cb21-12"><a href="#cb21-12"></a></span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="fu">anova</span>(nmdsVarianceDiurnal)</span>
<span id="cb21-14"><a href="#cb21-14"></a><span class="fu">permutest</span>(nmdsVarianceDiurnal, <span class="at">pairwise =</span> <span class="cn">TRUE</span>, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb21-15"><a href="#cb21-15"></a><span class="fu">TukeyHSD</span>(nmdsVarianceDiurnal)</span>
<span id="cb21-16"><a href="#cb21-16"></a></span>
<span id="cb21-17"><a href="#cb21-17"></a><span class="co"># For diurnal space use, there is a significant difference in within group variance between one group and another (For Benchmark-Active sites and Passive-Benchmark sites, but not between Active-Passive)</span></span>
<span id="cb21-18"><a href="#cb21-18"></a></span>
<span id="cb21-19"><a href="#cb21-19"></a>nmdsVarianceNocturnal <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(disEuclideanNocturnal, <span class="at">group =</span> nmdsNocturnal<span class="sc">$</span>Restoration.type)</span>
<span id="cb21-20"><a href="#cb21-20"></a>nmdsVarianceNocturnal</span>
<span id="cb21-21"><a href="#cb21-21"></a></span>
<span id="cb21-22"><a href="#cb21-22"></a><span class="fu">anova</span>(nmdsVarianceNocturnal)</span>
<span id="cb21-23"><a href="#cb21-23"></a><span class="fu">permutest</span>(nmdsVarianceNocturnal, <span class="at">pairwise =</span> <span class="cn">TRUE</span>, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb21-24"><a href="#cb21-24"></a><span class="fu">TukeyHSD</span>(nmdsVarianceNocturnal)</span>
<span id="cb21-25"><a href="#cb21-25"></a></span>
<span id="cb21-26"><a href="#cb21-26"></a><span class="co"># For nocturnal space use, there is a significant difference in within group variance between one group and another (For Benchmark-Active sites and Passive-Benchmark sites, but not between Active-Passive)</span></span>
<span id="cb21-27"><a href="#cb21-27"></a></span>
<span id="cb21-28"><a href="#cb21-28"></a><span class="co"># The above results suggests that there is heterogeneous variation and does not meet assumptions to run adonis</span></span></code></pre></div>
</div>
<div id="visualizing-the-multivariate-homogeneity-of-group-dispersions" class="section level3 hasAnchor" number="0.6.6">
<h3><span class="header-section-number">0.6.6</span> Visualizing the multivariate homogeneity of group dispersions<a href="#visualizing-the-multivariate-homogeneity-of-group-dispersions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The below lines of code have been adapted from: <a href="https://chrischizinski.github.io/rstats/adonis/" class="uri">https://chrischizinski.github.io/rstats/adonis/</a></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># extract the centroids and the site points in multivariate space.  </span></span>
<span id="cb22-2"><a href="#cb22-2"></a>centroids <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">grps=</span><span class="fu">rownames</span>(nmdsVariance<span class="sc">$</span>centroids),</span>
<span id="cb22-3"><a href="#cb22-3"></a>                       <span class="fu">data.frame</span>(nmdsVariance<span class="sc">$</span>centroids))</span>
<span id="cb22-4"><a href="#cb22-4"></a>vectors <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group=</span>nmdsVariance<span class="sc">$</span>group,</span>
<span id="cb22-5"><a href="#cb22-5"></a>                      <span class="fu">data.frame</span>(nmdsVariance<span class="sc">$</span>vectors))</span>
<span id="cb22-6"><a href="#cb22-6"></a></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co"># to create the lines from the centroids to each point we will put it in a format that ggplot can handle</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>seg.data<span class="ot">&lt;-</span><span class="fu">cbind</span>(vectors[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],centroids[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(centroids),<span class="fu">as.data.frame</span>(<span class="fu">table</span>(vectors<span class="sc">$</span>group))<span class="sc">$</span>Freq),<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="fu">names</span>(seg.data)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;group&quot;</span>,<span class="st">&quot;v.PCoA1&quot;</span>,<span class="st">&quot;v.PCoA2&quot;</span>,<span class="st">&quot;PCoA1&quot;</span>,<span class="st">&quot;PCoA2&quot;</span>)</span>
<span id="cb22-10"><a href="#cb22-10"></a></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="co"># create the convex hulls of the outermost points</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>grp1.hull <span class="ot">&lt;-</span> seg.data[seg.data<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;Active&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>][<span class="fu">chull</span>(seg.data[seg.data<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;Active&quot;</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]),]</span>
<span id="cb22-13"><a href="#cb22-13"></a>grp2.hull <span class="ot">&lt;-</span> seg.data[seg.data<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;Benchmark&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>][<span class="fu">chull</span>(seg.data[seg.data<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;Benchmark&quot;</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]),]</span>
<span id="cb22-14"><a href="#cb22-14"></a>grp3.hull <span class="ot">&lt;-</span> seg.data[seg.data<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;Passive&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>][<span class="fu">chull</span>(seg.data[seg.data<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;Passive&quot;</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]),]</span>
<span id="cb22-15"><a href="#cb22-15"></a>all.hull <span class="ot">&lt;-</span> <span class="fu">rbind</span>(grp1.hull,grp2.hull,grp3.hull)</span>
<span id="cb22-16"><a href="#cb22-16"></a></span>
<span id="cb22-17"><a href="#cb22-17"></a><span class="co"># plot the panel and convex hulls</span></span>
<span id="cb22-18"><a href="#cb22-18"></a>fig_hull <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb22-19"><a href="#cb22-19"></a>  <span class="fu">geom_polygon</span>(<span class="at">data=</span> all.hull,<span class="fu">aes</span>(<span class="at">x=</span>v.PCoA1,<span class="at">y=</span>v.PCoA2),<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20"></a>  <span class="fu">geom_segment</span>(<span class="at">data=</span>seg.data,<span class="fu">aes</span>(<span class="at">x=</span>v.PCoA1,<span class="at">xend=</span>PCoA1,<span class="at">y=</span>v.PCoA2,<span class="at">yend=</span>PCoA2),<span class="at">alpha=</span><span class="fl">0.30</span>) <span class="sc">+</span> </span>
<span id="cb22-21"><a href="#cb22-21"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>centroids[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="fu">aes</span>(<span class="at">x=</span>PCoA1,<span class="at">y=</span>PCoA2,<span class="at">shape=</span>grps),<span class="at">size=</span><span class="dv">4</span>,<span class="at">colour=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb22-22"><a href="#cb22-22"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>seg.data, <span class="fu">aes</span>(<span class="at">x=</span>v.PCoA1,<span class="at">y=</span>v.PCoA2,<span class="at">shape=</span>group),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb22-23"><a href="#cb22-23"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;All&quot;</span>,<span class="at">x=</span><span class="st">&quot;&quot;</span>,<span class="at">y=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24"></a>  <span class="co">#coord_cartesian(xlim = c(-0.2,0.2), ylim = c(-0.25,0.2)) +</span></span>
<span id="cb22-25"><a href="#cb22-25"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb22-26"><a href="#cb22-26"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>

</div>
</div>
<div id="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data" class="section level2 hasAnchor" number="0.7">
<h2><span class="header-section-number">0.7</span> Generalized linear mixed modeling (acoustic space use and vegetation data)<a href="#generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this script, we run generalized linear models to test the association between acoustic space use values and restoration type. In addition, we run generalized linear mixed models to test associations between acoustic space use and habitat (vegetation structure) using site-pair name (actively restored and naturally regenerating were specified to be paired) and repeat visits as random effects.</p>
<div id="install-required-libraries-2" class="section level3 hasAnchor" number="0.7.1">
<h3><span class="header-section-number">0.7.1</span> Install required libraries<a href="#install-required-libraries-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="fu">library</span>(vegan)</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="fu">library</span>(scico)</span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="fu">library</span>(psych)</span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="fu">library</span>(lme4)</span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb23-15"><a href="#cb23-15"></a></span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
<div id="load-necessary-data-for-statistical-modeling" class="section level3 hasAnchor" number="0.7.2">
<h3><span class="header-section-number">0.7.2</span> Load necessary data for statistical modeling<a href="#load-necessary-data-for-statistical-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># load list of sites</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>sites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/list-of-sites.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;Site.code&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">filter</span>(Site.code <span class="sc">!=</span> <span class="st">&quot;OLCAP5B&quot;</span>)</span>
<span id="cb24-5"><a href="#cb24-5"></a></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co"># load the entire asu data across all sites and days computed</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>sitebyDayAsu <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/site-by-day-asu.csv&quot;</span>) </span>
<span id="cb24-8"><a href="#cb24-8"></a></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="co"># separate by Site and Date</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>sitebyDayAsu <span class="ot">&lt;-</span> <span class="fu">separate</span>(sitebyDayAsu, <span class="at">col =</span> Site_Day, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>, <span class="st">&quot;Date&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>) </span>
<span id="cb24-11"><a href="#cb24-11"></a></span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="co"># Add restoration type column to the space use data</span></span>
<span id="cb24-13"><a href="#cb24-13"></a>sitebyDayAsu <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sitebyDayAsu, sites, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span><span class="ot">=</span><span class="st">&quot;Site.code&quot;</span>))</span>
<span id="cb24-14"><a href="#cb24-14"></a></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="co"># scale values per site/date for comparison between sites and treatment types</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>sitebyDayAsu <span class="ot">&lt;-</span> sitebyDayAsu <span class="sc">%&gt;%</span></span>
<span id="cb24-17"><a href="#cb24-17"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb24-18"><a href="#cb24-18"></a>  <span class="fu">mutate</span>(<span class="at">f.cont.scaled =</span> <span class="fu">range01</span>(f.cont))</span>
<span id="cb24-19"><a href="#cb24-19"></a></span>
<span id="cb24-20"><a href="#cb24-20"></a><span class="co"># computing total number of days for which space use has been computed for each site (some sites have very few days. Eg. OLV110R, else rest have 5 days of audio data each)</span></span>
<span id="cb24-21"><a href="#cb24-21"></a>nSites_Days <span class="ot">&lt;-</span> sitebyDayAsu <span class="sc">%&gt;%</span></span>
<span id="cb24-22"><a href="#cb24-22"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb24-23"><a href="#cb24-23"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-24"><a href="#cb24-24"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span></span>
<span id="cb24-25"><a href="#cb24-25"></a>  <span class="fu">count</span>()</span>
<span id="cb24-26"><a href="#cb24-26"></a></span>
<span id="cb24-27"><a href="#cb24-27"></a><span class="co"># Let&#39;s look at data by restoration type</span></span>
<span id="cb24-28"><a href="#cb24-28"></a><span class="co"># This suggests that we have more data for benchmark sites relative to the other two treatment types</span></span>
<span id="cb24-29"><a href="#cb24-29"></a>nDays_siteType <span class="ot">&lt;-</span> sitebyDayAsu <span class="sc">%&gt;%</span></span>
<span id="cb24-30"><a href="#cb24-30"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb24-31"><a href="#cb24-31"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-32"><a href="#cb24-32"></a>  <span class="fu">group_by</span>(Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb24-33"><a href="#cb24-33"></a>  <span class="fu">count</span>()</span>
<span id="cb24-34"><a href="#cb24-34"></a>  </span>
<span id="cb24-35"><a href="#cb24-35"></a><span class="co"># Separate analysis: space use during diurnal and nocturnal periods</span></span>
<span id="cb24-36"><a href="#cb24-36"></a>diurnal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;06:00-07:00&quot;</span>,<span class="st">&quot;07:00-08:00&quot;</span>,<span class="st">&quot;08:00-09:00&quot;</span>,</span>
<span id="cb24-37"><a href="#cb24-37"></a>          <span class="st">&quot;09:00-10:00&quot;</span>,<span class="st">&quot;10:00-11:00&quot;</span>,<span class="st">&quot;11:00-12:00&quot;</span>,</span>
<span id="cb24-38"><a href="#cb24-38"></a>          <span class="st">&quot;12:00-13:00&quot;</span>,<span class="st">&quot;13:00-14:00&quot;</span>,<span class="st">&quot;14:00-15:00&quot;</span>,</span>
<span id="cb24-39"><a href="#cb24-39"></a>          <span class="st">&quot;15:00-16:00&quot;</span>,<span class="st">&quot;16:00-17:00&quot;</span>,<span class="st">&quot;17:00-18:00&quot;</span>)</span>
<span id="cb24-40"><a href="#cb24-40"></a>diurnalAsu <span class="ot">&lt;-</span> sitebyDayAsu <span class="sc">%&gt;%</span></span>
<span id="cb24-41"><a href="#cb24-41"></a>  <span class="fu">filter</span>(time_of_day <span class="sc">%in%</span> diurnal)</span>
<span id="cb24-42"><a href="#cb24-42"></a></span>
<span id="cb24-43"><a href="#cb24-43"></a>nocturnal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;18:00-19:00&quot;</span>,<span class="st">&quot;19:00-20:00&quot;</span>,<span class="st">&quot;20:00-21:00&quot;</span>,<span class="st">&quot;21:00-22:00&quot;</span>,</span>
<span id="cb24-44"><a href="#cb24-44"></a>               <span class="st">&quot;22:00-23:00&quot;</span>,<span class="st">&quot;23:00-00:00&quot;</span>,<span class="st">&quot;00:00-01:00&quot;</span>,<span class="st">&quot;01:00-02:00&quot;</span>,</span>
<span id="cb24-45"><a href="#cb24-45"></a>               <span class="st">&quot;02:00-03:00&quot;</span>,<span class="st">&quot;03:00-04:00&quot;</span>,<span class="st">&quot;04:00-05:00&quot;</span>,<span class="st">&quot;05:00-06:00&quot;</span>)</span>
<span id="cb24-46"><a href="#cb24-46"></a>nocturnalAsu <span class="ot">&lt;-</span> sitebyDayAsu <span class="sc">%&gt;%</span></span>
<span id="cb24-47"><a href="#cb24-47"></a>  <span class="fu">filter</span>(time_of_day <span class="sc">%in%</span> nocturnal)</span>
<span id="cb24-48"><a href="#cb24-48"></a></span>
<span id="cb24-49"><a href="#cb24-49"></a><span class="co"># Prepare data for statistical modeling</span></span>
<span id="cb24-50"><a href="#cb24-50"></a><span class="co"># Calculating total space use across all frequency bins and times of day: 128*24 for each site-day combination</span></span>
<span id="cb24-51"><a href="#cb24-51"></a></span>
<span id="cb24-52"><a href="#cb24-52"></a>totSpaceUse <span class="ot">&lt;-</span> sitebyDayAsu <span class="sc">%&gt;%</span></span>
<span id="cb24-53"><a href="#cb24-53"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb24-54"><a href="#cb24-54"></a>  <span class="fu">summarise</span>(<span class="at">totSpaceuse =</span> <span class="fu">sum</span>(f.cont.scaled)) <span class="sc">%&gt;%</span></span>
<span id="cb24-55"><a href="#cb24-55"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb24-56"><a href="#cb24-56"></a>  <span class="fu">mutate</span>(<span class="at">visit =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb24-57"><a href="#cb24-57"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-58"><a href="#cb24-58"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode))</span>
<span id="cb24-59"><a href="#cb24-59"></a></span>
<span id="cb24-60"><a href="#cb24-60"></a><span class="co"># Calculating total space use for diurnal times for each site-day combination</span></span>
<span id="cb24-61"><a href="#cb24-61"></a></span>
<span id="cb24-62"><a href="#cb24-62"></a>totSpaceUseDiurnal <span class="ot">&lt;-</span> diurnalAsu <span class="sc">%&gt;%</span></span>
<span id="cb24-63"><a href="#cb24-63"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb24-64"><a href="#cb24-64"></a>  <span class="fu">summarise</span>(<span class="at">totSpaceuse =</span> <span class="fu">sum</span>(f.cont.scaled)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-65"><a href="#cb24-65"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb24-66"><a href="#cb24-66"></a>  <span class="fu">mutate</span>(<span class="at">visit =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb24-67"><a href="#cb24-67"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-68"><a href="#cb24-68"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode))</span>
<span id="cb24-69"><a href="#cb24-69"></a></span>
<span id="cb24-70"><a href="#cb24-70"></a><span class="co"># Calculating total space use for nocturnal times for each site-date combination</span></span>
<span id="cb24-71"><a href="#cb24-71"></a></span>
<span id="cb24-72"><a href="#cb24-72"></a>totSpaceUseNocturnal <span class="ot">&lt;-</span> nocturnalAsu <span class="sc">%&gt;%</span></span>
<span id="cb24-73"><a href="#cb24-73"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb24-74"><a href="#cb24-74"></a>  <span class="fu">summarise</span>(<span class="at">totSpaceuse =</span> <span class="fu">sum</span>(f.cont.scaled)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-75"><a href="#cb24-75"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb24-76"><a href="#cb24-76"></a>  <span class="fu">mutate</span>(<span class="at">visit =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb24-77"><a href="#cb24-77"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-78"><a href="#cb24-78"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode))</span>
<span id="cb24-79"><a href="#cb24-79"></a></span>
<span id="cb24-80"><a href="#cb24-80"></a><span class="co"># Load data from previous scripts for use in a GLM</span></span>
<span id="cb24-81"><a href="#cb24-81"></a>vegData <span class="ot">&lt;-</span>  <span class="fu">read.csv</span>(<span class="st">&quot;results/summaryVeg.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-82"><a href="#cb24-82"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(Site_ID, <span class="st">&#39;OLCAP5B&#39;</span>))</span>
<span id="cb24-83"><a href="#cb24-83"></a>vegPcaScores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/pcaVeg.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-84"><a href="#cb24-84"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(Site_ID, <span class="st">&#39;OLCAP5B&#39;</span>))</span></code></pre></div>
</div>
<div id="getting-data-ready-in-a-format-for-linear-modeling" class="section level3 hasAnchor" number="0.7.3">
<h3><span class="header-section-number">0.7.3</span> Getting data ready in a format for linear modeling<a href="#getting-data-ready-in-a-format-for-linear-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># overall space use</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>modelDataAll <span class="ot">&lt;-</span> vegPcaScores <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">rename</span>(<span class="at">Site =</span> Site_ID) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="fu">rename</span>(<span class="at">Restoration.type =</span> Site_type) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Restoration.type, factor))  <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="fu">full_join</span>(totSpaceUse, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7"></a>  <span class="fu">mutate</span>(<span class="st">&quot;roundSpaceuse&quot;</span> <span class="ot">=</span> <span class="fu">round</span>(totSpaceuse))</span>
<span id="cb25-8"><a href="#cb25-8"></a></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="co"># diurnal space use</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>modelDataDiurnal <span class="ot">&lt;-</span> vegPcaScores <span class="sc">%&gt;%</span> </span>
<span id="cb25-11"><a href="#cb25-11"></a>  <span class="fu">rename</span>(<span class="at">Site =</span> Site_ID) <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>  <span class="fu">rename</span>(<span class="at">Restoration.type =</span> Site_type) <span class="sc">%&gt;%</span></span>
<span id="cb25-13"><a href="#cb25-13"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Restoration.type, factor))  <span class="sc">%&gt;%</span></span>
<span id="cb25-14"><a href="#cb25-14"></a>  <span class="fu">full_join</span>(totSpaceUseDiurnal, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-15"><a href="#cb25-15"></a>  <span class="fu">mutate</span>(<span class="st">&quot;roundSpaceuse&quot;</span> <span class="ot">=</span> <span class="fu">round</span>(totSpaceuse))</span>
<span id="cb25-16"><a href="#cb25-16"></a></span>
<span id="cb25-17"><a href="#cb25-17"></a><span class="co"># nocturnal space use</span></span>
<span id="cb25-18"><a href="#cb25-18"></a>modelDataNocturnal <span class="ot">&lt;-</span> vegPcaScores <span class="sc">%&gt;%</span> </span>
<span id="cb25-19"><a href="#cb25-19"></a>  <span class="fu">rename</span>(<span class="at">Site =</span> Site_ID) <span class="sc">%&gt;%</span></span>
<span id="cb25-20"><a href="#cb25-20"></a>  <span class="fu">rename</span>(<span class="at">Restoration.type =</span> Site_type) <span class="sc">%&gt;%</span></span>
<span id="cb25-21"><a href="#cb25-21"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Restoration.type, factor))  <span class="sc">%&gt;%</span></span>
<span id="cb25-22"><a href="#cb25-22"></a>  <span class="fu">full_join</span>(totSpaceUseNocturnal, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-23"><a href="#cb25-23"></a>  <span class="fu">mutate</span>(<span class="st">&quot;roundSpaceuse&quot;</span> <span class="ot">=</span> <span class="fu">round</span>(totSpaceuse))</span></code></pre></div>
</div>
<div id="running-the-generalized-linear-mixed-models" class="section level3 hasAnchor" number="0.7.4">
<h3><span class="header-section-number">0.7.4</span> Running the generalized linear mixed models<a href="#running-the-generalized-linear-mixed-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We now run generalized linear mixed models (GLMM) assuming gaussian errors to examine the effects of restoration type (benchmark, actively restored and passively restored) on acoustic space use, followed by TukeyHSD multiple comparisons tests of means.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># overall space use</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>glmm_allRestoration <span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundSpaceuse <span class="sc">~</span> Restoration.type <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> modelDataAll, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb26-3"><a href="#cb26-3"></a></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="fu">summary</span>(glmm_allRestoration)</span>
<span id="cb26-5"><a href="#cb26-5"></a>tukey_glmmAllRestoration <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">glht</span>(glmm_allRestoration, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Restoration.type =</span><span class="st">&quot;Tukey&quot;</span>)))</span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="fu">cld</span>(tukey_glmmAllRestoration)</span>
<span id="cb26-7"><a href="#cb26-7"></a></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co"># The above result suggests a significant difference in acoustic space use between BM-AR and BM-NR sites, but no difference between AR and NR sites. </span></span>
<span id="cb26-9"><a href="#cb26-9"></a></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co"># diurnal</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>glmm_diurnalRestoration <span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundSpaceuse <span class="sc">~</span> Restoration.type <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> modelDataDiurnal, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb26-12"><a href="#cb26-12"></a></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="fu">summary</span>(glmm_diurnalRestoration)</span>
<span id="cb26-14"><a href="#cb26-14"></a>tukey_glmmDiurnalRestoration <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">glht</span>(glmm_diurnalRestoration, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Restoration.type =</span><span class="st">&quot;Tukey&quot;</span>)))</span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="fu">cld</span>(tukey_glmmDiurnalRestoration)</span>
<span id="cb26-16"><a href="#cb26-16"></a></span>
<span id="cb26-17"><a href="#cb26-17"></a><span class="co"># When we look at only the diurnal data, there is a significant difference in acoustic space use between BM-AR and BM-NR sites, but no difference between AR and NR sites. </span></span>
<span id="cb26-18"><a href="#cb26-18"></a></span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="co"># nocturnal data</span></span>
<span id="cb26-20"><a href="#cb26-20"></a>glmm_nocturnalRestoration <span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundSpaceuse <span class="sc">~</span> Restoration.type <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> modelDataNocturnal, <span class="at">family=</span><span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb26-21"><a href="#cb26-21"></a></span>
<span id="cb26-22"><a href="#cb26-22"></a><span class="fu">summary</span>(glmm_nocturnalRestoration)</span>
<span id="cb26-23"><a href="#cb26-23"></a>tukey_glmmNocturnalRestoration <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">glht</span>(glmm_nocturnalRestoration, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Restoration.type =</span><span class="st">&quot;Tukey&quot;</span>)))</span>
<span id="cb26-24"><a href="#cb26-24"></a><span class="fu">cld</span>(tukey_glmmNocturnalRestoration)</span>
<span id="cb26-25"><a href="#cb26-25"></a></span>
<span id="cb26-26"><a href="#cb26-26"></a><span class="co"># When we look at only the diurnal data, there is a significant difference in acoustic space use between BM-AR and BM-NR sites, but no difference between AR and NR sites.  </span></span>
<span id="cb26-27"><a href="#cb26-27"></a></span>
<span id="cb26-28"><a href="#cb26-28"></a><span class="co"># Plotting the above results</span></span>
<span id="cb26-29"><a href="#cb26-29"></a></span>
<span id="cb26-30"><a href="#cb26-30"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb26-31"><a href="#cb26-31"></a>modelDataAll<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(modelDataAll<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb26-32"><a href="#cb26-32"></a><span class="co"># Add a custom set of colors</span></span>
<span id="cb26-33"><a href="#cb26-33"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>), <span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Paired&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb26-34"><a href="#cb26-34"></a></span>
<span id="cb26-35"><a href="#cb26-35"></a>fig_glmm_allRest <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(modelDataAll, <span class="fu">aes</span>(Restoration.type, totSpaceuse, <span class="at">fill =</span> Restoration.type)) <span class="sc">+</span> </span>
<span id="cb26-36"><a href="#cb26-36"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb26-37"><a href="#cb26-37"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="sc">+</span> </span>
<span id="cb26-38"><a href="#cb26-38"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb26-39"><a href="#cb26-39"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb26-40"><a href="#cb26-40"></a>       <span class="at">y=</span><span class="st">&quot;Acoustic Space Use</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-41"><a href="#cb26-41"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb26-42"><a href="#cb26-42"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb26-43"><a href="#cb26-43"></a>      <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb26-44"><a href="#cb26-44"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb26-45"><a href="#cb26-45"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb26-46"><a href="#cb26-46"></a></span>
<span id="cb26-47"><a href="#cb26-47"></a><span class="fu">ggsave</span>(fig_glmm_allRest, <span class="at">filename =</span> <span class="st">&quot;figs/fig_glmm_overallAcousticSpace.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>, <span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>);<span class="fu">dev.off</span>()</span>
<span id="cb26-48"><a href="#cb26-48"></a></span>
<span id="cb26-49"><a href="#cb26-49"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb26-50"><a href="#cb26-50"></a>modelDataDiurnal<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(modelDataDiurnal<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb26-51"><a href="#cb26-51"></a></span>
<span id="cb26-52"><a href="#cb26-52"></a>fig_glmm_diurnalRest <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(modelDataDiurnal, <span class="fu">aes</span>(Restoration.type, totSpaceuse, <span class="at">group =</span> Restoration.type, <span class="at">fill =</span> Restoration.type)) <span class="sc">+</span> </span>
<span id="cb26-53"><a href="#cb26-53"></a> <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb26-54"><a href="#cb26-54"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb26-55"><a href="#cb26-55"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb26-56"><a href="#cb26-56"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb26-57"><a href="#cb26-57"></a>       <span class="at">y=</span><span class="st">&quot;Acoustic Space Use</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-58"><a href="#cb26-58"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb26-59"><a href="#cb26-59"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb26-60"><a href="#cb26-60"></a>      <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb26-61"><a href="#cb26-61"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb26-62"><a href="#cb26-62"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb26-63"><a href="#cb26-63"></a></span>
<span id="cb26-64"><a href="#cb26-64"></a><span class="fu">ggsave</span>(fig_glmm_diurnalRest, <span class="at">filename =</span> <span class="st">&quot;figs/fig_glmm_diurnalAcousticSpaceUse.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>, <span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>);<span class="fu">dev.off</span>()</span>
<span id="cb26-65"><a href="#cb26-65"></a></span>
<span id="cb26-66"><a href="#cb26-66"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb26-67"><a href="#cb26-67"></a>modelDataNocturnal<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(modelDataNocturnal<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb26-68"><a href="#cb26-68"></a></span>
<span id="cb26-69"><a href="#cb26-69"></a>fig_glmm_nocturnalRest <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(modelDataNocturnal, <span class="fu">aes</span>(Restoration.type, totSpaceuse, <span class="at">group =</span> Restoration.type, <span class="at">fill =</span> Restoration.type)) <span class="sc">+</span> </span>
<span id="cb26-70"><a href="#cb26-70"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb26-71"><a href="#cb26-71"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb26-72"><a href="#cb26-72"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb26-73"><a href="#cb26-73"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb26-74"><a href="#cb26-74"></a>       <span class="at">y=</span><span class="st">&quot;Acoustic Space Use</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-75"><a href="#cb26-75"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb26-76"><a href="#cb26-76"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb26-77"><a href="#cb26-77"></a>      <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb26-78"><a href="#cb26-78"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb26-79"><a href="#cb26-79"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb26-80"><a href="#cb26-80"></a>  </span>
<span id="cb26-81"><a href="#cb26-81"></a><span class="fu">ggsave</span>(fig_glmm_nocturnalRest, <span class="at">filename =</span> <span class="st">&quot;figs/fig_glmm_nocturnalAcousticSpaceUse.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>, <span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>);<span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig_glmm_overallAcousticSpace.png" alt="" />
<p class="caption"><strong>Overall acoustic space use across treatment types.</strong>
Analysis of ~4,128 hours of acoustic data across treatment types (for the 43 sites) revealed significant differences in ASU across BM-AR and BM-NR sites, with the highest estimate in BM sites (mean ± SD: 413 ± 103), followed by AR sites (mean ± SD: 188 ± 78) and NR sites (mean ± SD: 182 ± 66). In the above figure, BM = undisturbed benchmark rainforest sites, AR = Actively restored forest sites and NR = Naturally regenerating forest sites.</p>
</div>
</div>
<div id="we-now-run-generalized-linear-mixed-models-glmm-assuming-gaussian-errors-and-using-log-link-functions-to-examine-the-effects-of-habitat-vegetation-structure-on-acoustic-space-use." class="section level3 hasAnchor" number="0.7.5">
<h3><span class="header-section-number">0.7.5</span> We now run generalized linear mixed models (GLMM) assuming gaussian errors and using log link functions to examine the effects of habitat (vegetation structure) on acoustic space use.<a href="#we-now-run-generalized-linear-mixed-models-glmm-assuming-gaussian-errors-and-using-log-link-functions-to-examine-the-effects-of-habitat-vegetation-structure-on-acoustic-space-use." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># overall space use</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>glmm_allVeg<span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundSpaceuse <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> modelDataAll, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="fu">summary</span>(glmm_allVeg)</span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="fu">plot_model</span>(glmm_allVeg, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>,<span class="st">&quot;PC2&quot;</span>))</span>
<span id="cb27-6"><a href="#cb27-6"></a>report<span class="sc">::</span><span class="fu">report</span>(glmm_allVeg)</span>
<span id="cb27-7"><a href="#cb27-7"></a></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict roundSpaceuse with PC1 and PC2 (formula: roundSpaceuse ~ PC1 + PC2). The model included siteCode and visit as random effects (formula: list(~1 | siteCode, ~1 | visit)). The model&#39;s total explanatory power is substantial (conditional R2 = 0.77) and the part related to the fixed effects alone (marginal R2) is of 0.10. The model&#39;s intercept, corresponding to PC1 = 0 and PC2 = 0, is at 294.12 (95% CI [254.39, 333.84], t(204) = 14.60, p &lt; .001). Within this model:</span></span>
<span id="cb27-9"><a href="#cb27-9"></a></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="co">#  - The effect of PC1 is statistically significant and negative (beta = -20.20, 95% CI [-29.35, -11.04], t(204) = -4.35, p &lt; .001; Std. beta = -0.28, 95% CI [-0.41, -0.15])</span></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="co">#  - The effect of PC2 is statistically non-significant and negative (beta = -12.66, 95% CI [-26.83, 1.51], t(204) = -1.76, p = 0.080; Std. beta = -0.10, 95% CI [-0.22, 0.01])</span></span>
<span id="cb27-12"><a href="#cb27-12"></a></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co"># Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation</span></span>
<span id="cb27-14"><a href="#cb27-14"></a></span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="co"># diurnal</span></span>
<span id="cb27-16"><a href="#cb27-16"></a>glmm_diurnalVeg<span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundSpaceuse <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> modelDataDiurnal, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb27-17"><a href="#cb27-17"></a></span>
<span id="cb27-18"><a href="#cb27-18"></a><span class="fu">summary</span>(glmm_diurnalVeg)</span>
<span id="cb27-19"><a href="#cb27-19"></a><span class="fu">plot_model</span>(glmm_diurnalVeg, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;PC2&quot;</span>,<span class="st">&quot;PC1&quot;</span>))</span>
<span id="cb27-20"><a href="#cb27-20"></a>report<span class="sc">::</span><span class="fu">report</span>(glmm_diurnalVeg)</span>
<span id="cb27-21"><a href="#cb27-21"></a></span>
<span id="cb27-22"><a href="#cb27-22"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict roundSpaceuse with PC1 and PC2 (formula: roundSpaceuse ~ PC1 + PC2). The model included siteCode and visit as random effects (formula: list(~1 | siteCode, ~1 | visit)). The model&#39;s explanatory power related to the fixed effects alone (marginal R2) is 0.26. The model&#39;s intercept, corresponding to PC1 = 0 and PC2 = 0, is at 145.60 (95% CI [122.30, 168.89], t(204) = 12.32, p &lt; .001). Within this model:</span></span>
<span id="cb27-23"><a href="#cb27-23"></a></span>
<span id="cb27-24"><a href="#cb27-24"></a><span class="co">#  - The effect of PC1 is statistically significant and negative (beta = -12.91, 95% CI [-18.99, -6.82], t(204) = -4.18, p &lt; .001; Std. beta = -0.29, 95% CI [-0.43, -0.15])</span></span>
<span id="cb27-25"><a href="#cb27-25"></a><span class="co">#  - The effect of PC2 is statistically non-significant and negative (beta = -1.10, 95% CI [-10.62, 8.43], t(204) = -0.23, p = 0.821; Std. beta = -0.01, 95% CI [-0.14, 0.11])</span></span>
<span id="cb27-26"><a href="#cb27-26"></a></span>
<span id="cb27-27"><a href="#cb27-27"></a><span class="co"># Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</span></span>
<span id="cb27-28"><a href="#cb27-28"></a></span>
<span id="cb27-29"><a href="#cb27-29"></a><span class="co"># nocturnal</span></span>
<span id="cb27-30"><a href="#cb27-30"></a>glmm_nocturnalVeg<span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundSpaceuse <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> modelDataNocturnal, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb27-31"><a href="#cb27-31"></a></span>
<span id="cb27-32"><a href="#cb27-32"></a><span class="fu">summary</span>(glmm_nocturnalVeg)</span>
<span id="cb27-33"><a href="#cb27-33"></a><span class="fu">plot_model</span>(glmm_nocturnalVeg, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>,<span class="st">&quot;PC2&quot;</span>))</span>
<span id="cb27-34"><a href="#cb27-34"></a>report<span class="sc">::</span><span class="fu">report</span>(glmm_nocturnalVeg)</span>
<span id="cb27-35"><a href="#cb27-35"></a></span>
<span id="cb27-36"><a href="#cb27-36"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict roundSpaceuse with PC1 and PC2 (formula: roundSpaceuse ~ PC1 + PC2). The model included siteCode and visit as random effects (formula: list(~1 | siteCode, ~1 | visit)). The model&#39;s total explanatory power is substantial (conditional R2 = 0.80) and the part related to the fixed effects alone (marginal R2) is of 0.05. The model&#39;s intercept, corresponding to PC1 = 0 and PC2 = 0, is at 134.62 (95% CI [110.39, 158.85], t(204) = 10.96, p &lt; .001). Within this model:</span></span>
<span id="cb27-37"><a href="#cb27-37"></a></span>
<span id="cb27-38"><a href="#cb27-38"></a><span class="co">#  - The effect of PC1 is statistically significant and negative (beta = -6.95, 95% CI [-12.04, -1.87], t(204) = -2.70, p = 0.008; Std. beta = -0.19, 95% CI [-0.32, -0.05])</span></span>
<span id="cb27-39"><a href="#cb27-39"></a><span class="co">#  - The effect of PC2 is statistically significant and negative (beta = -10.09, 95% CI [-17.89, -2.28], t(204) = -2.55, p = 0.012; Std. beta = -0.16, 95% CI [-0.28, -0.04])</span></span>
<span id="cb27-40"><a href="#cb27-40"></a></span>
<span id="cb27-41"><a href="#cb27-41"></a><span class="co"># Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation. </span></span></code></pre></div>
</div>
</div>
<div id="main-text-figure-4" class="section level2 hasAnchor" number="0.8">
<h2><span class="header-section-number">0.8</span> Main Text Figure 4<a href="#main-text-figure-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># Patchworking nmds and glmm for acoustic space use to create part a and b for Fig. 4</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb28-3"><a href="#cb28-3"></a></span>
<span id="cb28-4"><a href="#cb28-4"></a>fig_glmm_ordinations <span class="ot">&lt;-</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="fu">wrap_plots</span>(fig_glmm_allRest, fig_nmds,</span>
<span id="cb28-6"><a href="#cb28-6"></a>    <span class="at">design =</span> <span class="st">&quot;AABBBB&quot;</span></span>
<span id="cb28-7"><a href="#cb28-7"></a>  ) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb28-9"><a href="#cb28-9"></a>    <span class="at">tag_levels =</span> <span class="st">&quot;a&quot;</span>,</span>
<span id="cb28-10"><a href="#cb28-10"></a>    <span class="at">tag_prefix =</span> <span class="st">&quot;(&quot;</span>,</span>
<span id="cb28-11"><a href="#cb28-11"></a>    <span class="at">tag_suffix =</span> <span class="st">&quot;)&quot;</span></span>
<span id="cb28-12"><a href="#cb28-12"></a>  )</span>
<span id="cb28-13"><a href="#cb28-13"></a></span>
<span id="cb28-14"><a href="#cb28-14"></a><span class="co"># Expand the width to avoid compression</span></span>
<span id="cb28-15"><a href="#cb28-15"></a><span class="fu">ggsave</span>(fig_glmm_ordinations, <span class="at">filename =</span> <span class="st">&quot;figs/fig04.png&quot;</span>, <span class="at">width=</span><span class="dv">20</span>, <span class="at">height=</span><span class="dv">7</span>,<span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig03.png" alt="" />
<p class="caption">Acoustic space use across treatment types. (a) Analysis of ~4,128 hours of acoustic data across treatment types (for the 43 sites) revealed significant differences in ASU between BM-AR and BM-NR sites (Tukey HSD P &lt; 0.05). ASU was the highest in BM sites (mean ± SD: 413 ± 103), followed by AR sites (mean ± SD: 188 ± 78) and NR sites (mean ± SD: 182 ± 66). (b) NMDS ordination of ASU (stress = 0.008) revealed a loose cluster of benchmark sites, while actively restored and naturally regenerating sites showed tight overlapping clusters. In the above figure, BM = undisturbed benchmark rainforest sites, AR = Actively restored forest sites, and NR = Naturally regenerating forest sites.</p>
</div>

</div>
<div id="splitting-large-.wav-files" class="section level2 hasAnchor" number="0.9">
<h2><span class="header-section-number">0.9</span> Splitting large .wav files<a href="#splitting-large-.wav-files" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here, we will first split the raw data which was collected for 24 hours at a site, for 7 days at a stretch. This is being done for the sake of manual annotation of bird species. The deployment schedule of the AudioMoths was set to record for 4-minutes and was switched off for 1-min. For the sake of analysis, data was split into 10s chunks and annotated manually using Raven Pro.</p>
<div id="load-required-libraries" class="section level3 hasAnchor" number="0.9.1">
<h3><span class="header-section-number">0.9.1</span> Load required libraries<a href="#load-required-libraries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">library</span>(warbleR)</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="fu">library</span>(seewave)</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="fu">library</span>(stringr)</span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="fu">library</span>(tools)</span>
<span id="cb29-6"><a href="#cb29-6"></a></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
<div id="selecting-dawn-acoustic-data" class="section level3 hasAnchor" number="0.9.2">
<h3><span class="header-section-number">0.9.2</span> Selecting dawn acoustic data<a href="#selecting-dawn-acoustic-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will use warbleR::split.wavs() to split a large file. To do so, we will first load a list of .wav files from folders (will have to be done site by site). Next, we we select only files between 6 am and 10 am (this can be varied depending on the exercise or the question at hand). For each day selected, we randomly extracted a continuous 16-min of recording.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># List the path that contains all folders, which contain the audiomoth data</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;C:</span><span class="sc">\\</span><span class="st">data</span><span class="sc">\\</span><span class="st">2020-winter</span><span class="sc">\\</span><span class="st">&quot;</span></span>
<span id="cb30-3"><a href="#cb30-3"></a></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co"># Listing the folders within which .WAV files are stored</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>folders <span class="ot">&lt;-</span> <span class="fu">dir</span>(path, <span class="at">recursive=</span>F,<span class="at">full.names=</span>T)</span>
<span id="cb30-6"><a href="#cb30-6"></a></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="co"># Now get only those files that begin at 6am and end at 10am</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>files <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb30-9"><a href="#cb30-9"></a></span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(folders)){</span>
<span id="cb30-11"><a href="#cb30-11"></a></span>
<span id="cb30-12"><a href="#cb30-12"></a><span class="fu">setwd</span>(folders[i])</span>
<span id="cb30-13"><a href="#cb30-13"></a></span>
<span id="cb30-14"><a href="#cb30-14"></a><span class="co"># Below code needs to be run only if we have to rename files</span></span>
<span id="cb30-15"><a href="#cb30-15"></a><span class="co"># List the files within each folder and renaming the files with the prefix - SITE_ID</span></span>
<span id="cb30-16"><a href="#cb30-16"></a>a <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">paste0</span>(path,<span class="fu">basename</span>(folders)[i],<span class="st">&quot;</span><span class="sc">\\</span><span class="st">&quot;</span>), <span class="at">full.names =</span> T)</span>
<span id="cb30-17"><a href="#cb30-17"></a><span class="fu">file.rename</span>(<span class="at">from =</span> a, <span class="at">to=</span><span class="fu">paste0</span>(<span class="fu">basename</span>(folders)[i],<span class="st">&quot;_&quot;</span>,<span class="fu">basename</span>(a)))</span>
<span id="cb30-18"><a href="#cb30-18"></a></span>
<span id="cb30-19"><a href="#cb30-19"></a><span class="co"># Extract the strings for .wav files between 6am and 10am</span></span>
<span id="cb30-20"><a href="#cb30-20"></a>time_str <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">paste0</span>(path,<span class="fu">basename</span>(folders)[i],<span class="st">&quot;</span><span class="sc">\\</span><span class="st">&quot;</span>),<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb30-21"><a href="#cb30-21"></a>                    tools<span class="sc">::</span><span class="fu">file_path_sans_ext</span>() <span class="sc">%&gt;%</span> <span class="fu">str_extract</span>(<span class="st">&#39;</span><span class="sc">\\</span><span class="st">d+$&#39;</span>)</span>
<span id="cb30-22"><a href="#cb30-22"></a>time_str <span class="ot">&lt;-</span> time_str[time_str<span class="sc">&gt;=</span><span class="st">&quot;060000&quot;</span> <span class="sc">&amp;</span> time_str <span class="sc">&lt;=</span><span class="st">&quot;100000&quot;</span>] <span class="co"># vary times here depending on the question at hand</span></span>
<span id="cb30-23"><a href="#cb30-23"></a></span>
<span id="cb30-24"><a href="#cb30-24"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(time_str))){</span>
<span id="cb30-25"><a href="#cb30-25"></a>    </span>
<span id="cb30-26"><a href="#cb30-26"></a>    b <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">paste0</span>(path,<span class="fu">basename</span>(folders)[i],<span class="st">&quot;</span><span class="sc">\\</span><span class="st">&quot;</span>),<span class="at">full.names =</span> T,</span>
<span id="cb30-27"><a href="#cb30-27"></a>                    <span class="at">pattern =</span> time_str[j])</span>
<span id="cb30-28"><a href="#cb30-28"></a>    files <span class="ot">&lt;-</span> <span class="fu">c</span>(files,b)</span>
<span id="cb30-29"><a href="#cb30-29"></a>    }</span>
<span id="cb30-30"><a href="#cb30-30"></a>}</span>
<span id="cb30-31"><a href="#cb30-31"></a></span>
<span id="cb30-32"><a href="#cb30-32"></a><span class="co"># These are the list of files we need</span></span>
<span id="cb30-33"><a href="#cb30-33"></a>files <span class="ot">&lt;-</span> <span class="fu">unlist</span>(files)</span>
<span id="cb30-34"><a href="#cb30-34"></a></span>
<span id="cb30-35"><a href="#cb30-35"></a><span class="co"># Now we choose a random consecutive 16 min of data between 6am and 10am</span></span>
<span id="cb30-36"><a href="#cb30-36"></a><span class="co"># Get a list of unique dates (since we will be generating a random 16min for every date across every site)</span></span>
<span id="cb30-37"><a href="#cb30-37"></a></span>
<span id="cb30-38"><a href="#cb30-38"></a>site_date <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(<span class="fu">basename</span>(files),<span class="st">&#39;</span><span class="sc">\\</span><span class="st">w+_</span><span class="sc">\\</span><span class="st">d+_&#39;</span>)</span>
<span id="cb30-39"><a href="#cb30-39"></a><span class="fu">unique</span>(site_date) <span class="co"># Give you unique date and sites for which we need to generate 16 min of data</span></span>
<span id="cb30-40"><a href="#cb30-40"></a></span>
<span id="cb30-41"><a href="#cb30-41"></a>subset_files <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb30-42"><a href="#cb30-42"></a></span>
<span id="cb30-43"><a href="#cb30-43"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(site_date))){</span>
<span id="cb30-44"><a href="#cb30-44"></a>  a <span class="ot">&lt;-</span> files[<span class="fu">str_detect</span>(files,<span class="fu">unique</span>(site_date)[i])]</span>
<span id="cb30-45"><a href="#cb30-45"></a>  <span class="cf">if</span>(<span class="fu">length</span>(a)<span class="sc">&lt;</span><span class="dv">4</span>){ <span class="co"># essentially specifies that the min number you need</span></span>
<span id="cb30-46"><a href="#cb30-46"></a>    <span class="cf">next</span></span>
<span id="cb30-47"><a href="#cb30-47"></a>  } <span class="cf">else</span> {</span>
<span id="cb30-48"><a href="#cb30-48"></a>  subset_dat <span class="ot">&lt;-</span> <span class="fu">extractRandWindow</span>(a,<span class="dv">4</span>)</span>
<span id="cb30-49"><a href="#cb30-49"></a>  subset_dat <span class="ot">&lt;-</span> <span class="fu">na.exclude</span>(subset_dat) <span class="co"># If there are less than 4 files</span></span>
<span id="cb30-50"><a href="#cb30-50"></a>  subset_files <span class="ot">&lt;-</span> <span class="fu">c</span>(subset_files, subset_dat)</span>
<span id="cb30-51"><a href="#cb30-51"></a>  }</span>
<span id="cb30-52"><a href="#cb30-52"></a>}</span>
<span id="cb30-53"><a href="#cb30-53"></a></span>
<span id="cb30-54"><a href="#cb30-54"></a>final_subset <span class="ot">&lt;-</span> <span class="fu">unlist</span>(subset_files)</span>
<span id="cb30-55"><a href="#cb30-55"></a></span>
<span id="cb30-56"><a href="#cb30-56"></a><span class="co"># Subset those files and copy it to a separate folder</span></span>
<span id="cb30-57"><a href="#cb30-57"></a><span class="co"># Please note that these folders &amp; files are locally stored (they are extremely large and cannot be added to GitHub)</span></span>
<span id="cb30-58"><a href="#cb30-58"></a><span class="fu">dir.create</span>(<span class="fu">paste0</span>(<span class="st">&quot;C:</span><span class="sc">\\</span><span class="st">data</span><span class="sc">\\</span><span class="st">&quot;</span>,<span class="st">&quot;subset&quot;</span>))</span>
<span id="cb30-59"><a href="#cb30-59"></a><span class="fu">file.copy</span>(<span class="at">from =</span> final_subset, <span class="at">to=</span><span class="st">&quot;C:</span><span class="sc">\\</span><span class="st">data</span><span class="sc">\\</span><span class="st">subset</span><span class="sc">\\</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="split-the-files" class="section level3 hasAnchor" number="0.9.3">
<h3><span class="header-section-number">0.9.3</span> Split the files<a href="#split-the-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Split the files and provide unique names to each file</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># Note: the path you choose to store data is upto the user.</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>subset_path <span class="ot">&lt;-</span> <span class="st">&quot;C:</span><span class="sc">\\</span><span class="st">data</span><span class="sc">\\</span><span class="st">subset</span><span class="sc">\\</span><span class="st">&quot;</span></span>
<span id="cb31-3"><a href="#cb31-3"></a></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co"># Split the files into n-second chunks</span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="fu">split_wavs</span>(<span class="at">path=</span>subset_path, <span class="at">sgmt.dur =</span> <span class="dv">10</span>, <span class="at">parallel=</span><span class="dv">4</span>)</span>
<span id="cb31-6"><a href="#cb31-6"></a></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="co"># Get files that need to be renamed</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>split_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(subset_path, <span class="at">full.names =</span> T, <span class="at">pattern =</span> <span class="st">&quot;-&quot;</span>)</span>
<span id="cb31-9"><a href="#cb31-9"></a></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="co"># Note the number of chunks will vary as a function of segment duration</span></span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="co"># 240 seconds = 24 chunks each of 10s</span></span>
<span id="cb31-12"><a href="#cb31-12"></a></span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="fu">setwd</span>(subset_path)</span>
<span id="cb31-14"><a href="#cb31-14"></a></span>
<span id="cb31-15"><a href="#cb31-15"></a>chunks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;01-10&quot;</span>,<span class="st">&quot;10-20&quot;</span>,<span class="st">&quot;20-30&quot;</span>,</span>
<span id="cb31-16"><a href="#cb31-16"></a>            <span class="st">&quot;30-40&quot;</span>,<span class="st">&quot;40-50&quot;</span>,<span class="st">&quot;50-60&quot;</span>,</span>
<span id="cb31-17"><a href="#cb31-17"></a>            <span class="st">&quot;60-70&quot;</span>,<span class="st">&quot;70-80&quot;</span>,<span class="st">&quot;80-90&quot;</span>,</span>
<span id="cb31-18"><a href="#cb31-18"></a>            <span class="st">&quot;90-100&quot;</span>,<span class="st">&quot;100-110&quot;</span>,<span class="st">&quot;110-120&quot;</span>,</span>
<span id="cb31-19"><a href="#cb31-19"></a>            <span class="st">&quot;120-130&quot;</span>,<span class="st">&quot;130-140&quot;</span>,<span class="st">&quot;140-150&quot;</span>,</span>
<span id="cb31-20"><a href="#cb31-20"></a>            <span class="st">&quot;150-160&quot;</span>,<span class="st">&quot;160-170&quot;</span>,<span class="st">&quot;170-180&quot;</span>,</span>
<span id="cb31-21"><a href="#cb31-21"></a>            <span class="st">&quot;180-190&quot;</span>,<span class="st">&quot;190-200&quot;</span>,<span class="st">&quot;200-210&quot;</span>,</span>
<span id="cb31-22"><a href="#cb31-22"></a>            <span class="st">&quot;210-220&quot;</span>,<span class="st">&quot;220-230&quot;</span>,<span class="st">&quot;230-240&quot;</span>)</span>
<span id="cb31-23"><a href="#cb31-23"></a></span>
<span id="cb31-24"><a href="#cb31-24"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(chunks)){</span>
<span id="cb31-25"><a href="#cb31-25"></a>  c <span class="ot">&lt;-</span> split_files[<span class="fu">endsWith</span>(split_files,<span class="fu">paste0</span>(<span class="st">&quot;-&quot;</span>,i,<span class="st">&quot;.wav&quot;</span>))]</span>
<span id="cb31-26"><a href="#cb31-26"></a>  d <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(c,<span class="fu">paste0</span>(<span class="st">&quot;-&quot;</span>,i),<span class="fu">paste0</span>(<span class="st">&quot;_&quot;</span>,chunks[i]))</span>
<span id="cb31-27"><a href="#cb31-27"></a>  <span class="fu">file.rename</span>(<span class="at">from=</span>c, <span class="at">to=</span>d)</span>
<span id="cb31-28"><a href="#cb31-28"></a>}</span>
<span id="cb31-29"><a href="#cb31-29"></a></span>
<span id="cb31-30"><a href="#cb31-30"></a><span class="co"># Remove the original files</span></span>
<span id="cb31-31"><a href="#cb31-31"></a>orig_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(subset_path, <span class="at">full.names =</span> T, <span class="at">pattern =</span> <span class="st">&quot;.WAV$&quot;</span>)</span>
<span id="cb31-32"><a href="#cb31-32"></a><span class="fu">file.remove</span>(orig_files)</span></code></pre></div>
<p>Now, go ahead and begin the process of manual annotation!</p>

</div>
</div>
<div id="bird-species-richness" class="section level2 hasAnchor" number="0.10">
<h2><span class="header-section-number">0.10</span> Bird Species Richness<a href="#bird-species-richness" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this script, we will calculate:</p>
<ol style="list-style-type: lower-alpha">
<li>Site-wise species richness to understand if species composition across treatment types are distinctly different.</li>
<li>Repeat the above calculations, but using species traits - If a species is a rainforest specialist or an open-country generalist.</li>
</ol>
<div id="install-required-libraries-3" class="section level3 hasAnchor" number="0.10.1">
<h3><span class="header-section-number">0.10.1</span> Install required libraries<a href="#install-required-libraries-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="fu">library</span>(vegan)</span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="fu">library</span>(scico)</span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="fu">library</span>(data.table)</span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb32-9"><a href="#cb32-9"></a></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
<div id="load-manual-annotations-data" class="section level3 hasAnchor" number="0.10.2">
<h3><span class="header-section-number">0.10.2</span> Load manual annotations data<a href="#load-manual-annotations-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To start with, we will compute species richness from 3 non-consecutive visits for each site for each season. Across two seasons, a total of 6 non-consecutive visits are chosen for each site.</p>
<p>We will use an excel sheet of manual annotations, which contains 10s-clips from each site (A random 16-min was chosen between 6am and 10am and divided into 10s chunks for the ease of annotations).</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># Attach the annotation data for summer and winter</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>summer_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/2020-summer-annotation-working-document.csv&quot;</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a>winter_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/2020-winter-annotation-working-document.csv&quot;</span>)</span>
<span id="cb33-4"><a href="#cb33-4"></a></span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="do">## Please write to the lead author if you would like to access this data (Vijay Ramesh; vr2352@columbia.edu)</span></span>
<span id="cb33-6"><a href="#cb33-6"></a></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="co"># combine the datasets for a single dataframe for the present analysis</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(summer_data,winter_data)</span>
<span id="cb33-9"><a href="#cb33-9"></a><span class="fu">names</span>(data)</span>
<span id="cb33-10"><a href="#cb33-10"></a></span>
<span id="cb33-11"><a href="#cb33-11"></a><span class="co"># reorder columns</span></span>
<span id="cb33-12"><a href="#cb33-12"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb33-13"><a href="#cb33-13"></a>  <span class="fu">relocate</span>(<span class="fu">c</span>(<span class="st">&quot;BFO&quot;</span>,<span class="st">&quot;SBEO&quot;</span>, <span class="st">&quot;JN&quot;</span>, <span class="st">&quot;AK&quot;</span>, <span class="st">&quot;HSWP&quot;</span>),  <span class="at">.after =</span> <span class="st">&quot;CR&quot;</span>) <span class="co"># certain species codes are mentioned here and these can be found in the supplementary data.</span></span>
<span id="cb33-14"><a href="#cb33-14"></a></span>
<span id="cb33-15"><a href="#cb33-15"></a><span class="co"># Site-wise sorting of the 16-min of data</span></span>
<span id="cb33-16"><a href="#cb33-16"></a></span>
<span id="cb33-17"><a href="#cb33-17"></a><span class="co"># Split the file names into 4 columns : Site, Date, Time and Splits  </span></span>
<span id="cb33-18"><a href="#cb33-18"></a>data <span class="ot">&lt;-</span> <span class="fu">separate</span>(data, <span class="at">col =</span> Filename, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>, <span class="st">&quot;Date&quot;</span>, <span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Splits&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb33-19"><a href="#cb33-19"></a>data</span>
<span id="cb33-20"><a href="#cb33-20"></a></span>
<span id="cb33-21"><a href="#cb33-21"></a><span class="co"># Load the species-trait-data</span></span>
<span id="cb33-22"><a href="#cb33-22"></a>trait_dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/species-trait-dat.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="subset-data" class="section level3 hasAnchor" number="0.10.3">
<h3><span class="header-section-number">0.10.3</span> Subset data<a href="#subset-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How many visits (counted as number of unique days) to a site has been annotated? Please note that some sites have more than 6 visits to a site, and hence we ensure that we choose only 6 non-consecutive visits to a given site.</p>
<p>NOTE: You need to run this only once and if you have already run it, move to the next chunk of code and load datSubset.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># First we remove OLCAP5B - a site for which only 3 visits were made in summer and not sampled as a result of logistic reasons in winter</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(Site, <span class="st">&#39;OLCAP5B&#39;</span>))</span>
<span id="cb34-4"><a href="#cb34-4"></a></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="co"># Number of visits to a particular site</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="co"># Only INBS04U has 5 visits because another visit was not possible due to rain</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>nSites_Days <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Date)<span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Site) <span class="sc">%&gt;%</span> <span class="fu">count</span>(Site)</span>
<span id="cb34-10"><a href="#cb34-10"></a></span>
<span id="cb34-11"><a href="#cb34-11"></a><span class="co"># Unique date site combination to give you a sense of sampling</span></span>
<span id="cb34-12"><a href="#cb34-12"></a>uniqueSiteDate <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span></span>
<span id="cb34-14"><a href="#cb34-14"></a>  <span class="fu">distinct</span>(Date)</span>
<span id="cb34-15"><a href="#cb34-15"></a></span>
<span id="cb34-16"><a href="#cb34-16"></a><span class="co"># Convert date column to YMD format using lubridate::ymd()</span></span>
<span id="cb34-17"><a href="#cb34-17"></a>uniqueSiteDate<span class="sc">$</span>Date <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">ymd</span>(uniqueSiteDate<span class="sc">$</span>Date)</span>
<span id="cb34-18"><a href="#cb34-18"></a></span>
<span id="cb34-19"><a href="#cb34-19"></a><span class="co"># The below lines of code were written following a query on stackOverflow to select six non-consecutive visits to any site</span></span>
<span id="cb34-20"><a href="#cb34-20"></a><span class="co"># Link: https://stackoverflow.com/questions/67212152/select-non-consecutive-dates-for-every-grouped-element-in-r</span></span>
<span id="cb34-21"><a href="#cb34-21"></a></span>
<span id="cb34-22"><a href="#cb34-22"></a>nonConVisits <span class="ot">&lt;-</span> uniqueSiteDate<span class="sc">%&gt;%</span> </span>
<span id="cb34-23"><a href="#cb34-23"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb34-24"><a href="#cb34-24"></a>  <span class="fu">group_split</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb34-25"><a href="#cb34-25"></a>  <span class="fu">map_df</span>(., <span class="sc">~</span> .x <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-26"><a href="#cb34-26"></a>           <span class="fu">arrange</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb34-27"><a href="#cb34-27"></a>           <span class="fu">mutate</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-28"><a href="#cb34-28"></a>           <span class="fu">complete</span>(<span class="at">Date =</span> <span class="fu">seq.Date</span>(<span class="fu">first</span>(Date), <span class="fu">last</span>(Date), <span class="at">by =</span> <span class="st">&#39;days&#39;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb34-29"><a href="#cb34-29"></a>           <span class="fu">group_by</span>(<span class="at">n =</span> <span class="fu">cumsum</span>(<span class="fu">is.na</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb34-30"><a href="#cb34-30"></a>           <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Site)) <span class="sc">%&gt;%</span></span>
<span id="cb34-31"><a href="#cb34-31"></a>           <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-32"><a href="#cb34-32"></a>           <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-33"><a href="#cb34-33"></a>           <span class="fu">sample_n</span>(<span class="fu">min</span>(<span class="fu">n</span>(), <span class="dv">6</span>))</span>
<span id="cb34-34"><a href="#cb34-34"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb34-35"><a href="#cb34-35"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>n)</span>
<span id="cb34-36"><a href="#cb34-36"></a></span>
<span id="cb34-37"><a href="#cb34-37"></a><span class="co"># Change the structure of the date column back to character for using one of the join functions</span></span>
<span id="cb34-38"><a href="#cb34-38"></a>nonConVisits<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">str_remove_all</span>(<span class="fu">as.character</span>(nonConVisits<span class="sc">$</span>Date),<span class="st">&quot;-&quot;</span>)</span>
<span id="cb34-39"><a href="#cb34-39"></a></span>
<span id="cb34-40"><a href="#cb34-40"></a><span class="co"># Left-join with the original dataframe to subset the data for analysis</span></span>
<span id="cb34-41"><a href="#cb34-41"></a>datSubset <span class="ot">&lt;-</span> <span class="fu">left_join</span>(nonConVisits,data)</span>
<span id="cb34-42"><a href="#cb34-42"></a><span class="fu">names</span>(datSubset)</span>
<span id="cb34-43"><a href="#cb34-43"></a></span>
<span id="cb34-44"><a href="#cb34-44"></a><span class="co"># renaming columns</span></span>
<span id="cb34-45"><a href="#cb34-45"></a>datSubset <span class="ot">&lt;-</span> <span class="fu">rename</span>(datSubset, <span class="at">Restoration.type =</span> Restoration.Type..Benchmark.Active.Passive.)</span>
<span id="cb34-46"><a href="#cb34-46"></a></span>
<span id="cb34-47"><a href="#cb34-47"></a><span class="co"># Save this data as a .csv for future analysis (later scripts)</span></span>
<span id="cb34-48"><a href="#cb34-48"></a><span class="fu">write.csv</span>(datSubset,<span class="st">&quot;results/datSubset.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="total-number-of-detections" class="section level3 hasAnchor" number="0.10.4">
<h3><span class="header-section-number">0.10.4</span> Total number of detections<a href="#total-number-of-detections" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now group the data by site and restoration type and sum the number of detections across sites. We will calculate the overall number of detections for each 10s clip, which will be used to estimate species richness below.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># If you have already processed subsetting of data, read it in directly</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>datSubset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/datSubset.csv&quot;</span>)</span>
<span id="cb35-3"><a href="#cb35-3"></a></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="co"># Calculate the overall number of detections for each site across 6 days of data (translates to ~ 96 min of data per site)</span></span>
<span id="cb35-5"><a href="#cb35-5"></a></span>
<span id="cb35-6"><a href="#cb35-6"></a>nDetections_Site <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>  <span class="fu">group_by</span>(Site, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum) </span></code></pre></div>
</div>
<div id="calculate-species-richness" class="section level3 hasAnchor" number="0.10.5">
<h3><span class="header-section-number">0.10.5</span> Calculate species richness<a href="#calculate-species-richness" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Convert the detections to 1, since we are interested in calculating richness per site by converting values &gt;1 to 1 for multiple visits to a site. In other words, we want to establish overall species richness for a 16-min to 48-min window.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>richness <span class="ot">&lt;-</span> nDetections_Site  <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="sc">~</span> <span class="fu">replace</span>(., . <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="fu">mutate</span>(<span class="at">richness =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(IP<span class="sc">:</span>HSWP))) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, richness)</span>
<span id="cb36-6"><a href="#cb36-6"></a></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="co"># Test if there are significant differences in richness across treatment types</span></span>
<span id="cb36-8"><a href="#cb36-8"></a>anovaAll <span class="ot">&lt;-</span> <span class="fu">aov</span>(richness<span class="sc">~</span>Restoration.type, <span class="at">data =</span> richness)</span>
<span id="cb36-9"><a href="#cb36-9"></a></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="co"># Tukey test to study each pair of treatment - reveals no signficant difference across treatment types</span></span>
<span id="cb36-11"><a href="#cb36-11"></a>tukeyAll <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anovaAll)</span>
<span id="cb36-12"><a href="#cb36-12"></a></span>
<span id="cb36-13"><a href="#cb36-13"></a><span class="co"># The above result suggests that there are no differences in overall species richness across treatment types</span></span>
<span id="cb36-14"><a href="#cb36-14"></a></span>
<span id="cb36-15"><a href="#cb36-15"></a><span class="co"># Create a boxplot of species richness by Restoration Type</span></span>
<span id="cb36-16"><a href="#cb36-16"></a></span>
<span id="cb36-17"><a href="#cb36-17"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb36-18"><a href="#cb36-18"></a>richness<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(richness<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb36-19"><a href="#cb36-19"></a><span class="co"># Add a custom set of colors</span></span>
<span id="cb36-20"><a href="#cb36-20"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>), <span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Paired&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb36-21"><a href="#cb36-21"></a></span>
<span id="cb36-22"><a href="#cb36-22"></a>fig_richness <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(richness, <span class="fu">aes</span>(<span class="at">x=</span>Restoration.type, <span class="at">y=</span>richness, <span class="at">fill=</span>Restoration.type)) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb36-23"><a href="#cb36-23"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb36-24"><a href="#cb36-24"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb36-25"><a href="#cb36-25"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb36-26"><a href="#cb36-26"></a>       <span class="at">y=</span><span class="st">&quot;Species Richness</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-27"><a href="#cb36-27"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb36-28"><a href="#cb36-28"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb36-29"><a href="#cb36-29"></a>      <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb36-30"><a href="#cb36-30"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb36-31"><a href="#cb36-31"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb36-32"><a href="#cb36-32"></a></span>
<span id="cb36-33"><a href="#cb36-33"></a><span class="fu">ggsave</span>(fig_richness, <span class="at">filename =</span> <span class="st">&quot;figs/fig_richness.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>,</span>
<span id="cb36-34"><a href="#cb36-34"></a>       <span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>);<span class="fu">dev.off</span>()</span>
<span id="cb36-35"><a href="#cb36-35"></a></span>
<span id="cb36-36"><a href="#cb36-36"></a><span class="co"># We observe that the overall species richness is relatively higher in passively restored forest patches, followed by benchmark (protected area) forest patches and actively restored forest patches (But these differences are not significant)</span></span></code></pre></div>
<p><img src="figs/fig_richness.png" alt="When we examined the overall species richness across treatment types, we did not observe any significant differences." />
### Species richness by trait</p>
<p>Using species trait data to check if species richness varies by treatment type as a function of whether a species is a rainforest specialist vs. open-country specialist. To do so: Add an additional column of species-trait data and group data based on the same.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># First, we pivot the species-codes and then match the codes with trait_data and reformat the data to keep all detections&gt;0 as 1 else they are 0</span></span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>richness_trait <span class="ot">&lt;-</span> nDetections_Site <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>IP<span class="sc">:</span>HSWP, <span class="at">names_to=</span><span class="st">&quot;Species_Code&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>  <span class="fu">left_join</span>(.,trait_dat, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Species_Code&quot;</span><span class="ot">=</span><span class="st">&quot;species_annotation_codes&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6"></a>  <span class="fu">mutate</span>(<span class="at">forRichness =</span> <span class="fu">case_when</span>(count<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb37-7"><a href="#cb37-7"></a>                                 count<span class="sc">==</span><span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>))</span>
<span id="cb37-8"><a href="#cb37-8"></a></span>
<span id="cb37-9"><a href="#cb37-9"></a><span class="co"># Calculate overall richness for each site as a function of rainforest species and open-country species</span></span>
<span id="cb37-10"><a href="#cb37-10"></a></span>
<span id="cb37-11"><a href="#cb37-11"></a>richness_trait <span class="ot">&lt;-</span>  richness_trait <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, Species_Code, habitat, forRichness)<span class="sc">%&gt;%</span></span>
<span id="cb37-13"><a href="#cb37-13"></a>  <span class="fu">group_by</span>(Site, Restoration.type, habitat) <span class="sc">%&gt;%</span></span>
<span id="cb37-14"><a href="#cb37-14"></a>  <span class="fu">summarise</span>(<span class="at">richness =</span> <span class="fu">sum</span>(forRichness)) <span class="sc">%&gt;%</span></span>
<span id="cb37-15"><a href="#cb37-15"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb37-16"><a href="#cb37-16"></a></span>
<span id="cb37-17"><a href="#cb37-17"></a><span class="co"># Let&#39;s subset data for richness as a function of rainforest specialists and open-country generalists and test for significant differences (if any)</span></span>
<span id="cb37-18"><a href="#cb37-18"></a>richness_rainforest <span class="ot">&lt;-</span> richness_trait <span class="sc">%&gt;%</span></span>
<span id="cb37-19"><a href="#cb37-19"></a>  <span class="fu">filter</span>(habitat<span class="sc">==</span><span class="st">&quot;RF&quot;</span>)</span>
<span id="cb37-20"><a href="#cb37-20"></a>richness_opencountry <span class="ot">&lt;-</span> richness_trait <span class="sc">%&gt;%</span></span>
<span id="cb37-21"><a href="#cb37-21"></a>  <span class="fu">filter</span>(habitat<span class="sc">==</span><span class="st">&quot;OC&quot;</span>)</span>
<span id="cb37-22"><a href="#cb37-22"></a></span>
<span id="cb37-23"><a href="#cb37-23"></a><span class="co"># Test if there are significant differences in richness across treatment types as a function of species trait</span></span>
<span id="cb37-24"><a href="#cb37-24"></a>anova_rainforest <span class="ot">&lt;-</span> <span class="fu">aov</span>(richness<span class="sc">~</span>Restoration.type, <span class="at">data =</span> richness_rainforest)</span>
<span id="cb37-25"><a href="#cb37-25"></a>anova_opencountry <span class="ot">&lt;-</span> <span class="fu">aov</span>(richness<span class="sc">~</span>Restoration.type, <span class="at">data =</span> richness_opencountry)</span>
<span id="cb37-26"><a href="#cb37-26"></a></span>
<span id="cb37-27"><a href="#cb37-27"></a><span class="co"># Tukey test to study each pair of treatment - reveals no signficant difference across treatment types for rainforest birds, but a significant difference between benchmark-active and benchmark-passive sites for open country birds</span></span>
<span id="cb37-28"><a href="#cb37-28"></a></span>
<span id="cb37-29"><a href="#cb37-29"></a>tukey_rainforest <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_rainforest)</span>
<span id="cb37-30"><a href="#cb37-30"></a>tukey_opencountry <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_opencountry)</span>
<span id="cb37-31"><a href="#cb37-31"></a></span>
<span id="cb37-32"><a href="#cb37-32"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb37-33"><a href="#cb37-33"></a>richness_trait<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(richness_trait<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb37-34"><a href="#cb37-34"></a></span>
<span id="cb37-35"><a href="#cb37-35"></a><span class="co"># Plot the above result</span></span>
<span id="cb37-36"><a href="#cb37-36"></a>fig_richness_trait <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(richness_trait, <span class="fu">aes</span>(<span class="at">x=</span>Restoration.type, <span class="at">y=</span>richness, <span class="at">fill=</span>habitat)) <span class="sc">+</span></span>
<span id="cb37-37"><a href="#cb37-37"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb37-38"><a href="#cb37-38"></a>  <span class="fu">scale_fill_scico_d</span>(<span class="at">palette =</span> <span class="st">&quot;roma&quot;</span>,</span>
<span id="cb37-39"><a href="#cb37-39"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Open country&quot;</span>,<span class="st">&quot;Rainforest&quot;</span>)) <span class="sc">+</span></span>
<span id="cb37-40"><a href="#cb37-40"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb37-41"><a href="#cb37-41"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb37-42"><a href="#cb37-42"></a>       <span class="at">y=</span><span class="st">&quot;Species Richness</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-43"><a href="#cb37-43"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb37-44"><a href="#cb37-44"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb37-45"><a href="#cb37-45"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb37-46"><a href="#cb37-46"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb37-47"><a href="#cb37-47"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb37-48"><a href="#cb37-48"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb37-49"><a href="#cb37-49"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb37-50"><a href="#cb37-50"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb37-51"><a href="#cb37-51"></a></span>
<span id="cb37-52"><a href="#cb37-52"></a><span class="fu">ggsave</span>(fig_richness_trait, <span class="at">filename =</span> <span class="st">&quot;figs/fig_richness_trait.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>, <span class="at">device =</span><span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig_richness_trait.png" alt="" />
<p class="caption">No significant differences were observed for rainforest species across treatment types, but we noticed a significant difference between BM-NR and BM-AR for open-country birds.</p>
</div>

</div>
</div>
<div id="acoustic-detections" class="section level2 hasAnchor" number="0.11">
<h2><span class="header-section-number">0.11</span> Acoustic Detections<a href="#acoustic-detections" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this script, we will calculate:</p>
<ol style="list-style-type: lower-alpha">
<li>Total Number of detections across sites (reported for varying time intervals 10s, 30s, 1-min, 2-min, 4-min).</li>
<li>Repeat the above calculations, but using species traits - If a species is a rainforest specialist or an open-country generalist.</li>
</ol>
<div id="install-required-libraries-4" class="section level3 hasAnchor" number="0.11.1">
<h3><span class="header-section-number">0.11.1</span> Install required libraries<a href="#install-required-libraries-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="fu">library</span>(vegan)</span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="fu">library</span>(scico)</span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="fu">library</span>(extrafont)</span></code></pre></div>
</div>
<div id="load-data" class="section level3 hasAnchor" number="0.11.2">
<h3><span class="header-section-number">0.11.2</span> Load data<a href="#load-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will use the data that was subset previously for further analysis.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># Attach the annotated data </span></span>
<span id="cb39-2"><a href="#cb39-2"></a>datSubset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/datSubset.csv&quot;</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="co"># Load the species-trait-data</span></span>
<span id="cb39-5"><a href="#cb39-5"></a>trait_dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/species-trait-dat.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="overall-number-of-detections" class="section level3 hasAnchor" number="0.11.3">
<h3><span class="header-section-number">0.11.3</span> Overall number of detections<a href="#overall-number-of-detections" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Given the data annotated so far, we will calculate the overall number of detections across different temporal periods, starting from 10s to 30-s, 1-min, 2-min and 4-min. We will first calculate the overall number of detections for the shortest possible temporal duration which could be annotated confidently - 10s.</p>
<p>Other durations are chosen to confirm if the number of detections vary as a function of the temporal duration.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># Calculate the overall number of detections for each site where each temporal duration chosen is a 10s clip</span></span>
<span id="cb40-2"><a href="#cb40-2"></a></span>
<span id="cb40-3"><a href="#cb40-3"></a>nDetections_10s <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>  <span class="fu">group_by</span>(Site, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb40-6"><a href="#cb40-6"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum) </span>
<span id="cb40-7"><a href="#cb40-7"></a>  </span>
<span id="cb40-8"><a href="#cb40-8"></a><span class="co"># Calculate the overall number of detections for each site where each temporal duration chosen is a 30s clip (In this case, every third row is chosen after grouping by Site, Date and Time)</span></span>
<span id="cb40-9"><a href="#cb40-9"></a></span>
<span id="cb40-10"><a href="#cb40-10"></a>nDetections_30s <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11"></a>  <span class="fu">mutate</span>(<span class="at">Splits =</span> <span class="fu">case_when</span>((Splits <span class="sc">==</span> <span class="st">&quot;01-10&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;10-20&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;20-30&quot;</span>) <span class="sc">~</span> <span class="st">&quot;1&quot;</span>,(Splits <span class="sc">==</span> <span class="st">&quot;30-40&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;40-50&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;50-60&quot;</span>) <span class="sc">~</span> <span class="st">&quot;2&quot;</span>,(Splits <span class="sc">==</span> <span class="st">&quot;60-70&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;70-80&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;80-90&quot;</span>) <span class="sc">~</span> <span class="st">&quot;3&quot;</span>, (Splits <span class="sc">==</span> <span class="st">&quot;90-100&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;100-110&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;110-120&quot;</span>) <span class="sc">~</span> <span class="st">&quot;4&quot;</span>,(Splits <span class="sc">==</span> <span class="st">&quot;120-130&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;130-140&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;140-150&quot;</span>) <span class="sc">~</span> <span class="st">&quot;5&quot;</span>,(Splits <span class="sc">==</span> <span class="st">&quot;150-160&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;160-170&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;170-180&quot;</span>) <span class="sc">~</span> <span class="st">&quot;6&quot;</span>,(Splits <span class="sc">==</span> <span class="st">&quot;180-190&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;190-200&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;200-210&quot;</span>) <span class="sc">~</span> <span class="st">&quot;7&quot;</span>, (Splits <span class="sc">==</span> <span class="st">&quot;210-220&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;220-230&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;230-240&quot;</span>) <span class="sc">~</span><span class="st">&quot;8&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Site, Date, Time, Splits, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb40-12"><a href="#cb40-12"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum)</span>
<span id="cb40-13"><a href="#cb40-13"></a></span>
<span id="cb40-14"><a href="#cb40-14"></a><span class="co"># Convert nDetections &gt;1 within a 30s period to 1 (since your temporal unit here is 30s)</span></span>
<span id="cb40-15"><a href="#cb40-15"></a></span>
<span id="cb40-16"><a href="#cb40-16"></a>nDetections_30s <span class="ot">&lt;-</span> nDetections_30s <span class="sc">%&gt;%</span></span>
<span id="cb40-17"><a href="#cb40-17"></a>  <span class="fu">group_by</span>(Site, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb40-18"><a href="#cb40-18"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-19"><a href="#cb40-19"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="sc">~</span> <span class="fu">replace</span>(., . <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-20"><a href="#cb40-20"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum)</span>
<span id="cb40-21"><a href="#cb40-21"></a>  </span>
<span id="cb40-22"><a href="#cb40-22"></a><span class="co"># Calculate the overall number of detections for each site where each temporal duration chosen is a 60s clip (In this case, every sixth row is chosen after grouping by Site, Date and Time)</span></span>
<span id="cb40-23"><a href="#cb40-23"></a></span>
<span id="cb40-24"><a href="#cb40-24"></a>nDetections_1min <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb40-25"><a href="#cb40-25"></a>  <span class="fu">mutate</span>(<span class="at">Splits =</span> <span class="fu">case_when</span>((Splits <span class="sc">==</span> <span class="st">&quot;01-10&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;10-20&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;20-30&quot;</span> <span class="sc">|</span></span>
<span id="cb40-26"><a href="#cb40-26"></a>                            Splits <span class="sc">==</span> <span class="st">&quot;30-40&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;40-50&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;50-60&quot;</span>) <span class="sc">~</span> <span class="st">&quot;1&quot;</span>, (Splits <span class="sc">==</span> <span class="st">&quot;60-70&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;70-80&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;80-90&quot;</span> <span class="sc">|</span></span>
<span id="cb40-27"><a href="#cb40-27"></a>                         Splits <span class="sc">==</span> <span class="st">&quot;90-100&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;100-110&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;110-120&quot;</span>) <span class="sc">~</span> <span class="st">&quot;2&quot;</span>,</span>
<span id="cb40-28"><a href="#cb40-28"></a>                         (Splits <span class="sc">==</span> <span class="st">&quot;120-130&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;130-140&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;140-150&quot;</span> <span class="sc">|</span></span>
<span id="cb40-29"><a href="#cb40-29"></a>                         Splits <span class="sc">==</span> <span class="st">&quot;150-160&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;160-170&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;170-180&quot;</span>) <span class="sc">~</span> <span class="st">&quot;3&quot;</span>,</span>
<span id="cb40-30"><a href="#cb40-30"></a>                         (Splits <span class="sc">==</span> <span class="st">&quot;180-190&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;190-200&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;200-210&quot;</span> <span class="sc">|</span></span>
<span id="cb40-31"><a href="#cb40-31"></a>                         Splits <span class="sc">==</span> <span class="st">&quot;210-220&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;220-230&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;230-240&quot;</span>) <span class="sc">~</span><span class="st">&quot;4&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Site, Date, Time, Splits, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb40-32"><a href="#cb40-32"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum)</span>
<span id="cb40-33"><a href="#cb40-33"></a>  </span>
<span id="cb40-34"><a href="#cb40-34"></a><span class="co"># Convert nDetections&gt;1 within a 1-min period to 1 (since your temporal unit here is 1-min)</span></span>
<span id="cb40-35"><a href="#cb40-35"></a></span>
<span id="cb40-36"><a href="#cb40-36"></a>nDetections_1min <span class="ot">&lt;-</span> nDetections_1min <span class="sc">%&gt;%</span></span>
<span id="cb40-37"><a href="#cb40-37"></a>  <span class="fu">group_by</span>(Site, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb40-38"><a href="#cb40-38"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-39"><a href="#cb40-39"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="sc">~</span> <span class="fu">replace</span>(., . <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-40"><a href="#cb40-40"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum) </span>
<span id="cb40-41"><a href="#cb40-41"></a>  </span>
<span id="cb40-42"><a href="#cb40-42"></a><span class="co"># Calculate the overall number of detections for each site where each temporal duration chosen is a 120s clip (In this case, every twelfth row is chosen after grouping by Site, Date and Time)</span></span>
<span id="cb40-43"><a href="#cb40-43"></a></span>
<span id="cb40-44"><a href="#cb40-44"></a>nDetections_2min <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb40-45"><a href="#cb40-45"></a>  <span class="fu">mutate</span>(<span class="at">Splits =</span> <span class="fu">case_when</span>((Splits <span class="sc">==</span> <span class="st">&quot;01-10&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;10-20&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;20-30&quot;</span> <span class="sc">|</span></span>
<span id="cb40-46"><a href="#cb40-46"></a>                            Splits <span class="sc">==</span> <span class="st">&quot;30-40&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;40-50&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;50-60&quot;</span> <span class="sc">|</span></span>
<span id="cb40-47"><a href="#cb40-47"></a>                         Splits <span class="sc">==</span> <span class="st">&quot;60-70&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;70-80&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;80-90&quot;</span> <span class="sc">|</span></span>
<span id="cb40-48"><a href="#cb40-48"></a>                         Splits <span class="sc">==</span> <span class="st">&quot;90-100&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;100-110&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;110-120&quot;</span>) <span class="sc">~</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb40-49"><a href="#cb40-49"></a>                         (Splits <span class="sc">==</span> <span class="st">&quot;120-130&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;130-140&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;140-150&quot;</span> <span class="sc">|</span></span>
<span id="cb40-50"><a href="#cb40-50"></a>                         Splits <span class="sc">==</span> <span class="st">&quot;150-160&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;160-170&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;170-180&quot;</span> <span class="sc">|</span></span>
<span id="cb40-51"><a href="#cb40-51"></a>                         Splits <span class="sc">==</span> <span class="st">&quot;180-190&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;190-200&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;200-210&quot;</span> <span class="sc">|</span></span>
<span id="cb40-52"><a href="#cb40-52"></a>                         Splits <span class="sc">==</span> <span class="st">&quot;210-220&quot;</span> <span class="sc">|</span> Splits<span class="sc">==</span><span class="st">&quot;220-230&quot;</span> <span class="sc">|</span> Splits <span class="sc">==</span><span class="st">&quot;230-240&quot;</span>) <span class="sc">~</span><span class="st">&quot;2&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Site, Date, Time, Splits, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb40-53"><a href="#cb40-53"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum)</span>
<span id="cb40-54"><a href="#cb40-54"></a> </span>
<span id="cb40-55"><a href="#cb40-55"></a><span class="co"># Convert nDetections&gt;1 within a 2-min period to 1 (since your temporal unit here is 2-min)</span></span>
<span id="cb40-56"><a href="#cb40-56"></a></span>
<span id="cb40-57"><a href="#cb40-57"></a>nDetections_2min <span class="ot">&lt;-</span> nDetections_2min <span class="sc">%&gt;%</span></span>
<span id="cb40-58"><a href="#cb40-58"></a>  <span class="fu">group_by</span>(Site, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb40-59"><a href="#cb40-59"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-60"><a href="#cb40-60"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="sc">~</span> <span class="fu">replace</span>(., . <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-61"><a href="#cb40-61"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum) </span>
<span id="cb40-62"><a href="#cb40-62"></a>  </span>
<span id="cb40-63"><a href="#cb40-63"></a><span class="co"># Calculate the overall number of detections for each site where each temporal duration chosen is a 240s clip (In this case, every twentyfourth row is chosen after grouping by Site, Date and Time)</span></span>
<span id="cb40-64"><a href="#cb40-64"></a></span>
<span id="cb40-65"><a href="#cb40-65"></a>nDetections_4min <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb40-66"><a href="#cb40-66"></a>  <span class="fu">group_by</span>(Site, Date, Time, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb40-67"><a href="#cb40-67"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum) </span>
<span id="cb40-68"><a href="#cb40-68"></a></span>
<span id="cb40-69"><a href="#cb40-69"></a><span class="co"># Convert nDetections&gt;1 within a 4-min period to 1 (since your temporal unit here is 4-min)</span></span>
<span id="cb40-70"><a href="#cb40-70"></a></span>
<span id="cb40-71"><a href="#cb40-71"></a>nDetections_4min <span class="ot">&lt;-</span> nDetections_4min <span class="sc">%&gt;%</span></span>
<span id="cb40-72"><a href="#cb40-72"></a>  <span class="fu">group_by</span>(Site, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb40-73"><a href="#cb40-73"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-74"><a href="#cb40-74"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="sc">~</span> <span class="fu">replace</span>(., . <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-75"><a href="#cb40-75"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum)</span></code></pre></div>
</div>
<div id="detections-by-treatment-type" class="section level3 hasAnchor" number="0.11.4">
<h3><span class="header-section-number">0.11.4</span> Detections by treatment type<a href="#detections-by-treatment-type" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How does the number of detections vary as a function of restoration type? (tested across different temporal durations)?</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># Testing if there is significant differences in overall number of detections across treatment types (this has been done only for the smallest temporal duration ~10s, while total number of detections have been estimated for different temporal durations)</span></span>
<span id="cb41-2"><a href="#cb41-2"></a></span>
<span id="cb41-3"><a href="#cb41-3"></a>sum_Detections10s <span class="ot">&lt;-</span> nDetections_10s <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-5"><a href="#cb41-5"></a>  <span class="fu">mutate</span>(<span class="at">sumDetections =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(IP<span class="sc">:</span>HSWP))) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, sumDetections)</span>
<span id="cb41-7"><a href="#cb41-7"></a></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="co"># Test if there are significant differences in detections across treatment types</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>anovaAllDetect <span class="ot">&lt;-</span> <span class="fu">aov</span>(sumDetections<span class="sc">~</span>Restoration.type, <span class="at">data =</span> sum_Detections10s)</span>
<span id="cb41-10"><a href="#cb41-10"></a></span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="co"># Tukey test to study each pair of treatment - reveals no signficant difference across treatment types</span></span>
<span id="cb41-12"><a href="#cb41-12"></a>tukeyAllDetect <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anovaAllDetect)</span>
<span id="cb41-13"><a href="#cb41-13"></a></span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="co"># Estimating total number of detections for different temporal durations</span></span>
<span id="cb41-15"><a href="#cb41-15"></a></span>
<span id="cb41-16"><a href="#cb41-16"></a>sum_Detections30s <span class="ot">&lt;-</span> nDetections_30s <span class="sc">%&gt;%</span></span>
<span id="cb41-17"><a href="#cb41-17"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-18"><a href="#cb41-18"></a>  <span class="fu">mutate</span>(<span class="at">sumDetections =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(IP<span class="sc">:</span>HSWP))) <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="#cb41-19"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, sumDetections)</span>
<span id="cb41-20"><a href="#cb41-20"></a></span>
<span id="cb41-21"><a href="#cb41-21"></a>sum_Detections1min <span class="ot">&lt;-</span> nDetections_1min <span class="sc">%&gt;%</span></span>
<span id="cb41-22"><a href="#cb41-22"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-23"><a href="#cb41-23"></a>  <span class="fu">mutate</span>(<span class="at">sumDetections =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(IP<span class="sc">:</span>HSWP))) <span class="sc">%&gt;%</span></span>
<span id="cb41-24"><a href="#cb41-24"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, sumDetections)</span>
<span id="cb41-25"><a href="#cb41-25"></a></span>
<span id="cb41-26"><a href="#cb41-26"></a>sum_Detections2min <span class="ot">&lt;-</span> nDetections_2min <span class="sc">%&gt;%</span></span>
<span id="cb41-27"><a href="#cb41-27"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-28"><a href="#cb41-28"></a>  <span class="fu">mutate</span>(<span class="at">sumDetections =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(IP<span class="sc">:</span>HSWP))) <span class="sc">%&gt;%</span></span>
<span id="cb41-29"><a href="#cb41-29"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, sumDetections)</span>
<span id="cb41-30"><a href="#cb41-30"></a></span>
<span id="cb41-31"><a href="#cb41-31"></a>sum_Detections4min <span class="ot">&lt;-</span> nDetections_4min <span class="sc">%&gt;%</span></span>
<span id="cb41-32"><a href="#cb41-32"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-33"><a href="#cb41-33"></a>  <span class="fu">mutate</span>(<span class="at">sumDetections =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(IP<span class="sc">:</span>HSWP))) <span class="sc">%&gt;%</span></span>
<span id="cb41-34"><a href="#cb41-34"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, sumDetections)</span>
<span id="cb41-35"><a href="#cb41-35"></a></span>
<span id="cb41-36"><a href="#cb41-36"></a><span class="co"># Plotting the above (multiple plots for each temporal duration)</span></span>
<span id="cb41-37"><a href="#cb41-37"></a><span class="co"># Note: the cumulative number of detections across all species was obtained by summing every 16-min to 48-min set of detections across each site, including all species.</span></span>
<span id="cb41-38"><a href="#cb41-38"></a></span>
<span id="cb41-39"><a href="#cb41-39"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb41-40"><a href="#cb41-40"></a>sum_Detections10s<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(sum_Detections10s<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb41-41"><a href="#cb41-41"></a><span class="co"># Add a custom set of colors</span></span>
<span id="cb41-42"><a href="#cb41-42"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>), <span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Paired&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb41-43"><a href="#cb41-43"></a></span>
<span id="cb41-44"><a href="#cb41-44"></a>fig_sumDetections10s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sum_Detections10s, <span class="fu">aes</span>(<span class="at">x=</span>Restoration.type, <span class="at">y=</span>sumDetections, <span class="at">fill=</span>Restoration.type)) <span class="sc">+</span>  </span>
<span id="cb41-45"><a href="#cb41-45"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb41-46"><a href="#cb41-46"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb41-47"><a href="#cb41-47"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb41-48"><a href="#cb41-48"></a>     <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb41-49"><a href="#cb41-49"></a>       <span class="at">y=</span><span class="st">&quot;Cumulative number of detections</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-50"><a href="#cb41-50"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb41-51"><a href="#cb41-51"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb41-52"><a href="#cb41-52"></a>      <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb41-53"><a href="#cb41-53"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb41-54"><a href="#cb41-54"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb41-55"><a href="#cb41-55"></a></span>
<span id="cb41-56"><a href="#cb41-56"></a><span class="fu">ggsave</span>(fig_sumDetections10s, <span class="at">filename =</span> <span class="st">&quot;figs/fig_sumDetections10s.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>, <span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig_sumDetections10s.png" alt="" />
<p class="caption">No significant difference in overall number of detections across treatment types.</p>
</div>
</div>
<div id="detections-by-species-traits" class="section level3 hasAnchor" number="0.11.5">
<h3><span class="header-section-number">0.11.5</span> Detections by species traits<a href="#detections-by-species-traits" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How does the cumulative number of detections vary by treatment type, as a function of whether a species is a rainforest specialist or an open country generalist? (These calculations are repeated for different temporal durations to assess differences, if any)</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># First we merge the species trait dataset with the nDetections dataframe (across different temporal durations)</span></span>
<span id="cb42-2"><a href="#cb42-2"></a></span>
<span id="cb42-3"><a href="#cb42-3"></a>detections_trait10s <span class="ot">&lt;-</span> nDetections_10s <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>IP<span class="sc">:</span>HSWP, <span class="at">names_to=</span><span class="st">&quot;Species_Code&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>  <span class="fu">left_join</span>(.,trait_dat, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Species_Code&quot;</span><span class="ot">=</span><span class="st">&quot;species_annotation_codes&quot;</span>)) </span>
<span id="cb42-6"><a href="#cb42-6"></a></span>
<span id="cb42-7"><a href="#cb42-7"></a>detections_trait30s <span class="ot">&lt;-</span> nDetections_30s <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>IP<span class="sc">:</span>HSWP, <span class="at">names_to=</span><span class="st">&quot;Species_Code&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>  <span class="fu">left_join</span>(.,trait_dat, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Species_Code&quot;</span><span class="ot">=</span><span class="st">&quot;species_annotation_codes&quot;</span>))</span>
<span id="cb42-10"><a href="#cb42-10"></a></span>
<span id="cb42-11"><a href="#cb42-11"></a>detections_trait1min <span class="ot">&lt;-</span> nDetections_1min <span class="sc">%&gt;%</span></span>
<span id="cb42-12"><a href="#cb42-12"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>IP<span class="sc">:</span>HSWP, <span class="at">names_to=</span><span class="st">&quot;Species_Code&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-13"><a href="#cb42-13"></a>  <span class="fu">left_join</span>(.,trait_dat, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Species_Code&quot;</span><span class="ot">=</span><span class="st">&quot;species_annotation_codes&quot;</span>)) </span>
<span id="cb42-14"><a href="#cb42-14"></a></span>
<span id="cb42-15"><a href="#cb42-15"></a>detections_trait2min <span class="ot">&lt;-</span> nDetections_2min <span class="sc">%&gt;%</span></span>
<span id="cb42-16"><a href="#cb42-16"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>IP<span class="sc">:</span>HSWP, <span class="at">names_to=</span><span class="st">&quot;Species_Code&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-17"><a href="#cb42-17"></a>  <span class="fu">left_join</span>(.,trait_dat, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Species_Code&quot;</span><span class="ot">=</span><span class="st">&quot;species_annotation_codes&quot;</span>)) </span>
<span id="cb42-18"><a href="#cb42-18"></a></span>
<span id="cb42-19"><a href="#cb42-19"></a>detections_trait4min <span class="ot">&lt;-</span> nDetections_4min <span class="sc">%&gt;%</span></span>
<span id="cb42-20"><a href="#cb42-20"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>IP<span class="sc">:</span>HSWP, <span class="at">names_to=</span><span class="st">&quot;Species_Code&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-21"><a href="#cb42-21"></a>  <span class="fu">left_join</span>(.,trait_dat, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Species_Code&quot;</span><span class="ot">=</span><span class="st">&quot;species_annotation_codes&quot;</span>)) </span>
<span id="cb42-22"><a href="#cb42-22"></a></span>
<span id="cb42-23"><a href="#cb42-23"></a><span class="co"># Calculate overall number of detections for each site as a function of rainforest species and open-country species and test for differences across treatment types (Calculated only for the smallest temporal duration - 10s)</span></span>
<span id="cb42-24"><a href="#cb42-24"></a></span>
<span id="cb42-25"><a href="#cb42-25"></a>detections_trait10s <span class="ot">&lt;-</span>  detections_trait10s <span class="sc">%&gt;%</span></span>
<span id="cb42-26"><a href="#cb42-26"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, Species_Code, habitat, count) <span class="sc">%&gt;%</span></span>
<span id="cb42-27"><a href="#cb42-27"></a>  <span class="fu">group_by</span>(Site, Restoration.type, habitat) <span class="sc">%&gt;%</span></span>
<span id="cb42-28"><a href="#cb42-28"></a>  <span class="fu">summarise</span>(<span class="at">sumDetections =</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb42-29"><a href="#cb42-29"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb42-30"><a href="#cb42-30"></a></span>
<span id="cb42-31"><a href="#cb42-31"></a><span class="co"># Split the above data into rainforest species and open country</span></span>
<span id="cb42-32"><a href="#cb42-32"></a>detections_10s_rainforest <span class="ot">&lt;-</span> detections_trait10s <span class="sc">%&gt;%</span></span>
<span id="cb42-33"><a href="#cb42-33"></a>  <span class="fu">filter</span>(habitat<span class="sc">==</span><span class="st">&quot;RF&quot;</span>)</span>
<span id="cb42-34"><a href="#cb42-34"></a>detections_10s_openCountry <span class="ot">&lt;-</span> detections_trait10s <span class="sc">%&gt;%</span> </span>
<span id="cb42-35"><a href="#cb42-35"></a>  <span class="fu">filter</span>(habitat<span class="sc">==</span><span class="st">&quot;OC&quot;</span>)</span>
<span id="cb42-36"><a href="#cb42-36"></a></span>
<span id="cb42-37"><a href="#cb42-37"></a><span class="co"># Test if there are significant differences in detections across treatment types as a function of species trait</span></span>
<span id="cb42-38"><a href="#cb42-38"></a>anova_rainforestDet <span class="ot">&lt;-</span> <span class="fu">aov</span>(sumDetections<span class="sc">~</span>Restoration.type, <span class="at">data =</span> detections_10s_rainforest)</span>
<span id="cb42-39"><a href="#cb42-39"></a>anova_opencountryDet <span class="ot">&lt;-</span> <span class="fu">aov</span>(sumDetections<span class="sc">~</span>Restoration.type, <span class="at">data =</span> detections_10s_openCountry)</span>
<span id="cb42-40"><a href="#cb42-40"></a></span>
<span id="cb42-41"><a href="#cb42-41"></a><span class="co"># Tukey test to study each pair of treatment - reveals no signficant difference across treatment types</span></span>
<span id="cb42-42"><a href="#cb42-42"></a>tukey_rainforestDet <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_rainforestDet)</span>
<span id="cb42-43"><a href="#cb42-43"></a>tukey_opencountryDet <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_opencountryDet)</span>
<span id="cb42-44"><a href="#cb42-44"></a></span>
<span id="cb42-45"><a href="#cb42-45"></a><span class="co"># The above results for rainforest birds reveal a significant difference in rainforest bird detections between benchmark sites and active sites and benchmark sites and passive sites. </span></span>
<span id="cb42-46"><a href="#cb42-46"></a><span class="co"># For open-country birds, there is a significant difference between every pair of treatment type.</span></span>
<span id="cb42-47"><a href="#cb42-47"></a></span>
<span id="cb42-48"><a href="#cb42-48"></a><span class="co"># Calculating overall number of detections for other temporal durations as a function of species trait</span></span>
<span id="cb42-49"><a href="#cb42-49"></a>detections_trait30s <span class="ot">&lt;-</span>  detections_trait30s <span class="sc">%&gt;%</span></span>
<span id="cb42-50"><a href="#cb42-50"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, Species_Code, habitat, count) <span class="sc">%&gt;%</span></span>
<span id="cb42-51"><a href="#cb42-51"></a>  <span class="fu">group_by</span>(Site, Restoration.type, habitat) <span class="sc">%&gt;%</span></span>
<span id="cb42-52"><a href="#cb42-52"></a>  <span class="fu">summarise</span>(<span class="at">sumDetections =</span> <span class="fu">sum</span>(count))</span>
<span id="cb42-53"><a href="#cb42-53"></a></span>
<span id="cb42-54"><a href="#cb42-54"></a>detections_trait1min <span class="ot">&lt;-</span>  detections_trait1min <span class="sc">%&gt;%</span></span>
<span id="cb42-55"><a href="#cb42-55"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, Species_Code, habitat, count) <span class="sc">%&gt;%</span></span>
<span id="cb42-56"><a href="#cb42-56"></a>  <span class="fu">group_by</span>(Site, Restoration.type, habitat) <span class="sc">%&gt;%</span></span>
<span id="cb42-57"><a href="#cb42-57"></a>  <span class="fu">summarise</span>(<span class="at">sumDetections =</span> <span class="fu">sum</span>(count))</span>
<span id="cb42-58"><a href="#cb42-58"></a></span>
<span id="cb42-59"><a href="#cb42-59"></a>detections_trait2min <span class="ot">&lt;-</span>  detections_trait2min <span class="sc">%&gt;%</span></span>
<span id="cb42-60"><a href="#cb42-60"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, Species_Code, habitat, count) <span class="sc">%&gt;%</span></span>
<span id="cb42-61"><a href="#cb42-61"></a>  <span class="fu">group_by</span>(Site, Restoration.type, habitat) <span class="sc">%&gt;%</span></span>
<span id="cb42-62"><a href="#cb42-62"></a>  <span class="fu">summarise</span>(<span class="at">sumDetections =</span> <span class="fu">sum</span>(count))</span>
<span id="cb42-63"><a href="#cb42-63"></a></span>
<span id="cb42-64"><a href="#cb42-64"></a>detections_trait4min <span class="ot">&lt;-</span>  detections_trait4min <span class="sc">%&gt;%</span></span>
<span id="cb42-65"><a href="#cb42-65"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, Species_Code, habitat, count) <span class="sc">%&gt;%</span></span>
<span id="cb42-66"><a href="#cb42-66"></a>  <span class="fu">group_by</span>(Site, Restoration.type, habitat) <span class="sc">%&gt;%</span></span>
<span id="cb42-67"><a href="#cb42-67"></a>  <span class="fu">summarise</span>(<span class="at">sumDetections =</span> <span class="fu">sum</span>(count))</span>
<span id="cb42-68"><a href="#cb42-68"></a></span>
<span id="cb42-69"><a href="#cb42-69"></a><span class="co"># Plot the figures</span></span>
<span id="cb42-70"><a href="#cb42-70"></a></span>
<span id="cb42-71"><a href="#cb42-71"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb42-72"><a href="#cb42-72"></a>detections_trait10s<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(detections_trait10s<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb42-73"><a href="#cb42-73"></a></span>
<span id="cb42-74"><a href="#cb42-74"></a>fig_detections_trait10s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(detections_trait10s, <span class="fu">aes</span>(<span class="at">x=</span>Restoration.type, <span class="at">y=</span>sumDetections, <span class="at">fill=</span>habitat)) <span class="sc">+</span></span>
<span id="cb42-75"><a href="#cb42-75"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb42-76"><a href="#cb42-76"></a>    <span class="fu">scale_fill_scico_d</span>(<span class="at">palette =</span> <span class="st">&quot;roma&quot;</span>,</span>
<span id="cb42-77"><a href="#cb42-77"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Open country&quot;</span>,<span class="st">&quot;Rainforest&quot;</span>)) <span class="sc">+</span></span>
<span id="cb42-78"><a href="#cb42-78"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb42-79"><a href="#cb42-79"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb42-80"><a href="#cb42-80"></a>       <span class="at">y=</span><span class="st">&quot;Cumulative number of detections</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb42-81"><a href="#cb42-81"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb42-82"><a href="#cb42-82"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb42-83"><a href="#cb42-83"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb42-84"><a href="#cb42-84"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb42-85"><a href="#cb42-85"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb42-86"><a href="#cb42-86"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb42-87"><a href="#cb42-87"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb42-88"><a href="#cb42-88"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb42-89"><a href="#cb42-89"></a></span>
<span id="cb42-90"><a href="#cb42-90"></a><span class="co"># Save the above plot</span></span>
<span id="cb42-91"><a href="#cb42-91"></a><span class="fu">ggsave</span>(fig_detections_trait10s, <span class="at">filename =</span> <span class="st">&quot;figs/fig_detections_trait10s.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>,<span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig_detections_trait10s.png" alt="" />
<p class="caption">Overall number of rainforest bird species detections differed between BM and AR and BM and NR sites. For open-country bird species detections, we observed significant differences across every pair of treatment types.</p>
</div>

</div>
</div>
<div id="species-proportions" class="section level2 hasAnchor" number="0.12">
<h2><span class="header-section-number">0.12</span> Species proportions<a href="#species-proportions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this script, we will calculate the proportion of rainforest and open-country bird species that was detected across the three treatment types for a given period of time. Species richness may only give us a broader understanding of the overall levels of diversity, but getting at a measure of abundance (where we calculate the proportion of rainforest and open-country birds that were vocal in a given habitat type for a given period of time) may provide insights on the use of a particular habitat - an important question that needs to be answered, given that we would like to understand if fauna are using actively restored habitats.</p>
<div id="install-required-libraries-5" class="section level3 hasAnchor" number="0.12.1">
<h3><span class="header-section-number">0.12.1</span> Install required libraries<a href="#install-required-libraries-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="fu">library</span>(vegan)</span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb43-6"><a href="#cb43-6"></a><span class="fu">library</span>(scico)</span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="fu">library</span>(data.table)</span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb43-9"><a href="#cb43-9"></a></span>
<span id="cb43-10"><a href="#cb43-10"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb43-11"><a href="#cb43-11"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
<div id="load-the-necessary-data-to-calculate-proportions" class="section level3 hasAnchor" number="0.12.2">
<h3><span class="header-section-number">0.12.2</span> Load the necessary data to calculate proportions<a href="#load-the-necessary-data-to-calculate-proportions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># We load the subset data</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>datSubset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/datSubset.csv&quot;</span>)</span>
<span id="cb44-3"><a href="#cb44-3"></a></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="co"># Load species-trait data to essentially check for associations by habitat type</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>trait_dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/species-trait-dat.csv&quot;</span>)</span>
<span id="cb44-6"><a href="#cb44-6"></a></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="co"># Site-summary (Number of detections across all sites)</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>datSummary <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>  <span class="fu">group_by</span>(Site, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="#cb44-11"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum)</span></code></pre></div>
</div>
<div id="proportion-of-acoustic-detections-across-all-10-s-chunks-for-every-site-date-combination" class="section level3 hasAnchor" number="0.12.3">
<h3><span class="header-section-number">0.12.3</span> Proportion of acoustic detections across all 10-s chunks for every site-date combination<a href="#proportion-of-acoustic-detections-across-all-10-s-chunks-for-every-site-date-combination" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># Calculate the overall number of detections for each site across 6 days of data (translates to ~96-min of data per site; each detection corresponding to a temporal unit of 10 seconds). Here, we include dates, since each visit can explain the detections/proportion of detections for future modeling.   </span></span>
<span id="cb45-2"><a href="#cb45-2"></a></span>
<span id="cb45-3"><a href="#cb45-3"></a>nDetections_site_date <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4"></a>  <span class="fu">group_by</span>(Site, Restoration.type, Date) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum)</span>
<span id="cb45-7"><a href="#cb45-7"></a></span>
<span id="cb45-8"><a href="#cb45-8"></a><span class="co"># Combine the nDetections and trait based data</span></span>
<span id="cb45-9"><a href="#cb45-9"></a></span>
<span id="cb45-10"><a href="#cb45-10"></a>nDetections_trait <span class="ot">&lt;-</span> nDetections_site_date <span class="sc">%&gt;%</span></span>
<span id="cb45-11"><a href="#cb45-11"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>IP<span class="sc">:</span>HSWP, <span class="at">names_to=</span><span class="st">&quot;Species_Code&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-12"><a href="#cb45-12"></a>  <span class="fu">left_join</span>(.,trait_dat, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Species_Code&quot;</span><span class="ot">=</span><span class="st">&quot;species_annotation_codes&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-13"><a href="#cb45-13"></a>  <span class="fu">mutate</span>(<span class="at">forProp =</span> <span class="fu">case_when</span>(count<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>,count<span class="sc">==</span><span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-14"><a href="#cb45-14"></a>  <span class="fu">rename</span>(., <span class="at">nDetections =</span> count)</span>
<span id="cb45-15"><a href="#cb45-15"></a></span>
<span id="cb45-16"><a href="#cb45-16"></a><span class="co"># Extract proportion of acoustic detections</span></span>
<span id="cb45-17"><a href="#cb45-17"></a>totRainDetections <span class="ot">&lt;-</span> nDetections_trait <span class="sc">%&gt;%</span></span>
<span id="cb45-18"><a href="#cb45-18"></a>  <span class="fu">filter</span>(habitat<span class="sc">==</span><span class="st">&quot;RF&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-19"><a href="#cb45-19"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb45-20"><a href="#cb45-20"></a>  <span class="fu">summarise</span>(<span class="at">totRFDetections =</span> <span class="fu">sum</span>(nDetections))</span>
<span id="cb45-21"><a href="#cb45-21"></a></span>
<span id="cb45-22"><a href="#cb45-22"></a>totOpenDetections <span class="ot">&lt;-</span> nDetections_trait <span class="sc">%&gt;%</span></span>
<span id="cb45-23"><a href="#cb45-23"></a>  <span class="fu">filter</span>(habitat<span class="sc">==</span><span class="st">&quot;OC&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-24"><a href="#cb45-24"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb45-25"><a href="#cb45-25"></a>  <span class="fu">summarise</span>(<span class="at">totOCDetections =</span> <span class="fu">sum</span>(nDetections))</span>
<span id="cb45-26"><a href="#cb45-26"></a></span>
<span id="cb45-27"><a href="#cb45-27"></a><span class="co"># proportion of acoustic detections (note: sampling unit =  10-s)</span></span>
<span id="cb45-28"><a href="#cb45-28"></a>prop <span class="ot">&lt;-</span> <span class="fu">left_join</span>(totRainDetections, totOpenDetections, </span>
<span id="cb45-29"><a href="#cb45-29"></a>                   <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-30"><a href="#cb45-30"></a>  <span class="fu">mutate</span>(<span class="at">propRF =</span> (totRFDetections)<span class="sc">/</span>(totRFDetections <span class="sc">+</span> totOCDetections)) <span class="sc">%&gt;%</span></span>
<span id="cb45-31"><a href="#cb45-31"></a>  <span class="fu">mutate</span>(<span class="at">propOC =</span> (<span class="dv">1</span> <span class="sc">-</span> propRF))</span>
<span id="cb45-32"><a href="#cb45-32"></a></span>
<span id="cb45-33"><a href="#cb45-33"></a><span class="co"># write the above results</span></span>
<span id="cb45-34"><a href="#cb45-34"></a><span class="fu">write.csv</span>(prop, <span class="st">&quot;results/acoustic-detections.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="testing-for-differences-in-species-acoustic-detections-across-treatment-types" class="section level3 hasAnchor" number="0.12.4">
<h3><span class="header-section-number">0.12.4</span> Testing for differences in species acoustic detections across treatment types<a href="#testing-for-differences-in-species-acoustic-detections-across-treatment-types" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plotting proportion of rainforest and open -country species detections and testing for any significant differences between treatment types</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># Test if there are significant differences in the proportion of rainforest species across treatment types</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>anovaPropRF <span class="ot">&lt;-</span> <span class="fu">aov</span>(propRF<span class="sc">~</span>Restoration.type, <span class="at">data =</span> prop)</span>
<span id="cb46-3"><a href="#cb46-3"></a>tukeyPropRF <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anovaPropRF)</span>
<span id="cb46-4"><a href="#cb46-4"></a></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="co"># Test if there are significant differences in the proportion of open country species across treatment types</span></span>
<span id="cb46-6"><a href="#cb46-6"></a>anovaPropOC <span class="ot">&lt;-</span> <span class="fu">aov</span>(propOC<span class="sc">~</span>Restoration.type, <span class="at">data =</span> prop)</span>
<span id="cb46-7"><a href="#cb46-7"></a>tukeyPropOC <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anovaPropOC)</span>
<span id="cb46-8"><a href="#cb46-8"></a></span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="co"># The above result suggests that there is a significant difference in the proportion of detections of rainforest  and open-country species across treatment types</span></span>
<span id="cb46-10"><a href="#cb46-10"></a></span>
<span id="cb46-11"><a href="#cb46-11"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb46-12"><a href="#cb46-12"></a>prop<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(prop<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb46-13"><a href="#cb46-13"></a><span class="co"># Add a custom set of colors</span></span>
<span id="cb46-14"><a href="#cb46-14"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>), <span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Paired&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb46-15"><a href="#cb46-15"></a></span>
<span id="cb46-16"><a href="#cb46-16"></a>fig_propRF <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prop, <span class="fu">aes</span>(<span class="at">x=</span>Restoration.type, <span class="at">y=</span>propRF, <span class="at">fill=</span>Restoration.type)) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb46-17"><a href="#cb46-17"></a>    <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb46-18"><a href="#cb46-18"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb46-19"><a href="#cb46-19"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb46-20"><a href="#cb46-20"></a>       <span class="at">y=</span><span class="st">&quot;Proportion of rainforest species detections</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-21"><a href="#cb46-21"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb46-22"><a href="#cb46-22"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb46-23"><a href="#cb46-23"></a>      <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb46-24"><a href="#cb46-24"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb46-25"><a href="#cb46-25"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb46-26"><a href="#cb46-26"></a></span>
<span id="cb46-27"><a href="#cb46-27"></a><span class="fu">ggsave</span>(fig_propRF, <span class="at">filename =</span> <span class="st">&quot;figs/fig_acousticDetections_propRF.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>, <span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span>
<span id="cb46-28"><a href="#cb46-28"></a></span>
<span id="cb46-29"><a href="#cb46-29"></a>fig_propOC <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prop, <span class="fu">aes</span>(<span class="at">x=</span>Restoration.type, <span class="at">y=</span>propOC, <span class="at">fill=</span>Restoration.type)) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb46-30"><a href="#cb46-30"></a>    <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb46-31"><a href="#cb46-31"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb46-32"><a href="#cb46-32"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb46-33"><a href="#cb46-33"></a>       <span class="at">y=</span><span class="st">&quot;Proportion of open-country species detections</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-34"><a href="#cb46-34"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb46-35"><a href="#cb46-35"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb46-36"><a href="#cb46-36"></a>      <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb46-37"><a href="#cb46-37"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb46-38"><a href="#cb46-38"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb46-39"><a href="#cb46-39"></a></span>
<span id="cb46-40"><a href="#cb46-40"></a><span class="fu">ggsave</span>(fig_propOC, <span class="at">filename =</span> <span class="st">&quot;figs/fig_acousticDetections_propOC.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>, <span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figs/fig_acousticDetections_propRF.png" alt="We observed significant differences in the proportion of rainforest bird species detections across treatment types." />
<img src="figs/fig_acousticDetections_propOC.png" alt="We observed significant differences in the proportion of open-country bird species detections across treatment types." /></p>
</div>
<div id="proportion-of-detections-across-acoustic-point-counts" class="section level3 hasAnchor" number="0.12.5">
<h3><span class="header-section-number">0.12.5</span> Proportion of detections across acoustic point counts<a href="#proportion-of-detections-across-acoustic-point-counts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, we repeat the above analysis with a different sampling unit, where the total number of detections of a species was estimated for each point count rather than across 10-s chunks. In other words, if a species was detected thrice vocally, it was marked as a single detection in that point count.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># Rather than summing the total number of detections across all 10-s clips for every 16-min, here we calculate the proportion of times a species was detected in six visits. </span></span>
<span id="cb47-2"><a href="#cb47-2"></a></span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="co"># Extract proportion of rainforest species detections across six visits</span></span>
<span id="cb47-4"><a href="#cb47-4"></a>totRainVisits <span class="ot">&lt;-</span> nDetections_trait <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5"></a>  <span class="fu">filter</span>(habitat<span class="sc">==</span><span class="st">&quot;RF&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7"></a>  <span class="fu">summarise</span>(<span class="at">totRF =</span> <span class="fu">sum</span>(forProp))</span>
<span id="cb47-8"><a href="#cb47-8"></a></span>
<span id="cb47-9"><a href="#cb47-9"></a>totOpenVisits <span class="ot">&lt;-</span> nDetections_trait <span class="sc">%&gt;%</span></span>
<span id="cb47-10"><a href="#cb47-10"></a>  <span class="fu">filter</span>(habitat<span class="sc">==</span><span class="st">&quot;OC&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-11"><a href="#cb47-11"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb47-12"><a href="#cb47-12"></a>  <span class="fu">summarise</span>(<span class="at">totOC =</span> <span class="fu">sum</span>(forProp))</span>
<span id="cb47-13"><a href="#cb47-13"></a></span>
<span id="cb47-14"><a href="#cb47-14"></a><span class="co"># proportion of acoustic detections (note: sampling unit =  1 point count)</span></span>
<span id="cb47-15"><a href="#cb47-15"></a>propVisit <span class="ot">&lt;-</span> <span class="fu">left_join</span>(totRainVisits, totOpenVisits, </span>
<span id="cb47-16"><a href="#cb47-16"></a>                   <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-17"><a href="#cb47-17"></a>  <span class="fu">mutate</span>(<span class="at">propRF =</span> (totRF)<span class="sc">/</span>(totRF <span class="sc">+</span> totOC)) <span class="sc">%&gt;%</span></span>
<span id="cb47-18"><a href="#cb47-18"></a>  <span class="fu">mutate</span>(<span class="at">propOC =</span> (<span class="dv">1</span> <span class="sc">-</span> propRF))</span>
<span id="cb47-19"><a href="#cb47-19"></a></span>
<span id="cb47-20"><a href="#cb47-20"></a><span class="co"># write the above results to a file</span></span>
<span id="cb47-21"><a href="#cb47-21"></a><span class="fu">write.csv</span>(propVisit, <span class="st">&quot;results/acoustic-detections-across-visits.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="testing-for-differences-in-rainforest-and-open-country-species-detections-across-acoustic-point-counts" class="section level3 hasAnchor" number="0.12.6">
<h3><span class="header-section-number">0.12.6</span> Testing for differences in rainforest and open-country species detections across acoustic point counts<a href="#testing-for-differences-in-rainforest-and-open-country-species-detections-across-acoustic-point-counts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># Test if there are significant differences in the proportion of rainforest species across treatment types</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>anovaRF <span class="ot">&lt;-</span> <span class="fu">aov</span>(propRF<span class="sc">~</span>Restoration.type, <span class="at">data =</span> propVisit)</span>
<span id="cb48-3"><a href="#cb48-3"></a>tukeyRF <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anovaRF)</span>
<span id="cb48-4"><a href="#cb48-4"></a></span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="co"># Test if there are significant differences in the proportion of rainforest species across treatment types</span></span>
<span id="cb48-6"><a href="#cb48-6"></a>anovaOC <span class="ot">&lt;-</span> <span class="fu">aov</span>(propOC<span class="sc">~</span>Restoration.type, <span class="at">data =</span> propVisit)</span>
<span id="cb48-7"><a href="#cb48-7"></a>tukeyOC <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anovaOC)</span>
<span id="cb48-8"><a href="#cb48-8"></a></span>
<span id="cb48-9"><a href="#cb48-9"></a><span class="co"># The above result suggests that there is a significant difference in the proportion of detections of rainforest and open-country species across all treatment types at the level of an acoustic point count. </span></span>
<span id="cb48-10"><a href="#cb48-10"></a></span>
<span id="cb48-11"><a href="#cb48-11"></a><span class="co"># Create a boxplot of proportion estimates by group (Here: group refers to Restoration Type)</span></span>
<span id="cb48-12"><a href="#cb48-12"></a></span>
<span id="cb48-13"><a href="#cb48-13"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb48-14"><a href="#cb48-14"></a>propVisit<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(propVisit<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb48-15"><a href="#cb48-15"></a></span>
<span id="cb48-16"><a href="#cb48-16"></a>fig_RF <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(propVisit, <span class="fu">aes</span>(<span class="at">x=</span>Restoration.type, <span class="at">y=</span>propRF, <span class="at">fill=</span>Restoration.type)) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb48-17"><a href="#cb48-17"></a>    <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb48-18"><a href="#cb48-18"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb48-19"><a href="#cb48-19"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb48-20"><a href="#cb48-20"></a>       <span class="at">y=</span><span class="st">&quot;Proportion of rainforest species detections</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb48-21"><a href="#cb48-21"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb48-22"><a href="#cb48-22"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb48-23"><a href="#cb48-23"></a>      <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb48-24"><a href="#cb48-24"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb48-25"><a href="#cb48-25"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb48-26"><a href="#cb48-26"></a></span>
<span id="cb48-27"><a href="#cb48-27"></a><span class="fu">ggsave</span>(fig_RF, <span class="at">filename =</span> <span class="st">&quot;figs/fig_acousticPointCount_propRF.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>, <span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span>
<span id="cb48-28"><a href="#cb48-28"></a></span>
<span id="cb48-29"><a href="#cb48-29"></a>fig_OC <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(propVisit, <span class="fu">aes</span>(<span class="at">x=</span>Restoration.type, <span class="at">y=</span>propOC, <span class="at">fill=</span>Restoration.type)) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb48-30"><a href="#cb48-30"></a>    <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>)) <span class="sc">+</span></span>
<span id="cb48-31"><a href="#cb48-31"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb48-32"><a href="#cb48-32"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb48-33"><a href="#cb48-33"></a>       <span class="at">y=</span><span class="st">&quot;Proportion of open-country species detections</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb48-34"><a href="#cb48-34"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb48-35"><a href="#cb48-35"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb48-36"><a href="#cb48-36"></a>      <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb48-37"><a href="#cb48-37"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb48-38"><a href="#cb48-38"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb48-39"><a href="#cb48-39"></a></span>
<span id="cb48-40"><a href="#cb48-40"></a><span class="fu">ggsave</span>(fig_OC, <span class="at">filename =</span> <span class="st">&quot;figs/fig_acousticPointCount_propOC.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>, <span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figs/fig_acousticPointCount_propRF.png" alt="We observed significant differences in the proportion of rainforest bird species detections across treatment types, even when we aggregated data at the level of point count." />
<img src="figs/fig_acousticPointCount_propOC.png" alt="We observed significant differences in the proportion of open-country bird species detections across treatment types, even when we aggregated data at the level of point count." /></p>

</div>
</div>
<div id="non-metric-multidimensional-scaling-of-bird-species-detections" class="section level2 hasAnchor" number="0.13">
<h2><span class="header-section-number">0.13</span> Non-metric multidimensional scaling of bird species detections<a href="#non-metric-multidimensional-scaling-of-bird-species-detections" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here, we are interested not only in comparing univariate descriptors of communities, like diversity, but also in how the constituent species — or the composition — changes from one community to the next.</p>
<p>One tool to do this is non-metric multidimensional scaling, or NMDS. The goal of NMDS is to collapse information from multiple dimensions (e.g, from multiple communities, sites, etc.) into just a few, so that they can be visualized and interpreted. Unlike other ordination techniques that rely on (primarily Euclidean) distances, such as Principal Component Analysis, NMDS uses rank orders, and thus is an extremely flexible technique that can accommodate a variety of different kinds of data (The text above was copied from the link below).</p>
<p>NMDS does not use the absolute abundances of species in communities, but rather their rank orders. The use of ranks omits some of the issues associated with using absolute distance (e.g., sensitivity to transformation), and as a result is much more flexible technique that accepts a variety of types of data. (It’s also where the “non-metric” part of the name comes from).</p>
<p>A wonderful tutorial is presented in this link: <a href="https://jonlefcheck.net/2012/10/24/nmds-tutorial-in-r/" class="uri">https://jonlefcheck.net/2012/10/24/nmds-tutorial-in-r/</a></p>
<div id="install-required-libraries-6" class="section level3 hasAnchor" number="0.13.1">
<h3><span class="header-section-number">0.13.1</span> Install required libraries<a href="#install-required-libraries-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="fu">library</span>(vegan)</span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="fu">library</span>(scico)</span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="fu">library</span>(psych)</span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="fu">library</span>(ecodist)</span>
<span id="cb49-9"><a href="#cb49-9"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb49-10"><a href="#cb49-10"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb49-11"><a href="#cb49-11"></a><span class="fu">library</span>(ggalt)</span>
<span id="cb49-12"><a href="#cb49-12"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb49-13"><a href="#cb49-13"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb49-14"><a href="#cb49-14"></a></span>
<span id="cb49-15"><a href="#cb49-15"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb49-16"><a href="#cb49-16"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
<div id="load-the-necessary-data-for-nmds-calculations-1" class="section level3 hasAnchor" number="0.13.2">
<h3><span class="header-section-number">0.13.2</span> Load the necessary data for NMDS calculations<a href="#load-the-necessary-data-for-nmds-calculations-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># We load the subset data</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>datSubset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/datSubset.csv&quot;</span>)</span>
<span id="cb50-3"><a href="#cb50-3"></a></span>
<span id="cb50-4"><a href="#cb50-4"></a><span class="co"># Load species-trait data to essentially check for associations by habitat type</span></span>
<span id="cb50-5"><a href="#cb50-5"></a>trait_dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/species-trait-dat.csv&quot;</span>)</span>
<span id="cb50-6"><a href="#cb50-6"></a></span>
<span id="cb50-7"><a href="#cb50-7"></a><span class="co"># Site-summary (Number of detections across all sites)</span></span>
<span id="cb50-8"><a href="#cb50-8"></a>datSummary <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="#cb50-9"></a>  <span class="fu">group_by</span>(Site, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="#cb50-10"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-11"><a href="#cb50-11"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum)</span>
<span id="cb50-12"><a href="#cb50-12"></a></span>
<span id="cb50-13"><a href="#cb50-13"></a><span class="co"># richness across sites (converting detections to 1)</span></span>
<span id="cb50-14"><a href="#cb50-14"></a>richness <span class="ot">&lt;-</span> datSummary <span class="sc">%&gt;%</span> </span>
<span id="cb50-15"><a href="#cb50-15"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="sc">~</span> <span class="fu">replace</span>(., . <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-16"><a href="#cb50-16"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb50-17"><a href="#cb50-17"></a>  <span class="fu">mutate</span>(<span class="at">richness =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(IP<span class="sc">:</span>HSWP))) <span class="sc">%&gt;%</span></span>
<span id="cb50-18"><a href="#cb50-18"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, richness)</span></code></pre></div>
</div>
<div id="preparing-dataframe-of-traits-and-species-to-be-used-for-nmds-later-on" class="section level3 hasAnchor" number="0.13.3">
<h3><span class="header-section-number">0.13.3</span> Preparing dataframe of traits and species to be used for NMDS later on<a href="#preparing-dataframe-of-traits-and-species-to-be-used-for-nmds-later-on" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># Calculate the overall number of detections for each site. Here, we include dates, since each visit can explain the extrapolation of species richness when jackknife estimates are extracted. </span></span>
<span id="cb51-2"><a href="#cb51-2"></a></span>
<span id="cb51-3"><a href="#cb51-3"></a>nDetections_site_date <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4"></a>  <span class="fu">group_by</span>(Site, Restoration.type, Date) <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-6"><a href="#cb51-6"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum)</span>
<span id="cb51-7"><a href="#cb51-7"></a></span>
<span id="cb51-8"><a href="#cb51-8"></a><span class="co"># Combine the nDetections and trait based data to obtain a dataframe for further analysis</span></span>
<span id="cb51-9"><a href="#cb51-9"></a></span>
<span id="cb51-10"><a href="#cb51-10"></a>nDetections_trait <span class="ot">&lt;-</span> nDetections_site_date <span class="sc">%&gt;%</span></span>
<span id="cb51-11"><a href="#cb51-11"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>IP<span class="sc">:</span>HSWP, <span class="at">names_to=</span><span class="st">&quot;Species_Code&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-12"><a href="#cb51-12"></a>  <span class="fu">left_join</span>(.,trait_dat, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Species_Code&quot;</span><span class="ot">=</span><span class="st">&quot;species_annotation_codes&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-13"><a href="#cb51-13"></a>  <span class="fu">mutate</span>(<span class="at">forRichness =</span> <span class="fu">case_when</span>(count<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>,count<span class="sc">==</span><span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-14"><a href="#cb51-14"></a>  <span class="fu">rename</span>(., <span class="at">nDetections =</span> count)</span></code></pre></div>
</div>
<div id="preparing-a-dataframe-of-detections-to-run-ordinations" class="section level3 hasAnchor" number="0.13.4">
<h3><span class="header-section-number">0.13.4</span> Preparing a dataframe of detections to run ordinations<a href="#preparing-a-dataframe-of-detections-to-run-ordinations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># We will prepare a community matrix data that can be used to run dissimilarity indices</span></span>
<span id="cb52-2"><a href="#cb52-2"></a></span>
<span id="cb52-3"><a href="#cb52-3"></a>nmdsDat <span class="ot">&lt;-</span> nDetections_trait <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="#cb52-4"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Species_Code, nDetections, Restoration.type) <span class="sc">%&gt;%</span> </span>
<span id="cb52-5"><a href="#cb52-5"></a>  <span class="fu">group_by</span>(Species_Code, Site, Restoration.type) <span class="sc">%&gt;%</span> </span>
<span id="cb52-6"><a href="#cb52-6"></a>  <span class="fu">summarise</span> (<span class="at">totDetections =</span> <span class="fu">sum</span>(nDetections)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-7"><a href="#cb52-7"></a>  <span class="fu">arrange</span>(Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb52-8"><a href="#cb52-8"></a>  <span class="fu">pivot_wider</span> (<span class="at">names_from =</span> Species_Code, <span class="at">values_from =</span> totDetections, <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">totDetections=</span><span class="dv">0</span>))</span>
<span id="cb52-9"><a href="#cb52-9"></a></span>
<span id="cb52-10"><a href="#cb52-10"></a><span class="co"># Convert to matrix form</span></span>
<span id="cb52-11"><a href="#cb52-11"></a>nmdsDatMatrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(nmdsDat[, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(nmdsDat)])</span></code></pre></div>
</div>
<div id="bray-curtis-dissimilarity-index" class="section level3 hasAnchor" number="0.13.5">
<h3><span class="header-section-number">0.13.5</span> Bray-Curtis dissimilarity index<a href="#bray-curtis-dissimilarity-index" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Run a bray-curtis dissimilarity index and identify least stressed configuration for the ordinations. Bray-curtis is a statistic used to quantify the compositional dissimilarity between two different sites, based on counts at each site. Ecologists use the Bray-Curtis dissimilarity calculation, which has a number of ideal properties:
1. It is invariant to changes in units.
2. It is unaffected by additions/removals of species that are not present in two communities.
3. It is unaffected by the addition of a new community.
4. It can recognize differences in total abundances when relative abundances are the same.</p>
<p>Please note that this link provides more information on NMDS: <a href="http://strata.uga.edu/8370/lecturenotes/multidimensionalScaling.html" class="uri">http://strata.uga.edu/8370/lecturenotes/multidimensionalScaling.html</a></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># Run a bray-curtis dissimilarity index and use metaMDS function from vegan to run ordinations</span></span>
<span id="cb53-2"><a href="#cb53-2"></a></span>
<span id="cb53-3"><a href="#cb53-3"></a>disBrayCurtis <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(nmdsDatMatrix, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb53-4"><a href="#cb53-4"></a></span>
<span id="cb53-5"><a href="#cb53-5"></a>nmdsBrayCurtis <span class="ot">&lt;-</span> <span class="fu">vegdist</span> (nmdsDatMatrix, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-6"><a href="#cb53-6"></a>  <span class="fu">metaMDS</span> (nmdsBrayCurtis, <span class="at">k=</span><span class="dv">6</span>)</span>
<span id="cb53-7"><a href="#cb53-7"></a></span>
<span id="cb53-8"><a href="#cb53-8"></a><span class="co"># extract nmds scores</span></span>
<span id="cb53-9"><a href="#cb53-9"></a>nmdsScores <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(<span class="fu">scores</span>(nmdsBrayCurtis, <span class="at">display =</span> <span class="st">&quot;site&quot;</span>))</span>
<span id="cb53-10"><a href="#cb53-10"></a></span>
<span id="cb53-11"><a href="#cb53-11"></a><span class="co"># Write the scores to a separate .csv</span></span>
<span id="cb53-12"><a href="#cb53-12"></a><span class="fu">write.csv</span>(nmdsScores, <span class="st">&quot;data/nmdsBrayCurtis-bird-detections.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb53-13"><a href="#cb53-13"></a></span>
<span id="cb53-14"><a href="#cb53-14"></a><span class="co"># With the above analysis, we note the stress is 0.001537865. However, if stress is high, we should reposition the points in 2 dimensions in the direction of decreasing stress, and repeat until stress is below some threshold.**A good rule of thumb: stress &lt; 0.05 provides an excellent representation in reduced dimensions, &lt; 0.1 is great, &lt; 0.2 is good/ok, and stress &lt; 0.3 provides a poor representation.** To reiterate: high stress is bad, low stress is good!</span></span></code></pre></div>
</div>
<div id="plotting-the-nmds-scores-1" class="section level3 hasAnchor" number="0.13.6">
<h3><span class="header-section-number">0.13.6</span> Plotting the NMDS scores<a href="#plotting-the-nmds-scores-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># First let&#39;s add the treatment type back to the nmds scores</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>nmdsScores<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> nmdsDat<span class="sc">$</span>Restoration.type</span>
<span id="cb54-3"><a href="#cb54-3"></a></span>
<span id="cb54-4"><a href="#cb54-4"></a><span class="co"># Add a custom set of colors</span></span>
<span id="cb54-5"><a href="#cb54-5"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>), <span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Paired&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb54-6"><a href="#cb54-6"></a></span>
<span id="cb54-7"><a href="#cb54-7"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb54-8"><a href="#cb54-8"></a>nmdsScores<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(nmdsScores<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb54-9"><a href="#cb54-9"></a></span>
<span id="cb54-10"><a href="#cb54-10"></a>fig_nmds <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>nmdsScores) <span class="sc">+</span> </span>
<span id="cb54-11"><a href="#cb54-11"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">x=</span>NMDS1,<span class="at">y=</span>NMDS2,<span class="at">colour=</span>Restoration.type),<span class="at">level =</span> <span class="fl">0.50</span>) <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>NMDS1,<span class="at">y=</span>NMDS2,<span class="at">shape=</span>Restoration.type,<span class="at">colour=</span>Restoration.type),<span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb54-13"><a href="#cb54-13"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb54-14"><a href="#cb54-14"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&quot;NMDS 1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb54-15"><a href="#cb54-15"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">&quot;NMDS 2&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-16"><a href="#cb54-16"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(nmdsScores<span class="sc">$</span>Restoration.type)), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="sc">+</span></span>
<span id="cb54-17"><a href="#cb54-17"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="sc">+</span> </span>
<span id="cb54-18"><a href="#cb54-18"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb54-19"><a href="#cb54-19"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb54-20"><a href="#cb54-20"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb54-21"><a href="#cb54-21"></a>                                    <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb54-22"><a href="#cb54-22"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb54-23"><a href="#cb54-23"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb54-24"><a href="#cb54-24"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb54-25"><a href="#cb54-25"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb54-26"><a href="#cb54-26"></a>   <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">max</span>(nmdsScores<span class="sc">$</span>NMDS1), <span class="at">y =</span> <span class="fu">max</span>(nmdsScores<span class="sc">$</span>NMDS2),  <span class="at">label =</span> <span class="st">&quot;Stress = 0.001&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>, <span class="at">size=</span><span class="dv">5</span>)</span>
<span id="cb54-27"><a href="#cb54-27"></a></span>
<span id="cb54-28"><a href="#cb54-28"></a><span class="fu">ggsave</span>(fig_nmds, <span class="at">filename =</span> <span class="st">&quot;figs/fig_nmds_birdDetections.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>,<span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig_nmds_birdDetections.png" alt="" />
<p class="caption">AR sites are transitioning toward BM sites</p>
</div>
</div>
<div id="main-text-figure-5" class="section level3 hasAnchor" number="0.13.7">
<h3><span class="header-section-number">0.13.7</span> Main text Figure 5<a href="#main-text-figure-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="co"># reload previous figures to create part A and B for the main text Fig. 4</span></span>
<span id="cb55-2"><a href="#cb55-2"></a></span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb55-4"><a href="#cb55-4"></a></span>
<span id="cb55-5"><a href="#cb55-5"></a>fig_prop_ordinations <span class="ot">&lt;-</span></span>
<span id="cb55-6"><a href="#cb55-6"></a>  <span class="fu">wrap_plots</span>(fig_propRF, fig_propOC, fig_nmds,</span>
<span id="cb55-7"><a href="#cb55-7"></a>    <span class="at">design =</span> <span class="st">&#39;AB</span></span>
<span id="cb55-8"><a href="#cb55-8"></a><span class="st">              CC&#39;</span></span>
<span id="cb55-9"><a href="#cb55-9"></a>  ) <span class="sc">+</span></span>
<span id="cb55-10"><a href="#cb55-10"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb55-11"><a href="#cb55-11"></a>    <span class="at">tag_levels =</span> <span class="st">&quot;a&quot;</span>,</span>
<span id="cb55-12"><a href="#cb55-12"></a>    <span class="at">tag_prefix =</span> <span class="st">&quot;(&quot;</span>,</span>
<span id="cb55-13"><a href="#cb55-13"></a>    <span class="at">tag_suffix =</span> <span class="st">&quot;)&quot;</span></span>
<span id="cb55-14"><a href="#cb55-14"></a>  )</span>
<span id="cb55-15"><a href="#cb55-15"></a></span>
<span id="cb55-16"><a href="#cb55-16"></a><span class="co"># Expand the width to avoid compression</span></span>
<span id="cb55-17"><a href="#cb55-17"></a><span class="fu">ggsave</span>(fig_prop_ordinations, <span class="at">filename =</span> <span class="st">&quot;figs/fig05.png&quot;</span>, <span class="at">width=</span><span class="dv">15</span>, <span class="at">height=</span><span class="dv">12</span>,<span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig05.png" alt="" />
<p class="caption"><strong>Proportion of acoustic detections of rainforest and open-country bird species and NMDS ordination results of bird species detections</strong>
(a) We observed significant differences in the proportion of rainforest bird species detections across each of the three treatment types (Tukey HSD test, P &lt; 0.05). BM sites had the highest proportion of rainforest bird species detections (mean ± SD: 0.97 ± 0.04), followed by AR sites (mean ± SD: 0.81 ± 0.12), and NR sites (mean ± SD: 0.71 ± 0.17). (b) We observed significant differences in the proportion of open-country bird species detections across each of the three treatment type (Tukey HSD test, P &lt; 0.05). NR sites had the highest proportion of open-country bird species detections (mean ± SD: 0.28 ± 0.17), followed by AR sites (mean ± SD: 0.18 ± 0.12), and BM sites (mean ± SD: 0.02 ± 0.04). (b) The ordination analysis of bird detections data (stress = 0.001) revealed distinct clusters of BM sites, but relatively loose clusters for AR and NR sites. However, AR sites occupied an intermediate position between BM and NR sites, indicating a direction of change in bird community composition toward BM sites. In the above figure, BM = undisturbed benchmark rainforest sites, AR = Actively restored forest sites and NR = Naturally regenerating forest sites.</p>
</div>
</div>
<div id="testing-multivariate-homogeneity-of-group-dispersions-1" class="section level3 hasAnchor" number="0.13.8">
<h3><span class="header-section-number">0.13.8</span> Testing multivariate homogeneity of group dispersions<a href="#testing-multivariate-homogeneity-of-group-dispersions-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One measure of multivariate dispersion (variance) for a group of samples is to calculate the average distance of group members to the group centroid or spatial median in multivariate space. To test if the dispersions (variances) of one or more groups are different, the distances of group members to the group centroid are subject to ANOVA.</p>
<p>Betadisper tests whether two or more groups (for example, restored and unrestored sites) are homogeneously dispersed in relation to their species in studied samples. This test can be done to see if one group has more compositional variance than another. Moreover, homogeneity of dispersion among groups is very advisable to have if you want to test if two or more groups have different compositions, which is tested by adonis.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>nmdsVariance <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(disBrayCurtis, <span class="at">group =</span> nmdsDat<span class="sc">$</span>Restoration.type)</span>
<span id="cb56-2"><a href="#cb56-2"></a>nmdsVariance</span>
<span id="cb56-3"><a href="#cb56-3"></a></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="fu">anova</span>(nmdsVariance)</span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="fu">permutest</span>(nmdsVariance, <span class="at">pairwise =</span> <span class="cn">TRUE</span>, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb56-6"><a href="#cb56-6"></a><span class="fu">TukeyHSD</span>(nmdsVariance)</span>
<span id="cb56-7"><a href="#cb56-7"></a></span>
<span id="cb56-8"><a href="#cb56-8"></a><span class="co"># These results suggest that there is no difference in within-group variance between one group and another</span></span></code></pre></div>
</div>
<div id="visualizing-the-multivariate-homogeneity-of-group-dispersions-1" class="section level3 hasAnchor" number="0.13.9">
<h3><span class="header-section-number">0.13.9</span> Visualizing the multivariate homogeneity of group dispersions<a href="#visualizing-the-multivariate-homogeneity-of-group-dispersions-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The below lines of code have been adapted from: <a href="https://chrischizinski.github.io/rstats/adonis/" class="uri">https://chrischizinski.github.io/rstats/adonis/</a></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># extract the centroids and the site points in multivariate space.  </span></span>
<span id="cb57-2"><a href="#cb57-2"></a>centroids <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">grps=</span><span class="fu">rownames</span>(nmdsVariance<span class="sc">$</span>centroids),</span>
<span id="cb57-3"><a href="#cb57-3"></a>                       <span class="fu">data.frame</span>(nmdsVariance<span class="sc">$</span>centroids))</span>
<span id="cb57-4"><a href="#cb57-4"></a>vectors <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group=</span>nmdsVariance<span class="sc">$</span>group,</span>
<span id="cb57-5"><a href="#cb57-5"></a>                      <span class="fu">data.frame</span>(nmdsVariance<span class="sc">$</span>vectors))</span>
<span id="cb57-6"><a href="#cb57-6"></a></span>
<span id="cb57-7"><a href="#cb57-7"></a><span class="co"># to create the lines from the centroids to each point we will put it in a format that ggplot can handle</span></span>
<span id="cb57-8"><a href="#cb57-8"></a>seg.data<span class="ot">&lt;-</span><span class="fu">cbind</span>(vectors[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],centroids[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(centroids),<span class="fu">as.data.frame</span>(<span class="fu">table</span>(vectors<span class="sc">$</span>group))<span class="sc">$</span>Freq),<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb57-9"><a href="#cb57-9"></a><span class="fu">names</span>(seg.data)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;group&quot;</span>,<span class="st">&quot;v.PCoA1&quot;</span>,<span class="st">&quot;v.PCoA2&quot;</span>,<span class="st">&quot;PCoA1&quot;</span>,<span class="st">&quot;PCoA2&quot;</span>)</span>
<span id="cb57-10"><a href="#cb57-10"></a></span>
<span id="cb57-11"><a href="#cb57-11"></a><span class="co"># create the convex hulls of the outermost points</span></span>
<span id="cb57-12"><a href="#cb57-12"></a>grp1.hull <span class="ot">&lt;-</span> seg.data[seg.data<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;Active&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>][<span class="fu">chull</span>(seg.data[seg.data<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;Active&quot;</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]),]</span>
<span id="cb57-13"><a href="#cb57-13"></a>grp2.hull <span class="ot">&lt;-</span> seg.data[seg.data<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;Benchmark&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>][<span class="fu">chull</span>(seg.data[seg.data<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;Benchmark&quot;</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]),]</span>
<span id="cb57-14"><a href="#cb57-14"></a>grp3.hull <span class="ot">&lt;-</span> seg.data[seg.data<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;Passive&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>][<span class="fu">chull</span>(seg.data[seg.data<span class="sc">$</span>group<span class="sc">==</span><span class="st">&quot;Passive&quot;</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]),]</span>
<span id="cb57-15"><a href="#cb57-15"></a>all.hull <span class="ot">&lt;-</span> <span class="fu">rbind</span>(grp1.hull,grp2.hull,grp3.hull)</span>
<span id="cb57-16"><a href="#cb57-16"></a></span>
<span id="cb57-17"><a href="#cb57-17"></a><span class="co"># plot the panel and convex hulls</span></span>
<span id="cb57-18"><a href="#cb57-18"></a>fig_hull <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb57-19"><a href="#cb57-19"></a>  <span class="fu">geom_polygon</span>(<span class="at">data=</span> all.hull,<span class="fu">aes</span>(<span class="at">x=</span>v.PCoA1,<span class="at">y=</span>v.PCoA2),<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb57-20"><a href="#cb57-20"></a>  <span class="fu">geom_segment</span>(<span class="at">data=</span>seg.data,<span class="fu">aes</span>(<span class="at">x=</span>v.PCoA1,<span class="at">xend=</span>PCoA1,<span class="at">y=</span>v.PCoA2,<span class="at">yend=</span>PCoA2),<span class="at">alpha=</span><span class="fl">0.30</span>) <span class="sc">+</span> </span>
<span id="cb57-21"><a href="#cb57-21"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>centroids[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="fu">aes</span>(<span class="at">x=</span>PCoA1,<span class="at">y=</span>PCoA2,<span class="at">shape=</span>grps),<span class="at">size=</span><span class="dv">4</span>,<span class="at">colour=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb57-22"><a href="#cb57-22"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>seg.data, <span class="fu">aes</span>(<span class="at">x=</span>v.PCoA1,<span class="at">y=</span>v.PCoA2,<span class="at">shape=</span>group),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb57-23"><a href="#cb57-23"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;All&quot;</span>,<span class="at">x=</span><span class="st">&quot;&quot;</span>,<span class="at">y=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb57-24"><a href="#cb57-24"></a>  <span class="co">#coord_cartesian(xlim = c(-0.2,0.2), ylim = c(-0.25,0.2)) +</span></span>
<span id="cb57-25"><a href="#cb57-25"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb57-26"><a href="#cb57-26"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
</div>
<div id="testing-compositional-dissimilarity-between-groups" class="section level3 hasAnchor" number="0.13.10">
<h3><span class="header-section-number">0.13.10</span> Testing compositional dissimilarity between groups<a href="#testing-compositional-dissimilarity-between-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will do this by using the vegan::adonis() function which allows you to run permutational multivariate analysis of variance using distance matrices. In the above figure, the NMDS confidence ellipses suggest that there is a significant difference between benchmark and passive-active sites, but no difference between active and passive sites. Adonis works by first finding the centroids for each group and then calculates the squared deviations of each of site to that centroid. Then significance tests are performed using F-tests based on sequential sums of squares from permutations of the raw data. Please note that adonis analyzes and partitions sums of squares using distance matrices. It can be thought of as an ANOVA using distance matrices (analogous to MANOVA - multivariate analysis of variance). Therefore, it is used to test if two or more groups have similar compositions.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># We will use the NMDS scores for axis 1 and axis 2 to test for compositional dissimilarity</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>groups <span class="ot">&lt;-</span> nmdsScores<span class="sc">$</span>Restoration.type</span>
<span id="cb58-3"><a href="#cb58-3"></a></span>
<span id="cb58-4"><a href="#cb58-4"></a>adonisNMDS <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(nmdsDatMatrix <span class="sc">~</span> groups, <span class="at">method=</span><span class="st">&quot;bray&quot;</span>,<span class="at">perm=</span><span class="dv">999</span>)</span>
<span id="cb58-5"><a href="#cb58-5"></a>adonisNMDS</span>
<span id="cb58-6"><a href="#cb58-6"></a></span>
<span id="cb58-7"><a href="#cb58-7"></a><span class="co"># The results suggest that there are significant compositional differences between groups.</span></span></code></pre></div>
</div>
<div id="separate-analysis-instead-of-using-bird-detections-using-richness-to-run-nmds-ordinations" class="section level3 hasAnchor" number="0.13.11">
<h3><span class="header-section-number">0.13.11</span> Separate analysis: Instead of using bird detections, using richness to run nmds ordinations<a href="#separate-analysis-instead-of-using-bird-detections-using-richness-to-run-nmds-ordinations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>nmdsDatRichness <span class="ot">&lt;-</span> datSummary <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="#cb59-2"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="sc">~</span> <span class="fu">replace</span>(., . <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb59-3"><a href="#cb59-3"></a></span>
<span id="cb59-4"><a href="#cb59-4"></a><span class="co"># Convert to matrix form</span></span>
<span id="cb59-5"><a href="#cb59-5"></a>nmdsDatMatrixRichness <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(nmdsDatRichness[, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(nmdsDatRichness)])</span>
<span id="cb59-6"><a href="#cb59-6"></a></span>
<span id="cb59-7"><a href="#cb59-7"></a><span class="co"># Run a bray-curtis dissimilarity index and use metaMDS function from vegan to run ordinations</span></span>
<span id="cb59-8"><a href="#cb59-8"></a></span>
<span id="cb59-9"><a href="#cb59-9"></a>disBrayCurtisRichness <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(nmdsDatMatrixRichness, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb59-10"><a href="#cb59-10"></a></span>
<span id="cb59-11"><a href="#cb59-11"></a>nmdsBrayCurtisRichness <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(nmdsDatMatrixRichness, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>) <span class="sc">%&gt;%</span>   <span class="fu">metaMDS</span> (nmdsBrayCurtisRichness, <span class="at">k=</span><span class="dv">6</span>)</span>
<span id="cb59-12"><a href="#cb59-12"></a></span>
<span id="cb59-13"><a href="#cb59-13"></a><span class="co"># extract nmds scores</span></span>
<span id="cb59-14"><a href="#cb59-14"></a>nmdsScoresRichness <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(<span class="fu">scores</span>(nmdsBrayCurtisRichness))</span>
<span id="cb59-15"><a href="#cb59-15"></a></span>
<span id="cb59-16"><a href="#cb59-16"></a><span class="co"># plot the data</span></span>
<span id="cb59-17"><a href="#cb59-17"></a><span class="co"># First let&#39;s add the treatment type back to the nmds scores</span></span>
<span id="cb59-18"><a href="#cb59-18"></a>nmdsScoresRichness<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> nmdsDatRichness<span class="sc">$</span>Restoration.type</span>
<span id="cb59-19"><a href="#cb59-19"></a></span>
<span id="cb59-20"><a href="#cb59-20"></a><span class="co"># Add a custom set of colors</span></span>
<span id="cb59-21"><a href="#cb59-21"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>), <span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Paired&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb59-22"><a href="#cb59-22"></a></span>
<span id="cb59-23"><a href="#cb59-23"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb59-24"><a href="#cb59-24"></a>nmdsScoresRichness<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(nmdsScoresRichness<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb59-25"><a href="#cb59-25"></a></span>
<span id="cb59-26"><a href="#cb59-26"></a>fig_nmds_richness <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>nmdsScoresRichness) <span class="sc">+</span> </span>
<span id="cb59-27"><a href="#cb59-27"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">x=</span>NMDS1,<span class="at">y=</span>NMDS2,<span class="at">colour=</span>Restoration.type),<span class="at">level =</span> <span class="fl">0.50</span>) <span class="sc">+</span></span>
<span id="cb59-28"><a href="#cb59-28"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>NMDS1,<span class="at">y=</span>NMDS2,<span class="at">shape=</span>Restoration.type,<span class="at">colour=</span>Restoration.type),<span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb59-29"><a href="#cb59-29"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb59-30"><a href="#cb59-30"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&quot;NMDS 1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb59-31"><a href="#cb59-31"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">&quot;NMDS 2&quot;</span>) <span class="sc">+</span></span>
<span id="cb59-32"><a href="#cb59-32"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(nmdsScoresRichness<span class="sc">$</span>Restoration.type)), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="sc">+</span></span>
<span id="cb59-33"><a href="#cb59-33"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="sc">+</span> </span>
<span id="cb59-34"><a href="#cb59-34"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb59-35"><a href="#cb59-35"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb59-36"><a href="#cb59-36"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb59-37"><a href="#cb59-37"></a>                                    <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb59-38"><a href="#cb59-38"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb59-39"><a href="#cb59-39"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb59-40"><a href="#cb59-40"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb59-41"><a href="#cb59-41"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb59-42"><a href="#cb59-42"></a>   <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">max</span>(nmdsScoresRichness<span class="sc">$</span>NMDS1), <span class="at">y =</span> <span class="fu">max</span>(nmdsScoresRichness<span class="sc">$</span>NMDS2),  <span class="at">label =</span> <span class="st">&quot;Stress = 0.1&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>, <span class="at">size=</span><span class="dv">5</span>)</span>
<span id="cb59-43"><a href="#cb59-43"></a></span>
<span id="cb59-44"><a href="#cb59-44"></a><span class="fu">ggsave</span>(fig_nmds_richness, <span class="at">filename =</span> <span class="st">&quot;figs/fig_nmds_birdRichness.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>,<span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure">
<img src="figs/fig_nmds_birdRichness.png" alt="" />
<p class="caption">Similar results as that of bird species detections were observed.</p>
</div>

</div>
</div>
<div id="jackknife-estimates" class="section level2 hasAnchor" number="0.14">
<h2><span class="header-section-number">0.14</span> Jackknife estimates<a href="#jackknife-estimates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this script, we will extract jackknife scores, which essentially extrapolates species richness for a given species pool. This calculation is based on the number of sites and the number of visits to each site and the number of singletons/doubletons (detecting a species only once/site and twice/site respectively).</p>
<div id="install-required-libraries-7" class="section level3 hasAnchor" number="0.14.1">
<h3><span class="header-section-number">0.14.1</span> Install required libraries<a href="#install-required-libraries-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="fu">library</span>(vegan)</span>
<span id="cb60-5"><a href="#cb60-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="fu">library</span>(scico)</span>
<span id="cb60-7"><a href="#cb60-7"></a><span class="fu">library</span>(psych)</span>
<span id="cb60-8"><a href="#cb60-8"></a></span>
<span id="cb60-9"><a href="#cb60-9"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb60-10"><a href="#cb60-10"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
<div id="load-the-necessary-data-to-calculate-jackknife-scores" class="section level3 hasAnchor" number="0.14.2">
<h3><span class="header-section-number">0.14.2</span> Load the necessary data to calculate Jackknife scores<a href="#load-the-necessary-data-to-calculate-jackknife-scores" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># We load the subset data</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>datSubset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/datSubset.csv&quot;</span>)</span>
<span id="cb61-3"><a href="#cb61-3"></a></span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="co"># Load species-trait data to essentially check for associations by habitat type</span></span>
<span id="cb61-5"><a href="#cb61-5"></a>trait_dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/species-trait-dat.csv&quot;</span>)</span>
<span id="cb61-6"><a href="#cb61-6"></a></span>
<span id="cb61-7"><a href="#cb61-7"></a><span class="co"># Site-summary (Number of detections across all sites)</span></span>
<span id="cb61-8"><a href="#cb61-8"></a>datSummary <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb61-9"><a href="#cb61-9"></a>  <span class="fu">group_by</span>(Site, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb61-10"><a href="#cb61-10"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-11"><a href="#cb61-11"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum)</span></code></pre></div>
</div>
<div id="preparing-dataframe-to-extract-jacknife-scores" class="section level3 hasAnchor" number="0.14.3">
<h3><span class="header-section-number">0.14.3</span> Preparing dataframe to extract jacknife scores<a href="#preparing-dataframe-to-extract-jacknife-scores" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># Calculate the overall number of detections for each site across 6 days of data (translates to ~96-min of data per site; each detection corresponding to a temporal unit of 10 seconds). Here, we include dates, since each visit can explain the extrapolation of species richness when jackknife estimates are extracted. </span></span>
<span id="cb62-2"><a href="#cb62-2"></a></span>
<span id="cb62-3"><a href="#cb62-3"></a>nDetections_site_date <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4"></a>  <span class="fu">group_by</span>(Site, Restoration.type, Date) <span class="sc">%&gt;%</span></span>
<span id="cb62-5"><a href="#cb62-5"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-6"><a href="#cb62-6"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum)</span>
<span id="cb62-7"><a href="#cb62-7"></a>  </span>
<span id="cb62-8"><a href="#cb62-8"></a><span class="co"># Combine the nDetections and trait based data to obtain a dataframe for jackknife estimates</span></span>
<span id="cb62-9"><a href="#cb62-9"></a></span>
<span id="cb62-10"><a href="#cb62-10"></a>nDetections_trait <span class="ot">&lt;-</span> nDetections_site_date <span class="sc">%&gt;%</span></span>
<span id="cb62-11"><a href="#cb62-11"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>IP<span class="sc">:</span>HSWP, <span class="at">names_to=</span><span class="st">&quot;Species_Code&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-12"><a href="#cb62-12"></a>  <span class="fu">left_join</span>(.,trait_dat, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Species_Code&quot;</span><span class="ot">=</span><span class="st">&quot;species_annotation_codes&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-13"><a href="#cb62-13"></a>  <span class="fu">mutate</span>(<span class="at">forRichness =</span> <span class="fu">case_when</span>(count<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>,count<span class="sc">==</span><span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-14"><a href="#cb62-14"></a>  <span class="fu">rename</span>(., <span class="at">nDetections =</span> count)</span>
<span id="cb62-15"><a href="#cb62-15"></a></span>
<span id="cb62-16"><a href="#cb62-16"></a><span class="co"># Extract jackknife scores</span></span>
<span id="cb62-17"><a href="#cb62-17"></a><span class="co"># To do the same, we first prepare the dataframe in a manner where we have a matrix of Site by Date by Species name</span></span>
<span id="cb62-18"><a href="#cb62-18"></a></span>
<span id="cb62-19"><a href="#cb62-19"></a>jacknifeAll <span class="ot">&lt;-</span> nDetections_trait <span class="sc">%&gt;%</span></span>
<span id="cb62-20"><a href="#cb62-20"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Date, Species_Code, nDetections, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb62-21"><a href="#cb62-21"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type, Species_Code) <span class="sc">%&gt;%</span></span>
<span id="cb62-22"><a href="#cb62-22"></a>  <span class="fu">summarise</span>(<span class="at">totDetections =</span> <span class="fu">sum</span>(nDetections)) <span class="sc">%&gt;%</span></span>
<span id="cb62-23"><a href="#cb62-23"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Species_Code, <span class="at">values_from =</span> totDetections, <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">totDetections=</span><span class="dv">0</span>))</span>
<span id="cb62-24"><a href="#cb62-24"></a></span>
<span id="cb62-25"><a href="#cb62-25"></a><span class="co"># Prepare a dataframe of rainforest species for jacknifing</span></span>
<span id="cb62-26"><a href="#cb62-26"></a></span>
<span id="cb62-27"><a href="#cb62-27"></a>jacknife_rainForest <span class="ot">&lt;-</span> nDetections_trait <span class="sc">%&gt;%</span></span>
<span id="cb62-28"><a href="#cb62-28"></a>  <span class="fu">filter</span>(habitat<span class="sc">==</span><span class="st">&quot;RF&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-29"><a href="#cb62-29"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Date, Species_Code, nDetections, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb62-30"><a href="#cb62-30"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type, Species_Code) <span class="sc">%&gt;%</span></span>
<span id="cb62-31"><a href="#cb62-31"></a>  <span class="fu">summarise</span>(<span class="at">totDetections =</span> <span class="fu">sum</span>(nDetections)) <span class="sc">%&gt;%</span></span>
<span id="cb62-32"><a href="#cb62-32"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Species_Code, <span class="at">values_from =</span> totDetections, <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">totDetections=</span><span class="dv">0</span>))</span>
<span id="cb62-33"><a href="#cb62-33"></a></span>
<span id="cb62-34"><a href="#cb62-34"></a><span class="co"># Prepare a dataframe of open-country species for jacknifing</span></span>
<span id="cb62-35"><a href="#cb62-35"></a></span>
<span id="cb62-36"><a href="#cb62-36"></a>jacknife_openCountry <span class="ot">&lt;-</span> nDetections_trait <span class="sc">%&gt;%</span></span>
<span id="cb62-37"><a href="#cb62-37"></a>  <span class="fu">filter</span>(habitat<span class="sc">==</span><span class="st">&quot;OC&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-38"><a href="#cb62-38"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Date, Species_Code, nDetections, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb62-39"><a href="#cb62-39"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type, Species_Code) <span class="sc">%&gt;%</span></span>
<span id="cb62-40"><a href="#cb62-40"></a>  <span class="fu">summarise</span>(<span class="at">totDetections =</span> <span class="fu">sum</span>(nDetections)) <span class="sc">%&gt;%</span></span>
<span id="cb62-41"><a href="#cb62-41"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Species_Code, <span class="at">values_from =</span> totDetections, <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">totDetections=</span><span class="dv">0</span>))</span></code></pre></div>
</div>
<div id="save-scores-locally" class="section level3 hasAnchor" number="0.14.4">
<h3><span class="header-section-number">0.14.4</span> Save scores locally<a href="#save-scores-locally" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb63"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>jackAllScore <span class="ot">&lt;-</span> <span class="fu">specpool</span>(jacknifeAll[,<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(jacknifeAll)],</span>
<span id="cb63-2"><a href="#cb63-2"></a>                       <span class="at">pool =</span> jacknifeAll<span class="sc">$</span>Site) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;Site&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>  <span class="fu">add_column</span> (<span class="at">Restoration.type =</span> datSummary<span class="sc">$</span>Restoration.type)</span>
<span id="cb63-5"><a href="#cb63-5"></a></span>
<span id="cb63-6"><a href="#cb63-6"></a><span class="co"># write out results</span></span>
<span id="cb63-7"><a href="#cb63-7"></a><span class="fu">write.csv</span>(jackAllScore, <span class="st">&quot;data/jackAll.csv&quot;</span>, <span class="at">row.names=</span>F)</span>
<span id="cb63-8"><a href="#cb63-8"></a></span>
<span id="cb63-9"><a href="#cb63-9"></a>jack_rainForestScore <span class="ot">&lt;-</span> <span class="fu">specpool</span>(jacknife_rainForest[,<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(jacknife_rainForest)],</span>
<span id="cb63-10"><a href="#cb63-10"></a>                       <span class="at">pool =</span> jacknife_rainForest<span class="sc">$</span>Site) <span class="sc">%&gt;%</span></span>
<span id="cb63-11"><a href="#cb63-11"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;Site&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-12"><a href="#cb63-12"></a>  <span class="fu">add_column</span> (<span class="at">Restoration.type =</span> datSummary<span class="sc">$</span>Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb63-13"><a href="#cb63-13"></a>  <span class="fu">mutate</span>(<span class="at">Habitat =</span> <span class="st">&quot;RF&quot;</span>)</span>
<span id="cb63-14"><a href="#cb63-14"></a></span>
<span id="cb63-15"><a href="#cb63-15"></a><span class="co"># write out results</span></span>
<span id="cb63-16"><a href="#cb63-16"></a><span class="fu">write.csv</span>(jack_rainForestScore,<span class="st">&quot;data/jackRainforest.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb63-17"><a href="#cb63-17"></a></span>
<span id="cb63-18"><a href="#cb63-18"></a>jack_openCountryScore <span class="ot">&lt;-</span><span class="fu">specpool</span>(jacknife_openCountry[,<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(jacknife_openCountry)],</span>
<span id="cb63-19"><a href="#cb63-19"></a>                       <span class="at">pool =</span> jacknife_openCountry<span class="sc">$</span>Site) <span class="sc">%&gt;%</span></span>
<span id="cb63-20"><a href="#cb63-20"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;Site&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-21"><a href="#cb63-21"></a>  <span class="fu">add_column</span> (<span class="at">Restoration.type =</span> datSummary<span class="sc">$</span>Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb63-22"><a href="#cb63-22"></a>  <span class="fu">mutate</span>(<span class="at">Habitat =</span> <span class="st">&quot;OC&quot;</span>)</span>
<span id="cb63-23"><a href="#cb63-23"></a></span>
<span id="cb63-24"><a href="#cb63-24"></a><span class="co"># write out results</span></span>
<span id="cb63-25"><a href="#cb63-25"></a><span class="fu">write.csv</span>(jack_openCountryScore, <span class="st">&quot;data/jackOpencountry.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="looking-at-correlations-between-jacknife-scores-and-bootstrap-estimates" class="section level3 hasAnchor" number="0.14.5">
<h3><span class="header-section-number">0.14.5</span> Looking at correlations between jacknife scores and bootstrap estimates<a href="#looking-at-correlations-between-jacknife-scores-and-bootstrap-estimates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># This plot suggests an almost 1:1 correlation between jacknife estimates and bootstrap scores</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="fu">plot</span>(jackAllScore<span class="sc">$</span>jack1, jackAllScore<span class="sc">$</span>boot)</span></code></pre></div>
</div>
<div id="testing-for-differences-between-treatment-types" class="section level3 hasAnchor" number="0.14.6">
<h3><span class="header-section-number">0.14.6</span> Testing for differences between treatment types<a href="#testing-for-differences-between-treatment-types" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plotting jacknife estimates and testing for any significant differences between treatment types</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># Test if there are significant differences in jacknife estimates across treatment types</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>anovaJackAll <span class="ot">&lt;-</span> <span class="fu">aov</span>(jack1<span class="sc">~</span>Restoration.type, <span class="at">data =</span> jackAllScore)</span>
<span id="cb65-3"><a href="#cb65-3"></a></span>
<span id="cb65-4"><a href="#cb65-4"></a><span class="co"># Tukey test to study each pair of treatment - reveals no signficant difference across treatment types</span></span>
<span id="cb65-5"><a href="#cb65-5"></a>tukeyJackAll <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anovaJackAll)</span>
<span id="cb65-6"><a href="#cb65-6"></a></span>
<span id="cb65-7"><a href="#cb65-7"></a><span class="co"># The above result suggests that there is no significant different in jacknife scores between treatment types</span></span>
<span id="cb65-8"><a href="#cb65-8"></a></span>
<span id="cb65-9"><a href="#cb65-9"></a><span class="co"># Create a boxplot of jacknife estimates by group (Here: group refers to Restoration Type)</span></span>
<span id="cb65-10"><a href="#cb65-10"></a></span>
<span id="cb65-11"><a href="#cb65-11"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb65-12"><a href="#cb65-12"></a>jackAllScore<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(jackAllScore<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb65-13"><a href="#cb65-13"></a><span class="co"># Add a custom set of colors</span></span>
<span id="cb65-14"><a href="#cb65-14"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>), <span class="fu">brewer.pal</span>(<span class="at">name=</span><span class="st">&quot;Paired&quot;</span>, <span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb65-15"><a href="#cb65-15"></a></span>
<span id="cb65-16"><a href="#cb65-16"></a>fig_jackAll <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(jackAllScore, <span class="fu">aes</span>(<span class="at">x=</span>Restoration.type, <span class="at">y=</span>jack1, <span class="at">fill=</span>Restoration.type)) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb65-17"><a href="#cb65-17"></a>   <span class="fu">scale_fill_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="at">values=</span>mycolors, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="sc">+</span> </span>
<span id="cb65-18"><a href="#cb65-18"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb65-19"><a href="#cb65-19"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb65-20"><a href="#cb65-20"></a>       <span class="at">y=</span><span class="st">&quot;Jackknife estimates</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb65-21"><a href="#cb65-21"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb65-22"><a href="#cb65-22"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb65-23"><a href="#cb65-23"></a>      <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb65-24"><a href="#cb65-24"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb65-25"><a href="#cb65-25"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb65-26"><a href="#cb65-26"></a></span>
<span id="cb65-27"><a href="#cb65-27"></a><span class="fu">ggsave</span>(fig_jackAll, <span class="at">filename =</span> <span class="st">&quot;figs/fig_jackAll.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>,</span>
<span id="cb65-28"><a href="#cb65-28"></a>       <span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figs/fig_jackAll.png" alt="No significant differences across treatment types were observed." />
### Jacknife scores by species traits</p>
<p>Let’s test for significant differences in jacknife estimates as a function of species trait</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>anovaJack_rainForest <span class="ot">&lt;-</span> <span class="fu">aov</span>(jack1<span class="sc">~</span>Restoration.type, <span class="at">data =</span> jack_rainForestScore)</span>
<span id="cb66-2"><a href="#cb66-2"></a>anovaJack_openCountry <span class="ot">&lt;-</span> <span class="fu">aov</span>(jack1<span class="sc">~</span>Restoration.type, <span class="at">data =</span> jack_openCountryScore)</span>
<span id="cb66-3"><a href="#cb66-3"></a></span>
<span id="cb66-4"><a href="#cb66-4"></a><span class="co"># Tukey test to study each pair of treatment </span></span>
<span id="cb66-5"><a href="#cb66-5"></a>tukeyJack_rainForest <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anovaJack_rainForest)</span>
<span id="cb66-6"><a href="#cb66-6"></a>tukeyJack_openCountry <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anovaJack_openCountry)</span>
<span id="cb66-7"><a href="#cb66-7"></a></span>
<span id="cb66-8"><a href="#cb66-8"></a><span class="co"># For rainforest species - there is no significant difference in jacknife estimates between any treatment types, while for open-country birds; there is a significant difference in jacknife estimates across active-benchmark and passive-benchmark</span></span>
<span id="cb66-9"><a href="#cb66-9"></a></span>
<span id="cb66-10"><a href="#cb66-10"></a><span class="co"># Plot the above results</span></span>
<span id="cb66-11"><a href="#cb66-11"></a></span>
<span id="cb66-12"><a href="#cb66-12"></a>jackTrait <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(jack_rainForestScore, jack_openCountryScore)</span>
<span id="cb66-13"><a href="#cb66-13"></a></span>
<span id="cb66-14"><a href="#cb66-14"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb66-15"><a href="#cb66-15"></a>jackTrait<span class="sc">$</span>Restoration.type <span class="ot">&lt;-</span> <span class="fu">factor</span>(jackTrait<span class="sc">$</span>Restoration.type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb66-16"><a href="#cb66-16"></a></span>
<span id="cb66-17"><a href="#cb66-17"></a><span class="co"># Rainforest species</span></span>
<span id="cb66-18"><a href="#cb66-18"></a>fig_jackTrait <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(jackTrait, <span class="fu">aes</span>(<span class="at">x=</span>Restoration.type, <span class="at">y=</span>jack1, <span class="at">fill=</span>Habitat)) <span class="sc">+</span></span>
<span id="cb66-19"><a href="#cb66-19"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb66-20"><a href="#cb66-20"></a>    <span class="fu">scale_fill_scico_d</span>(<span class="at">palette =</span> <span class="st">&quot;roma&quot;</span>,</span>
<span id="cb66-21"><a href="#cb66-21"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Open-country&quot;</span>,<span class="st">&quot;Rainforest&quot;</span>)) <span class="sc">+</span></span>
<span id="cb66-22"><a href="#cb66-22"></a>     <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb66-23"><a href="#cb66-23"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Treatment Type&quot;</span>, </span>
<span id="cb66-24"><a href="#cb66-24"></a>       <span class="at">y=</span><span class="st">&quot;Jackknife estimates</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb66-25"><a href="#cb66-25"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;BM&#39;</span>,<span class="st">&#39;AR&#39;</span>,<span class="st">&#39;NR&#39;</span>)) <span class="sc">+</span></span>
<span id="cb66-26"><a href="#cb66-26"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb66-27"><a href="#cb66-27"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb66-28"><a href="#cb66-28"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb66-29"><a href="#cb66-29"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb66-30"><a href="#cb66-30"></a>                                    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb66-31"><a href="#cb66-31"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb66-32"><a href="#cb66-32"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb66-33"><a href="#cb66-33"></a></span>
<span id="cb66-34"><a href="#cb66-34"></a><span class="fu">ggsave</span>(fig_jackTrait, <span class="at">filename =</span> <span class="st">&quot;figs/fig_jackTrait.png&quot;</span>, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">7</span>,<span class="at">device =</span> <span class="fu">png</span>(), <span class="at">units=</span><span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>); <span class="fu">dev.off</span>()</span>
<span id="cb66-35"><a href="#cb66-35"></a></span>
<span id="cb66-36"><a href="#cb66-36"></a><span class="co"># Please note that this figure is required to create the Fig 4a in the next script.</span></span></code></pre></div>
<div class="figure">
<img src="figs/fig_jackTrait.png" alt="" />
<p class="caption">No significant differences were observed for rainforest bird species across treatment types but the jacknife estimates of open-country bird species varied between BM-NR and BM-AR site pairs.</p>
</div>

</div>
</div>
<div id="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year" class="section level2 hasAnchor" number="0.15">
<h2><span class="header-section-number">0.15</span> Generalized linear mixed modeling (species richness, vegetation data and planting year)<a href="#generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this script, we run generalized linear mixed models to test the association between first order jacknife scores and restoration type. In addition, we run generalized linear mixed models to test associations between species richness and habitat (vegetation structure) using site-pair name (actively restored and naturally regenerating were specified to be paired) and repeat visits as random effects. Lastly, we assess associations between year since restoration began and first order jackknife scores of birds.</p>
<div id="install-required-libraries-8" class="section level3 hasAnchor" number="0.15.1">
<h3><span class="header-section-number">0.15.1</span> Install required libraries<a href="#install-required-libraries-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="fu">library</span>(vegan)</span>
<span id="cb67-5"><a href="#cb67-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb67-6"><a href="#cb67-6"></a><span class="fu">library</span>(scico)</span>
<span id="cb67-7"><a href="#cb67-7"></a><span class="fu">library</span>(psych)</span>
<span id="cb67-8"><a href="#cb67-8"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb67-9"><a href="#cb67-9"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb67-10"><a href="#cb67-10"></a><span class="fu">library</span>(lme4)</span>
<span id="cb67-11"><a href="#cb67-11"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb67-12"><a href="#cb67-12"></a></span>
<span id="cb67-13"><a href="#cb67-13"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb67-14"><a href="#cb67-14"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
<div id="load-the-necessary-data-for-statistical-modeling" class="section level3 hasAnchor" number="0.15.2">
<h3><span class="header-section-number">0.15.2</span> Load the necessary data for statistical modeling<a href="#load-the-necessary-data-for-statistical-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># We load the subset data</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>datSubset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/datSubset.csv&quot;</span>)</span>
<span id="cb68-3"><a href="#cb68-3"></a></span>
<span id="cb68-4"><a href="#cb68-4"></a><span class="co"># Load species-trait data to essentially check for associations by habitat type</span></span>
<span id="cb68-5"><a href="#cb68-5"></a>trait_dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/species-trait-dat.csv&quot;</span>)</span>
<span id="cb68-6"><a href="#cb68-6"></a></span>
<span id="cb68-7"><a href="#cb68-7"></a><span class="co"># richness by Visit</span></span>
<span id="cb68-8"><a href="#cb68-8"></a><span class="co"># this data basically gives you richness per visit and adds a visit number for each consecutive visit to that site</span></span>
<span id="cb68-9"><a href="#cb68-9"></a>richnessPerVisit <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="#cb68-10"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb68-11"><a href="#cb68-11"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-12"><a href="#cb68-12"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum) <span class="sc">%&gt;%</span> </span>
<span id="cb68-13"><a href="#cb68-13"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="sc">~</span> <span class="fu">replace</span>(., . <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-14"><a href="#cb68-14"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-15"><a href="#cb68-15"></a>  <span class="fu">mutate</span>(<span class="at">richness =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(IP<span class="sc">:</span>HSWP))) <span class="sc">%&gt;%</span></span>
<span id="cb68-16"><a href="#cb68-16"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb68-17"><a href="#cb68-17"></a>  <span class="fu">mutate</span>(<span class="at">visit =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb68-18"><a href="#cb68-18"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-19"><a href="#cb68-19"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode)) <span class="sc">%&gt;%</span></span>
<span id="cb68-20"><a href="#cb68-20"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Restoration.type, Date, richness, visit, siteCode)</span>
<span id="cb68-21"><a href="#cb68-21"></a></span>
<span id="cb68-22"><a href="#cb68-22"></a><span class="co"># combine the Detections dataframe with the trait dataset</span></span>
<span id="cb68-23"><a href="#cb68-23"></a>nDetectionsTrait <span class="ot">&lt;-</span> datSubset <span class="sc">%&gt;%</span></span>
<span id="cb68-24"><a href="#cb68-24"></a>  <span class="fu">group_by</span>(Site, Restoration.type, Date) <span class="sc">%&gt;%</span></span>
<span id="cb68-25"><a href="#cb68-25"></a>  <span class="fu">transform</span>() <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-26"><a href="#cb68-26"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(<span class="fu">c</span>(<span class="st">&quot;IP&quot;</span><span class="sc">:</span><span class="st">&quot;HSWP&quot;</span>)),<span class="at">.funs =</span> sum) <span class="sc">%&gt;%</span></span>
<span id="cb68-27"><a href="#cb68-27"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>IP<span class="sc">:</span>HSWP, <span class="at">names_to=</span><span class="st">&quot;Species_Code&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-28"><a href="#cb68-28"></a>  <span class="fu">left_join</span>(.,trait_dat, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Species_Code&quot;</span><span class="ot">=</span><span class="st">&quot;species_annotation_codes&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-29"><a href="#cb68-29"></a>  <span class="fu">mutate</span>(<span class="at">forRichness =</span> <span class="fu">case_when</span>(count<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>,count<span class="sc">==</span><span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-30"><a href="#cb68-30"></a>  <span class="fu">rename</span>(., <span class="at">nDetections =</span> count)</span>
<span id="cb68-31"><a href="#cb68-31"></a></span>
<span id="cb68-32"><a href="#cb68-32"></a><span class="co"># Load data from previous scripts for use in a GLM</span></span>
<span id="cb68-33"><a href="#cb68-33"></a>vegData <span class="ot">&lt;-</span>  <span class="fu">read.csv</span>(<span class="st">&quot;results/summaryVeg.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-34"><a href="#cb68-34"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(Site_ID, <span class="st">&#39;OLCAP5B&#39;</span>))</span>
<span id="cb68-35"><a href="#cb68-35"></a>vegPcaScores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/pcaVeg.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-36"><a href="#cb68-36"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(Site_ID, <span class="st">&#39;OLCAP5B&#39;</span>))</span>
<span id="cb68-37"><a href="#cb68-37"></a>jackAll <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/jackAll.csv&quot;</span>)</span>
<span id="cb68-38"><a href="#cb68-38"></a>jackRainforest <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/jackRainforest.csv&quot;</span>)</span>
<span id="cb68-39"><a href="#cb68-39"></a>jackOpencountry <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/jackOpencountry.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="getting-data-ready-in-a-format-for-generalized-linear-modeling" class="section level3 hasAnchor" number="0.15.3">
<h3><span class="header-section-number">0.15.3</span> Getting data ready in a format for generalized linear modeling<a href="#getting-data-ready-in-a-format-for-generalized-linear-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="co"># All birds</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>modelDataAll <span class="ot">&lt;-</span> vegPcaScores <span class="sc">%&gt;%</span>  </span>
<span id="cb69-3"><a href="#cb69-3"></a>  <span class="fu">rename</span>(<span class="at">Site =</span> Site_ID) <span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="#cb69-4"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb69-5"><a href="#cb69-5"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode)) <span class="sc">%&gt;%</span></span>
<span id="cb69-6"><a href="#cb69-6"></a>  <span class="fu">rename</span>(<span class="at">Restoration.type =</span> Site_type) <span class="sc">%&gt;%</span></span>
<span id="cb69-7"><a href="#cb69-7"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Restoration.type, factor))  <span class="sc">%&gt;%</span></span>
<span id="cb69-8"><a href="#cb69-8"></a>  <span class="fu">add_column</span>(<span class="at">jacknife =</span> jackAll<span class="sc">$</span>jack1,</span>
<span id="cb69-9"><a href="#cb69-9"></a>             <span class="at">year =</span> vegData<span class="sc">$</span>plantingYear) <span class="sc">%&gt;%</span> </span>
<span id="cb69-10"><a href="#cb69-10"></a>  <span class="fu">mutate</span> (<span class="st">&quot;roundjk&quot;</span> <span class="ot">=</span> <span class="fu">round</span>(jacknife))</span>
<span id="cb69-11"><a href="#cb69-11"></a></span>
<span id="cb69-12"><a href="#cb69-12"></a><span class="co"># rainforest birds</span></span>
<span id="cb69-13"><a href="#cb69-13"></a>modelData_rainForest <span class="ot">&lt;-</span> vegPcaScores <span class="sc">%&gt;%</span>  </span>
<span id="cb69-14"><a href="#cb69-14"></a>  <span class="fu">rename</span>(<span class="at">Site =</span> Site_ID) <span class="sc">%&gt;%</span></span>
<span id="cb69-15"><a href="#cb69-15"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb69-16"><a href="#cb69-16"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode)) <span class="sc">%&gt;%</span></span>
<span id="cb69-17"><a href="#cb69-17"></a>  <span class="fu">rename</span>(<span class="at">Restoration.type =</span> Site_type) <span class="sc">%&gt;%</span></span>
<span id="cb69-18"><a href="#cb69-18"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Restoration.type, factor))  <span class="sc">%&gt;%</span></span>
<span id="cb69-19"><a href="#cb69-19"></a>  <span class="fu">add_column</span>(<span class="at">jacknife =</span> jackRainforest<span class="sc">$</span>jack1,</span>
<span id="cb69-20"><a href="#cb69-20"></a>             <span class="at">year =</span> vegData<span class="sc">$</span>plantingYear) <span class="sc">%&gt;%</span> </span>
<span id="cb69-21"><a href="#cb69-21"></a>  <span class="fu">mutate</span> (<span class="st">&quot;roundjk&quot;</span> <span class="ot">=</span> <span class="fu">round</span>(jacknife))</span>
<span id="cb69-22"><a href="#cb69-22"></a></span>
<span id="cb69-23"><a href="#cb69-23"></a><span class="co"># open country birds</span></span>
<span id="cb69-24"><a href="#cb69-24"></a>modelData_openCountry <span class="ot">&lt;-</span> vegPcaScores <span class="sc">%&gt;%</span>  </span>
<span id="cb69-25"><a href="#cb69-25"></a>  <span class="fu">rename</span>(<span class="at">Site =</span> Site_ID) <span class="sc">%&gt;%</span></span>
<span id="cb69-26"><a href="#cb69-26"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb69-27"><a href="#cb69-27"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode)) <span class="sc">%&gt;%</span></span>
<span id="cb69-28"><a href="#cb69-28"></a>  <span class="fu">rename</span>(<span class="at">Restoration.type =</span> Site_type) <span class="sc">%&gt;%</span></span>
<span id="cb69-29"><a href="#cb69-29"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Restoration.type, factor))  <span class="sc">%&gt;%</span></span>
<span id="cb69-30"><a href="#cb69-30"></a>  <span class="fu">add_column</span>(<span class="at">jacknife =</span> jackOpencountry<span class="sc">$</span>jack1,</span>
<span id="cb69-31"><a href="#cb69-31"></a>             <span class="at">year =</span> vegData<span class="sc">$</span>plantingYear) <span class="sc">%&gt;%</span> </span>
<span id="cb69-32"><a href="#cb69-32"></a>  <span class="fu">mutate</span> (<span class="st">&quot;roundjk&quot;</span> <span class="ot">=</span> <span class="fu">round</span>(jacknife))</span></code></pre></div>
</div>
<div id="getting-data-ready-for-generalized-linear-mixed-modeling-with-richness-data-as-well-as-visits." class="section level3 hasAnchor" number="0.15.4">
<h3><span class="header-section-number">0.15.4</span> Getting data ready for generalized linear mixed modeling with richness data as well as visits.<a href="#getting-data-ready-for-generalized-linear-mixed-modeling-with-richness-data-as-well-as-visits." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="co"># data for the GLMM (overall richness)</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>glmmAll <span class="ot">&lt;-</span> richnessPerVisit[,<span class="sc">-</span><span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3"></a>  <span class="fu">full_join</span>(modelDataAll[,<span class="sc">-</span><span class="dv">8</span>], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;siteCode&quot;</span>))</span>
<span id="cb70-4"><a href="#cb70-4"></a></span>
<span id="cb70-5"><a href="#cb70-5"></a><span class="co"># rainforest birds richness for glmm</span></span>
<span id="cb70-6"><a href="#cb70-6"></a>glmmRainforest <span class="ot">&lt;-</span> nDetectionsTrait <span class="sc">%&gt;%</span></span>
<span id="cb70-7"><a href="#cb70-7"></a>  <span class="fu">group_by</span>(Site, Restoration.type, Date) <span class="sc">%&gt;%</span> </span>
<span id="cb70-8"><a href="#cb70-8"></a>  <span class="fu">filter</span> (habitat <span class="sc">==</span> <span class="st">&quot;RF&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-9"><a href="#cb70-9"></a>  <span class="fu">summarise</span>(<span class="at">richness =</span> <span class="fu">sum</span>(forRichness)) <span class="sc">%&gt;%</span></span>
<span id="cb70-10"><a href="#cb70-10"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb70-11"><a href="#cb70-11"></a>  <span class="fu">mutate</span>(<span class="at">visit =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb70-12"><a href="#cb70-12"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-13"><a href="#cb70-13"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode)) <span class="sc">%&gt;%</span></span>
<span id="cb70-14"><a href="#cb70-14"></a>  <span class="fu">full_join</span>(modelData_rainForest, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;siteCode&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>))</span>
<span id="cb70-15"><a href="#cb70-15"></a>  </span>
<span id="cb70-16"><a href="#cb70-16"></a><span class="co"># open-country birds</span></span>
<span id="cb70-17"><a href="#cb70-17"></a>glmmOpencountry <span class="ot">&lt;-</span> nDetectionsTrait <span class="sc">%&gt;%</span></span>
<span id="cb70-18"><a href="#cb70-18"></a>  <span class="fu">group_by</span>(Site, Restoration.type, Date) <span class="sc">%&gt;%</span> </span>
<span id="cb70-19"><a href="#cb70-19"></a>  <span class="fu">filter</span> (habitat <span class="sc">==</span> <span class="st">&quot;OC&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-20"><a href="#cb70-20"></a>  <span class="fu">summarise</span>(<span class="at">richness =</span> <span class="fu">sum</span>(forRichness)) <span class="sc">%&gt;%</span></span>
<span id="cb70-21"><a href="#cb70-21"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb70-22"><a href="#cb70-22"></a>  <span class="fu">mutate</span>(<span class="at">visit =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb70-23"><a href="#cb70-23"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-24"><a href="#cb70-24"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode)) <span class="sc">%&gt;%</span></span>
<span id="cb70-25"><a href="#cb70-25"></a>  <span class="fu">full_join</span>(modelData_openCountry, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;siteCode&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>))</span>
<span id="cb70-26"><a href="#cb70-26"></a></span>
<span id="cb70-27"><a href="#cb70-27"></a><span class="co"># Let&#39;s look at species by foraging habit</span></span>
<span id="cb70-28"><a href="#cb70-28"></a><span class="co"># canopy birds</span></span>
<span id="cb70-29"><a href="#cb70-29"></a>glmmCanopy <span class="ot">&lt;-</span> nDetectionsTrait <span class="sc">%&gt;%</span></span>
<span id="cb70-30"><a href="#cb70-30"></a>  <span class="fu">group_by</span>(Site, Restoration.type, Date) <span class="sc">%&gt;%</span> </span>
<span id="cb70-31"><a href="#cb70-31"></a>  <span class="fu">filter</span> (habit <span class="sc">==</span> <span class="st">&quot;CAN&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-32"><a href="#cb70-32"></a>  <span class="fu">summarise</span>(<span class="at">richness =</span> <span class="fu">sum</span>(forRichness)) <span class="sc">%&gt;%</span></span>
<span id="cb70-33"><a href="#cb70-33"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb70-34"><a href="#cb70-34"></a>  <span class="fu">mutate</span>(<span class="at">visit =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb70-35"><a href="#cb70-35"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-36"><a href="#cb70-36"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode)) <span class="sc">%&gt;%</span></span>
<span id="cb70-37"><a href="#cb70-37"></a>  <span class="fu">full_join</span>(modelDataAll[,<span class="sc">-</span><span class="dv">8</span>], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;siteCode&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>))</span>
<span id="cb70-38"><a href="#cb70-38"></a>  </span>
<span id="cb70-39"><a href="#cb70-39"></a><span class="co"># ground-feeding birds</span></span>
<span id="cb70-40"><a href="#cb70-40"></a>glmmGround <span class="ot">&lt;-</span> nDetectionsTrait <span class="sc">%&gt;%</span></span>
<span id="cb70-41"><a href="#cb70-41"></a>  <span class="fu">group_by</span>(Site, Restoration.type, Date) <span class="sc">%&gt;%</span> </span>
<span id="cb70-42"><a href="#cb70-42"></a>  <span class="fu">filter</span> (habit <span class="sc">==</span> <span class="st">&quot;GRD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-43"><a href="#cb70-43"></a>  <span class="fu">summarise</span>(<span class="at">richness =</span> <span class="fu">sum</span>(forRichness)) <span class="sc">%&gt;%</span></span>
<span id="cb70-44"><a href="#cb70-44"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb70-45"><a href="#cb70-45"></a>  <span class="fu">mutate</span>(<span class="at">visit =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb70-46"><a href="#cb70-46"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-47"><a href="#cb70-47"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode)) <span class="sc">%&gt;%</span></span>
<span id="cb70-48"><a href="#cb70-48"></a>  <span class="fu">full_join</span>(modelDataAll[,<span class="sc">-</span><span class="dv">8</span>], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;siteCode&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>))</span>
<span id="cb70-49"><a href="#cb70-49"></a></span>
<span id="cb70-50"><a href="#cb70-50"></a><span class="co"># mid-storey birds</span></span>
<span id="cb70-51"><a href="#cb70-51"></a>glmmMidStorey <span class="ot">&lt;-</span> nDetectionsTrait <span class="sc">%&gt;%</span></span>
<span id="cb70-52"><a href="#cb70-52"></a>  <span class="fu">group_by</span>(Site, Restoration.type, Date) <span class="sc">%&gt;%</span> </span>
<span id="cb70-53"><a href="#cb70-53"></a>  <span class="fu">filter</span> (habit <span class="sc">==</span> <span class="st">&quot;MID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-54"><a href="#cb70-54"></a>  <span class="fu">summarise</span>(<span class="at">richness =</span> <span class="fu">sum</span>(forRichness)) <span class="sc">%&gt;%</span></span>
<span id="cb70-55"><a href="#cb70-55"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb70-56"><a href="#cb70-56"></a>  <span class="fu">mutate</span>(<span class="at">visit =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb70-57"><a href="#cb70-57"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-58"><a href="#cb70-58"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode)) <span class="sc">%&gt;%</span></span>
<span id="cb70-59"><a href="#cb70-59"></a>  <span class="fu">full_join</span>(modelDataAll[,<span class="sc">-</span><span class="dv">8</span>], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;siteCode&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>))</span>
<span id="cb70-60"><a href="#cb70-60"></a></span>
<span id="cb70-61"><a href="#cb70-61"></a><span class="co"># understorey birds</span></span>
<span id="cb70-62"><a href="#cb70-62"></a>glmmUnderStory <span class="ot">&lt;-</span> nDetectionsTrait <span class="sc">%&gt;%</span></span>
<span id="cb70-63"><a href="#cb70-63"></a>  <span class="fu">group_by</span>(Site, Restoration.type, Date) <span class="sc">%&gt;%</span> </span>
<span id="cb70-64"><a href="#cb70-64"></a>  <span class="fu">filter</span> (habit <span class="sc">==</span> <span class="st">&quot;UND&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-65"><a href="#cb70-65"></a>  <span class="fu">summarise</span>(<span class="at">richness =</span> <span class="fu">sum</span>(forRichness)) <span class="sc">%&gt;%</span></span>
<span id="cb70-66"><a href="#cb70-66"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb70-67"><a href="#cb70-67"></a>  <span class="fu">mutate</span>(<span class="at">visit =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb70-68"><a href="#cb70-68"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-69"><a href="#cb70-69"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode)) <span class="sc">%&gt;%</span></span>
<span id="cb70-70"><a href="#cb70-70"></a>  <span class="fu">full_join</span>(modelDataAll[,<span class="sc">-</span><span class="dv">8</span>], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;siteCode&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>))</span></code></pre></div>
</div>
<div id="running-the-generalized-linear-mixed-models-1" class="section level3 hasAnchor" number="0.15.5">
<h3><span class="header-section-number">0.15.5</span> Running the generalized linear mixed models<a href="#running-the-generalized-linear-mixed-models-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We now run generalized linear mixed models (GLMM) assuming Poisson errors and using log link functions to examine the effects of restoration type (benchmark, actively restored and passively restored) on the jackknife estimates of bird species richness (for all, rainforest, and open-country species), followed by TukeyHSD multiple comparisons tests of means.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># all birds</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>glmm_alljk <span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundjk <span class="sc">~</span> Restoration.type <span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>siteCode), <span class="at">data =</span> modelDataAll, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb71-3"><a href="#cb71-3"></a><span class="fu">summary</span>(glmm_alljk)</span>
<span id="cb71-4"><a href="#cb71-4"></a></span>
<span id="cb71-5"><a href="#cb71-5"></a>tukey_glmmAllJack <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">glht</span>(glmm_alljk, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Restoration.type =</span><span class="st">&quot;Tukey&quot;</span>)))</span>
<span id="cb71-6"><a href="#cb71-6"></a><span class="fu">cld</span>(tukey_glmmAllJack)</span>
<span id="cb71-7"><a href="#cb71-7"></a></span>
<span id="cb71-8"><a href="#cb71-8"></a><span class="co"># The above result suggests that there is a significant difference in first order jacknife estimates for benchmark sites and passively restored site (but no difference between active-passive and active-benchmark).</span></span>
<span id="cb71-9"><a href="#cb71-9"></a></span>
<span id="cb71-10"><a href="#cb71-10"></a><span class="co"># rainforest birds</span></span>
<span id="cb71-11"><a href="#cb71-11"></a>glmm_rainForestJack <span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundjk <span class="sc">~</span> Restoration.type <span class="sc">+</span> <span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>siteCode), <span class="at">data =</span> modelData_rainForest, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb71-12"><a href="#cb71-12"></a><span class="fu">summary</span>(glmm_rainForestJack)</span>
<span id="cb71-13"><a href="#cb71-13"></a></span>
<span id="cb71-14"><a href="#cb71-14"></a>tukey_glmmRainForestJack <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">glht</span>(glmm_rainForestJack, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Restoration.type =</span><span class="st">&quot;Tukey&quot;</span>)))</span>
<span id="cb71-15"><a href="#cb71-15"></a><span class="fu">cld</span>(tukey_glmmRainForestJack)</span>
<span id="cb71-16"><a href="#cb71-16"></a></span>
<span id="cb71-17"><a href="#cb71-17"></a><span class="co"># The above result suggests no significant difference in means between any treatment types</span></span>
<span id="cb71-18"><a href="#cb71-18"></a></span>
<span id="cb71-19"><a href="#cb71-19"></a><span class="co"># open country birds</span></span>
<span id="cb71-20"><a href="#cb71-20"></a>glmm_openCountryJack <span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundjk <span class="sc">~</span> Restoration.type <span class="sc">+</span> <span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>siteCode), <span class="at">data =</span> modelData_openCountry, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb71-21"><a href="#cb71-21"></a><span class="fu">summary</span>(glmm_openCountryJack)</span>
<span id="cb71-22"><a href="#cb71-22"></a></span>
<span id="cb71-23"><a href="#cb71-23"></a>tukey_glmmOpenCountryJack <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">glht</span>(glmm_openCountryJack, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Restoration.type =</span><span class="st">&quot;Tukey&quot;</span>)))</span>
<span id="cb71-24"><a href="#cb71-24"></a><span class="fu">cld</span>(tukey_glmmOpenCountryJack)</span>
<span id="cb71-25"><a href="#cb71-25"></a></span>
<span id="cb71-26"><a href="#cb71-26"></a><span class="co"># For open country birds, there is a significant difference in first-order jacknife estimates between benchmark and passive sites and benchmark and active sites</span></span></code></pre></div>
</div>
<div id="testing-the-role-of-habitat" class="section level3 hasAnchor" number="0.15.6">
<h3><span class="header-section-number">0.15.6</span> Testing the role of habitat<a href="#testing-the-role-of-habitat" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Testing the role of habitat (vegetation structure) and foraging habit on species richness within a generalized linear modeling framework</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="co"># Testing the role of habitat first</span></span>
<span id="cb72-2"><a href="#cb72-2"></a></span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="co"># all bird species</span></span>
<span id="cb72-4"><a href="#cb72-4"></a>glmm_allBirds <span class="ot">&lt;-</span> <span class="fu">glmer</span>(richness <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> glmmAll, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb72-5"><a href="#cb72-5"></a><span class="fu">summary</span>(glmm_allBirds)</span>
<span id="cb72-6"><a href="#cb72-6"></a></span>
<span id="cb72-7"><a href="#cb72-7"></a><span class="fu">plot_model</span>(glmm_allBirds, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>,<span class="st">&quot;PC2&quot;</span>))</span>
<span id="cb72-8"><a href="#cb72-8"></a>report<span class="sc">::</span><span class="fu">report</span>(glmm_allBirds)</span>
<span id="cb72-9"><a href="#cb72-9"></a></span>
<span id="cb72-10"><a href="#cb72-10"></a><span class="co"># significant negative association with PC2</span></span>
<span id="cb72-11"><a href="#cb72-11"></a></span>
<span id="cb72-12"><a href="#cb72-12"></a><span class="co"># rainforest birds</span></span>
<span id="cb72-13"><a href="#cb72-13"></a>glmm_Rainforest <span class="ot">&lt;-</span> <span class="fu">glmer</span>(richness <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> glmmRainforest, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb72-14"><a href="#cb72-14"></a><span class="fu">summary</span>(glmm_Rainforest)</span>
<span id="cb72-15"><a href="#cb72-15"></a></span>
<span id="cb72-16"><a href="#cb72-16"></a><span class="fu">plot_model</span>(glmm_Rainforest, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>,<span class="st">&quot;PC2&quot;</span>))</span>
<span id="cb72-17"><a href="#cb72-17"></a>report<span class="sc">::</span><span class="fu">report</span>(glmm_Rainforest)</span>
<span id="cb72-18"><a href="#cb72-18"></a></span>
<span id="cb72-19"><a href="#cb72-19"></a><span class="co"># Results above suggest PC2 is significantly negatively associated with richness of rainforest birds. </span></span>
<span id="cb72-20"><a href="#cb72-20"></a></span>
<span id="cb72-21"><a href="#cb72-21"></a>glmm_openCountry <span class="ot">&lt;-</span> <span class="fu">glmer</span>(richness <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> glmmOpencountry, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb72-22"><a href="#cb72-22"></a><span class="fu">summary</span>(glmm_openCountry)</span>
<span id="cb72-23"><a href="#cb72-23"></a></span>
<span id="cb72-24"><a href="#cb72-24"></a><span class="fu">plot_model</span>(glmm_openCountry, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>,<span class="st">&quot;PC2&quot;</span>))</span>
<span id="cb72-25"><a href="#cb72-25"></a>report<span class="sc">::</span><span class="fu">report</span>(glmm_openCountry)</span>
<span id="cb72-26"><a href="#cb72-26"></a></span>
<span id="cb72-27"><a href="#cb72-27"></a><span class="co"># statistically significant positive association with PC1 and significant negative association with PC2</span></span>
<span id="cb72-28"><a href="#cb72-28"></a></span>
<span id="cb72-29"><a href="#cb72-29"></a><span class="co"># Testing the role of foraging habit</span></span>
<span id="cb72-30"><a href="#cb72-30"></a></span>
<span id="cb72-31"><a href="#cb72-31"></a><span class="co"># canopy birds (no significant association)</span></span>
<span id="cb72-32"><a href="#cb72-32"></a>glmm_Canopy <span class="ot">&lt;-</span> <span class="fu">glmer</span>(richness <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> glmmCanopy, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb72-33"><a href="#cb72-33"></a><span class="fu">summary</span>(glmm_Canopy)</span>
<span id="cb72-34"><a href="#cb72-34"></a></span>
<span id="cb72-35"><a href="#cb72-35"></a><span class="co"># ground-feeding birds (Marginal association between richness of ground-feeding birds and PC2)</span></span>
<span id="cb72-36"><a href="#cb72-36"></a>glmm_Ground <span class="ot">&lt;-</span> <span class="fu">glmer</span>(richness <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> glmmGround, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb72-37"><a href="#cb72-37"></a><span class="fu">summary</span>(glmm_Ground)</span>
<span id="cb72-38"><a href="#cb72-38"></a></span>
<span id="cb72-39"><a href="#cb72-39"></a><span class="co"># mid-storey birds (Marginal association between PC1 and richness of mid-storey birds)</span></span>
<span id="cb72-40"><a href="#cb72-40"></a>glmm_MidStorey <span class="ot">&lt;-</span> <span class="fu">glmer</span>(richness <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> glmmMidStorey, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb72-41"><a href="#cb72-41"></a><span class="fu">summary</span>(glmm_MidStorey)</span>
<span id="cb72-42"><a href="#cb72-42"></a></span>
<span id="cb72-43"><a href="#cb72-43"></a><span class="co"># understory birds (no significant association)</span></span>
<span id="cb72-44"><a href="#cb72-44"></a>glmm_Understory <span class="ot">&lt;-</span> <span class="fu">glmer</span>(richness <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> glmmUnderStory, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb72-45"><a href="#cb72-45"></a><span class="fu">summary</span>(glmm_Understory)</span></code></pre></div>
</div>
<div id="effect-of-planting-year" class="section level3 hasAnchor" number="0.15.7">
<h3><span class="header-section-number">0.15.7</span> Effect of planting year<a href="#effect-of-planting-year" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lastly, running a generalized linear model to test the effect of year since restoration on jacknife estimates of species richness</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># Let&#39;s look at overall species richness first</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="co"># filter only data for restored sites</span></span>
<span id="cb73-3"><a href="#cb73-3"></a>allRestored <span class="ot">&lt;-</span> glmmAll <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4"></a>  <span class="fu">filter</span>(Restoration.type<span class="sc">==</span><span class="st">&quot;Active&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-5"><a href="#cb73-5"></a>  <span class="fu">mutate</span>(<span class="at">yearSinceRestoration =</span> (<span class="dv">2022</span><span class="sc">-</span>year))</span>
<span id="cb73-6"><a href="#cb73-6"></a></span>
<span id="cb73-7"><a href="#cb73-7"></a>glmmAllRest <span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundjk <span class="sc">~</span> yearSinceRestoration <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> allRestored, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb73-8"><a href="#cb73-8"></a><span class="fu">summary</span>(glmmAllRest)</span>
<span id="cb73-9"><a href="#cb73-9"></a></span>
<span id="cb73-10"><a href="#cb73-10"></a><span class="fu">plot_model</span>(glmmAllRest, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>)</span>
<span id="cb73-11"><a href="#cb73-11"></a>report<span class="sc">::</span><span class="fu">report</span>(glmmAllRest)</span>
<span id="cb73-12"><a href="#cb73-12"></a></span>
<span id="cb73-13"><a href="#cb73-13"></a><span class="co"># no significant association for overall richness</span></span>
<span id="cb73-14"><a href="#cb73-14"></a></span>
<span id="cb73-15"><a href="#cb73-15"></a><span class="co"># rainforest bird richness</span></span>
<span id="cb73-16"><a href="#cb73-16"></a>rainRestored <span class="ot">&lt;-</span> glmmRainforest <span class="sc">%&gt;%</span></span>
<span id="cb73-17"><a href="#cb73-17"></a>  <span class="fu">filter</span>(Restoration.type<span class="sc">==</span><span class="st">&quot;Active&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-18"><a href="#cb73-18"></a>  <span class="fu">mutate</span>(<span class="at">yearSinceRestoration =</span> (<span class="dv">2022</span><span class="sc">-</span>year))</span>
<span id="cb73-19"><a href="#cb73-19"></a></span>
<span id="cb73-20"><a href="#cb73-20"></a>glmmRain <span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundjk <span class="sc">~</span> yearSinceRestoration <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> rainRestored, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb73-21"><a href="#cb73-21"></a><span class="fu">summary</span>(glmmRain)</span>
<span id="cb73-22"><a href="#cb73-22"></a></span>
<span id="cb73-23"><a href="#cb73-23"></a><span class="fu">plot_model</span>(glmmRain, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>)</span>
<span id="cb73-24"><a href="#cb73-24"></a>report<span class="sc">::</span><span class="fu">report</span>(glmmRain)</span>
<span id="cb73-25"><a href="#cb73-25"></a></span>
<span id="cb73-26"><a href="#cb73-26"></a><span class="co"># no significant association for rainforest bird species richness</span></span>
<span id="cb73-27"><a href="#cb73-27"></a></span>
<span id="cb73-28"><a href="#cb73-28"></a><span class="co"># open-country richness</span></span>
<span id="cb73-29"><a href="#cb73-29"></a>openRestored <span class="ot">&lt;-</span> glmmOpencountry <span class="sc">%&gt;%</span></span>
<span id="cb73-30"><a href="#cb73-30"></a>  <span class="fu">filter</span>(Restoration.type<span class="sc">==</span><span class="st">&quot;Active&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-31"><a href="#cb73-31"></a>  <span class="fu">mutate</span>(<span class="at">yearSinceRestoration =</span> (<span class="dv">2022</span><span class="sc">-</span>year))</span>
<span id="cb73-32"><a href="#cb73-32"></a></span>
<span id="cb73-33"><a href="#cb73-33"></a>glmmOpen <span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundjk <span class="sc">~</span> yearSinceRestoration <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> openRestored, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> log))</span>
<span id="cb73-34"><a href="#cb73-34"></a><span class="fu">summary</span>(glmmOpen)</span>
<span id="cb73-35"><a href="#cb73-35"></a></span>
<span id="cb73-36"><a href="#cb73-36"></a><span class="fu">plot_model</span>(glmmOpen, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>)</span>
<span id="cb73-37"><a href="#cb73-37"></a>report<span class="sc">::</span><span class="fu">report</span>(glmmOpen)</span>
<span id="cb73-38"><a href="#cb73-38"></a></span>
<span id="cb73-39"><a href="#cb73-39"></a><span class="co"># The effect of yearSinceRestoration is statistically significant and positive for open country birds (beta = 0.02, 95% CI [4.05e-03, 0.04], p = 0.016; Std. beta = 0.06, 95% CI [0.01, 0.11])</span></span></code></pre></div>

</div>
</div>
<div id="generalized-linear-mixed-modeling-species-proportions-vegetation-data-and-planting-year" class="section level2 hasAnchor" number="0.16">
<h2><span class="header-section-number">0.16</span> Generalized linear mixed modeling (species proportions, vegetation data and planting year)<a href="#generalized-linear-mixed-modeling-species-proportions-vegetation-data-and-planting-year" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this script, we run generalized linear mixed models to test the association between bird species proportions (rainforest and open-country species) and restoration type. In addition, we run generalized linear mixed models to test associations between species proportions and habitat (vegetation structure) using site-pair name (actively restored and naturally regenerating were specified to be paired) and repeat visits as random effects. Lastly, we assess associations between year since restoration began and bird species proportions.</p>
<div id="install-required-libraries-9" class="section level3 hasAnchor" number="0.16.1">
<h3><span class="header-section-number">0.16.1</span> Install required libraries<a href="#install-required-libraries-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb74"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb74-3"><a href="#cb74-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb74-4"><a href="#cb74-4"></a><span class="fu">library</span>(vegan)</span>
<span id="cb74-5"><a href="#cb74-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb74-6"><a href="#cb74-6"></a><span class="fu">library</span>(scico)</span>
<span id="cb74-7"><a href="#cb74-7"></a><span class="fu">library</span>(psych)</span>
<span id="cb74-8"><a href="#cb74-8"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb74-9"><a href="#cb74-9"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb74-10"><a href="#cb74-10"></a><span class="fu">library</span>(lme4)</span>
<span id="cb74-11"><a href="#cb74-11"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb74-12"><a href="#cb74-12"></a></span>
<span id="cb74-13"><a href="#cb74-13"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb74-14"><a href="#cb74-14"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
<div id="load-the-necessary-data-for-statistical-modeling-1" class="section level3 hasAnchor" number="0.16.2">
<h3><span class="header-section-number">0.16.2</span> Load the necessary data for statistical modeling<a href="#load-the-necessary-data-for-statistical-modeling-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co"># Load data from previous scripts</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>vegData <span class="ot">&lt;-</span>  <span class="fu">read.csv</span>(<span class="st">&quot;results/summaryVeg.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(Site_ID, <span class="st">&#39;OLCAP5B&#39;</span>))</span>
<span id="cb75-4"><a href="#cb75-4"></a>vegPcaScores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/pcaVeg.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-5"><a href="#cb75-5"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(Site_ID, <span class="st">&#39;OLCAP5B&#39;</span>))</span>
<span id="cb75-6"><a href="#cb75-6"></a>propVisit <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/acoustic-detections-across-visits.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="getting-data-ready-in-a-format-for-generalized-linear-mixed-modeling" class="section level3 hasAnchor" number="0.16.3">
<h3><span class="header-section-number">0.16.3</span> Getting data ready in a format for generalized linear mixed modeling<a href="#getting-data-ready-in-a-format-for-generalized-linear-mixed-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="co"># prep veg data</span></span>
<span id="cb76-2"><a href="#cb76-2"></a>prepVegData <span class="ot">&lt;-</span> vegPcaScores <span class="sc">%&gt;%</span>  </span>
<span id="cb76-3"><a href="#cb76-3"></a>  <span class="fu">rename</span>(<span class="at">Site =</span> Site_ID) <span class="sc">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb76-5"><a href="#cb76-5"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode)) <span class="sc">%&gt;%</span></span>
<span id="cb76-6"><a href="#cb76-6"></a>  <span class="fu">rename</span>(<span class="at">Restoration.type =</span> Site_type) <span class="sc">%&gt;%</span></span>
<span id="cb76-7"><a href="#cb76-7"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Restoration.type, factor))  </span>
<span id="cb76-8"><a href="#cb76-8"></a></span>
<span id="cb76-9"><a href="#cb76-9"></a><span class="co"># prep bird species proportions</span></span>
<span id="cb76-10"><a href="#cb76-10"></a>prepBirdData <span class="ot">&lt;-</span> propVisit <span class="sc">%&gt;%</span></span>
<span id="cb76-11"><a href="#cb76-11"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb76-12"><a href="#cb76-12"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb76-13"><a href="#cb76-13"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb76-14"><a href="#cb76-14"></a>  <span class="fu">mutate</span>(<span class="at">visit =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb76-15"><a href="#cb76-15"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb76-16"><a href="#cb76-16"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode))</span>
<span id="cb76-17"><a href="#cb76-17"></a></span>
<span id="cb76-18"><a href="#cb76-18"></a><span class="co"># join the above two dataframes</span></span>
<span id="cb76-19"><a href="#cb76-19"></a>modelData <span class="ot">&lt;-</span> prepBirdData <span class="sc">%&gt;%</span></span>
<span id="cb76-20"><a href="#cb76-20"></a>  <span class="fu">full_join</span>(prepVegData, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;siteCode&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>))</span></code></pre></div>
</div>
<div id="running-the-generalized-linear-mixed-models-2" class="section level3 hasAnchor" number="0.16.4">
<h3><span class="header-section-number">0.16.4</span> Running the generalized linear mixed models<a href="#running-the-generalized-linear-mixed-models-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We now run generalized linear mixed models (GLMM) assuming gaussian errors to examine the effects of restoration type (benchmark, actively restored and passively restored) on the proportion of bird species detections (for rainforest and open-country species), followed by TukeyHSD multiple comparisons tests of means.</p>
</div>
<div id="examining-effect-of-restoration-type-on-proportion-of-rainforest-and-open-country-species-detections" class="section level3 hasAnchor" number="0.16.5">
<h3><span class="header-section-number">0.16.5</span> Examining effect of restoration type on proportion of rainforest and open-country species detections<a href="#examining-effect-of-restoration-type-on-proportion-of-rainforest-and-open-country-species-detections" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="rainforest-bird-species" class="section level4 hasAnchor" number="0.16.5.1">
<h4><span class="header-section-number">0.16.5.1</span> Rainforest bird species<a href="#rainforest-bird-species" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb77"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>glmm_rainForestProp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(propRF <span class="sc">~</span> Restoration.type <span class="sc">+</span> <span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> modelData, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="fu">summary</span>(glmm_rainForestProp)</span>
<span id="cb77-3"><a href="#cb77-3"></a></span>
<span id="cb77-4"><a href="#cb77-4"></a>tukey_glmmRainForestProp <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">glht</span>(glmm_rainForestProp, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Restoration.type =</span><span class="st">&quot;Tukey&quot;</span>)))</span>
<span id="cb77-5"><a href="#cb77-5"></a><span class="fu">cld</span>(tukey_glmmRainForestProp)</span>
<span id="cb77-6"><a href="#cb77-6"></a>report<span class="sc">::</span><span class="fu">report</span>(glmm_rainForestProp)</span>
<span id="cb77-7"><a href="#cb77-7"></a></span>
<span id="cb77-8"><a href="#cb77-8"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict propRF with Restoration.type (formula: propRF ~ Restoration.type). The model included siteCode and visit as random effects (formula: list(~1 | siteCode, ~1 | visit)). The model&#39;s total explanatory power is substantial (conditional R2 = 0.52) and the part related to the fixed effects alone (marginal R2) is of 0.37. The model&#39;s intercept, corresponding to Restoration.type = Active, is at 0.77 (95% CI [0.73, 0.82], t(251) = 35.87, p &lt; .001). Within this model:</span></span>
<span id="cb77-9"><a href="#cb77-9"></a></span>
<span id="cb77-10"><a href="#cb77-10"></a><span class="co">#  - The effect of Restoration type [Benchmark] is statistically significant and positive (beta = 0.14, 95% CI [0.10, 0.17], t(251) = 8.51, p &lt; .001; Std. beta = 1.06, 95% CI [0.82, 1.31])</span></span>
<span id="cb77-11"><a href="#cb77-11"></a><span class="co">#  - The effect of Restoration type [Passive] is statistically significant and negative (beta = -0.05, 95% CI [-0.07, -0.02], t(251) = -3.19, p = 0.002; Std. beta = -0.36, 95% CI [-0.58, -0.14])</span></span></code></pre></div>
</div>
<div id="open-country-species" class="section level4 hasAnchor" number="0.16.5.2">
<h4><span class="header-section-number">0.16.5.2</span> Open-country species<a href="#open-country-species" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb78"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>glmm_openCountryProp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(propOC <span class="sc">~</span> Restoration.type <span class="sc">+</span> <span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> modelData, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="fu">summary</span>(glmm_openCountryProp)</span>
<span id="cb78-3"><a href="#cb78-3"></a></span>
<span id="cb78-4"><a href="#cb78-4"></a>tukey_glmmOpenCountryProp <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">glht</span>(glmm_openCountryProp, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Restoration.type =</span><span class="st">&quot;Tukey&quot;</span>)))</span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="fu">cld</span>(tukey_glmmOpenCountryProp)</span>
<span id="cb78-6"><a href="#cb78-6"></a>report<span class="sc">::</span><span class="fu">report</span>(glmm_openCountryProp)</span>
<span id="cb78-7"><a href="#cb78-7"></a></span>
<span id="cb78-8"><a href="#cb78-8"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict propOC with Restoration.type (formula: propOC ~ Restoration.type). The model included siteCode and visit as random effects (formula: list(~1 | siteCode, ~1 | visit)). The model&#39;s total explanatory power is substantial (conditional R2 = 0.52) and the part related to the fixed effects alone (marginal R2) is of 0.37. The model&#39;s intercept, corresponding to Restoration.type = Active, is at 0.23 (95% CI [0.18, 0.27], t(251) = 10.44, p &lt; .001). Within this model:</span></span>
<span id="cb78-9"><a href="#cb78-9"></a></span>
<span id="cb78-10"><a href="#cb78-10"></a><span class="co">#  - The effect of Restoration type [Benchmark] is statistically significant and negative (beta = -0.14, 95% CI [-0.17, -0.10], t(251) = -8.51, p &lt; .001; Std. beta = -1.06, 95% CI [-1.31, -0.82])</span></span>
<span id="cb78-11"><a href="#cb78-11"></a><span class="co">#  - The effect of Restoration type [Passive] is statistically significant and positive (beta = 0.05, 95% CI [0.02, 0.07], t(251) = 3.19, p = 0.002; Std. beta = 0.36, 95% CI [0.14, 0.58])</span></span></code></pre></div>
</div>
</div>
<div id="testing-the-role-of-habitat-1" class="section level3 hasAnchor" number="0.16.6">
<h3><span class="header-section-number">0.16.6</span> Testing the role of habitat<a href="#testing-the-role-of-habitat-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Testing the role of habitat (vegetation structure) and on species proportions within a generalized linear modeling framework</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co"># rainforest birds</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>glmm_Rainforest <span class="ot">&lt;-</span> <span class="fu">glmer</span>(propRF <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> modelData, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="fu">summary</span>(glmm_Rainforest)</span>
<span id="cb79-4"><a href="#cb79-4"></a></span>
<span id="cb79-5"><a href="#cb79-5"></a><span class="fu">plot_model</span>(glmm_Rainforest, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>,<span class="st">&quot;PC2&quot;</span>))</span>
<span id="cb79-6"><a href="#cb79-6"></a>report<span class="sc">::</span><span class="fu">report</span>(glmm_Rainforest)</span>
<span id="cb79-7"><a href="#cb79-7"></a></span>
<span id="cb79-8"><a href="#cb79-8"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict propRF with PC1 and PC2 (formula: propRF ~ PC1 + PC2). The model included siteCode and visit as random effects (formula: list(~1 | siteCode, ~1 | visit)). The model&#39;s total explanatory power is substantial (conditional R2 = 0.48) and the part related to the fixed effects alone (marginal R2) is of 0.20. The model&#39;s intercept, corresponding to PC1 = 0 and PC2 = 0, is at 0.82 (95% CI [0.78, 0.86], t(251) = 38.90, p &lt; .001). Within this model:</span></span>
<span id="cb79-9"><a href="#cb79-9"></a></span>
<span id="cb79-10"><a href="#cb79-10"></a><span class="co">#  - The effect of PC1 is statistically significant and negative (beta = -0.03, 95% CI [-0.04, -0.02], t(251) = -6.51, p &lt; .001; Std. beta = -0.43, 95% CI [-0.55, -0.30])</span></span>
<span id="cb79-11"><a href="#cb79-11"></a><span class="co">#  - The effect of PC2 is statistically non-significant and positive (beta = 0.01, 95% CI [-2.25e-03, 0.03], t(251) = 1.67, p = 0.096; Std. beta = 0.11, 95% CI [-0.02, 0.24])</span></span>
<span id="cb79-12"><a href="#cb79-12"></a></span>
<span id="cb79-13"><a href="#cb79-13"></a><span class="co"># open-country birds</span></span>
<span id="cb79-14"><a href="#cb79-14"></a>glmm_openCountry <span class="ot">&lt;-</span> <span class="fu">glmer</span>(propOC <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> modelData, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb79-15"><a href="#cb79-15"></a><span class="fu">summary</span>(glmm_openCountry)</span>
<span id="cb79-16"><a href="#cb79-16"></a></span>
<span id="cb79-17"><a href="#cb79-17"></a><span class="fu">plot_model</span>(glmm_openCountry, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>,<span class="st">&quot;PC2&quot;</span>))</span>
<span id="cb79-18"><a href="#cb79-18"></a>report<span class="sc">::</span><span class="fu">report</span>(glmm_openCountry)</span>
<span id="cb79-19"><a href="#cb79-19"></a></span>
<span id="cb79-20"><a href="#cb79-20"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict propOC with PC1 and PC2 (formula: propOC ~ PC1 + PC2). The model included siteCode and visit as random effects (formula: list(~1 | siteCode, ~1 | visit)). The model&#39;s total explanatory power is substantial (conditional R2 = 0.48) and the part related to the fixed effects alone (marginal R2) is of 0.20. The model&#39;s intercept, corresponding to PC1 = 0 and PC2 = 0, is at 0.18 (95% CI [0.14, 0.22], t(251) = 8.57, p &lt; .001). Within this model:</span></span>
<span id="cb79-21"><a href="#cb79-21"></a></span>
<span id="cb79-22"><a href="#cb79-22"></a><span class="co">#  - The effect of PC1 is statistically significant and positive (beta = 0.03, 95% CI [0.02, 0.04], t(251) = 6.51, p &lt; .001; Std. beta = 0.43, 95% CI [0.30, 0.55])</span></span>
<span id="cb79-23"><a href="#cb79-23"></a><span class="co">#  - The effect of PC2 is statistically non-significant and negative (beta = -0.01, 95% CI [-0.03, 2.25e-03], t(251) = -1.67, p = 0.096; Std. beta = -0.11, 95% CI [-0.24, 0.02])</span></span></code></pre></div>
</div>
<div id="effect-of-planting-year-1" class="section level3 hasAnchor" number="0.16.7">
<h3><span class="header-section-number">0.16.7</span> Effect of planting year<a href="#effect-of-planting-year-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lastly, running a generalized linear model to test the effect of year since restoration on bird species proportions</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="co"># add planting Year</span></span>
<span id="cb80-2"><a href="#cb80-2"></a>allRestored <span class="ot">&lt;-</span> modelData <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3"></a>  <span class="fu">left_join</span>(vegData[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>)], <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span><span class="ot">=</span><span class="st">&quot;Site_ID&quot;</span>))</span>
<span id="cb80-4"><a href="#cb80-4"></a></span>
<span id="cb80-5"><a href="#cb80-5"></a><span class="co"># filter only data for restored sites</span></span>
<span id="cb80-6"><a href="#cb80-6"></a>allRestored <span class="ot">&lt;-</span> allRestored <span class="sc">%&gt;%</span></span>
<span id="cb80-7"><a href="#cb80-7"></a>  <span class="fu">filter</span>(Restoration.type<span class="sc">==</span><span class="st">&quot;Active&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-8"><a href="#cb80-8"></a>  <span class="fu">mutate</span>(<span class="at">yearSinceRestoration =</span> (<span class="dv">2022</span><span class="sc">-</span>plantingYear))</span>
<span id="cb80-9"><a href="#cb80-9"></a></span>
<span id="cb80-10"><a href="#cb80-10"></a><span class="co"># rainforest birds</span></span>
<span id="cb80-11"><a href="#cb80-11"></a>glmmRain <span class="ot">&lt;-</span> <span class="fu">glmer</span>(propRF <span class="sc">~</span> yearSinceRestoration <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> allRestored, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb80-12"><a href="#cb80-12"></a><span class="fu">summary</span>(glmmRain)</span>
<span id="cb80-13"><a href="#cb80-13"></a></span>
<span id="cb80-14"><a href="#cb80-14"></a><span class="fu">plot_model</span>(glmmRain, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>)</span>
<span id="cb80-15"><a href="#cb80-15"></a>report<span class="sc">::</span><span class="fu">report</span>(glmmRain)</span>
<span id="cb80-16"><a href="#cb80-16"></a></span>
<span id="cb80-17"><a href="#cb80-17"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict propRF with yearSinceRestoration (formula: propRF ~ yearSinceRestoration). The model included visit as random effect (formula: ~1 | visit). The model&#39;s total explanatory power is weak (conditional R2 = 0.09) and the part related to the fixed effects alone (marginal R2) is of 2.65e-03. The model&#39;s intercept, corresponding to yearSinceRestoration = 0, is at 0.74 (95% CI [0.60, 0.88], t(80) = 10.79, p &lt; .001). Within this model:</span></span>
<span id="cb80-18"><a href="#cb80-18"></a></span>
<span id="cb80-19"><a href="#cb80-19"></a><span class="co">#  - The effect of yearSinceRestoration is statistically non-significant and positive (beta = 2.11e-03, 95% CI [-6.42e-03, 0.01], t(80) = 0.49, p = 0.624; Std. beta = 0.05, 95% CI [-0.16, 0.26])</span></span>
<span id="cb80-20"><a href="#cb80-20"></a></span>
<span id="cb80-21"><a href="#cb80-21"></a><span class="co"># open-country birds</span></span>
<span id="cb80-22"><a href="#cb80-22"></a>glmmOpen <span class="ot">&lt;-</span> <span class="fu">glmer</span>(propOC <span class="sc">~</span> yearSinceRestoration <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> allRestored, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb80-23"><a href="#cb80-23"></a><span class="fu">summary</span>(glmmOpen)</span>
<span id="cb80-24"><a href="#cb80-24"></a></span>
<span id="cb80-25"><a href="#cb80-25"></a><span class="fu">plot_model</span>(glmmOpen, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>)</span>
<span id="cb80-26"><a href="#cb80-26"></a>report<span class="sc">::</span><span class="fu">report</span>(glmmOpen)</span>
<span id="cb80-27"><a href="#cb80-27"></a></span>
<span id="cb80-28"><a href="#cb80-28"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict propOC with yearSinceRestoration (formula: propOC ~ yearSinceRestoration). The model included visit as random effect (formula: ~1 | visit). The model&#39;s total explanatory power is weak (conditional R2 = 0.09) and the part related to the fixed effects alone (marginal R2) is of 2.65e-03. The model&#39;s intercept, corresponding to yearSinceRestoration = 0, is at 0.26 (95% CI [0.12, 0.40], t(80) = 3.79, p &lt; .001). Within this model:</span></span>
<span id="cb80-29"><a href="#cb80-29"></a></span>
<span id="cb80-30"><a href="#cb80-30"></a><span class="co">#  - The effect of yearSinceRestoration is statistically non-significant and negative (beta = -2.11e-03, 95% CI [-0.01, 6.42e-03], t(80) = -0.49, p = 0.624; Std. beta = -0.05, 95% CI [-0.26, 0.16])</span></span></code></pre></div>

</div>
</div>
<div id="generalized-linear-modeling-acoustic-space-use-and-proportion-of-bird-species-detections-and-time-since-restoration" class="section level2 hasAnchor" number="0.17">
<h2><span class="header-section-number">0.17</span> Generalized linear modeling (acoustic space use and proportion of bird species detections and time since restoration)<a href="#generalized-linear-modeling-acoustic-space-use-and-proportion-of-bird-species-detections-and-time-since-restoration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this script, we run generalized linear models to test the association between acoustic space use values and species richness, and time since restoration.</p>
<div id="install-required-libraries-10" class="section level3 hasAnchor" number="0.17.1">
<h3><span class="header-section-number">0.17.1</span> Install required libraries<a href="#install-required-libraries-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb81-3"><a href="#cb81-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb81-4"><a href="#cb81-4"></a><span class="fu">library</span>(vegan)</span>
<span id="cb81-5"><a href="#cb81-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb81-6"><a href="#cb81-6"></a><span class="fu">library</span>(scico)</span>
<span id="cb81-7"><a href="#cb81-7"></a><span class="fu">library</span>(psych)</span>
<span id="cb81-8"><a href="#cb81-8"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb81-9"><a href="#cb81-9"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb81-10"><a href="#cb81-10"></a><span class="fu">library</span>(lme4)</span>
<span id="cb81-11"><a href="#cb81-11"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb81-12"><a href="#cb81-12"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb81-13"><a href="#cb81-13"></a></span>
<span id="cb81-14"><a href="#cb81-14"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb81-15"><a href="#cb81-15"></a><span class="fu">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
<div id="load-necessary-data-for-statistical-modeling-1" class="section level3 hasAnchor" number="0.17.2">
<h3><span class="header-section-number">0.17.2</span> Load necessary data for statistical modeling<a href="#load-necessary-data-for-statistical-modeling-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co"># load list of sites</span></span>
<span id="cb82-2"><a href="#cb82-2"></a>sites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/list-of-sites.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="#cb82-3"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;Site.code&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="#cb82-4"></a>  <span class="fu">filter</span>(Site.code <span class="sc">!=</span> <span class="st">&quot;OLCAP5B&quot;</span>)</span>
<span id="cb82-5"><a href="#cb82-5"></a></span>
<span id="cb82-6"><a href="#cb82-6"></a><span class="co"># loading jacknife scores </span></span>
<span id="cb82-7"><a href="#cb82-7"></a>jackAll <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/jackAll.csv&quot;</span>)</span>
<span id="cb82-8"><a href="#cb82-8"></a>jack_rainForest <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/jackRainforest.csv&quot;</span>)</span>
<span id="cb82-9"><a href="#cb82-9"></a>jack_openCountry <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/jackOpencountry.csv&quot;</span>)</span>
<span id="cb82-10"><a href="#cb82-10"></a></span>
<span id="cb82-11"><a href="#cb82-11"></a><span class="co"># Load vegetation data from previous scripts </span></span>
<span id="cb82-12"><a href="#cb82-12"></a>vegData <span class="ot">&lt;-</span>  <span class="fu">read.csv</span>(<span class="st">&quot;results/summaryVeg.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-13"><a href="#cb82-13"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(Site_ID, <span class="st">&#39;OLCAP5B&#39;</span>))</span>
<span id="cb82-14"><a href="#cb82-14"></a>vegPcaScores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/pcaVeg.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-15"><a href="#cb82-15"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(Site_ID, <span class="st">&#39;OLCAP5B&#39;</span>))</span>
<span id="cb82-16"><a href="#cb82-16"></a></span>
<span id="cb82-17"><a href="#cb82-17"></a><span class="co"># proportion of acoustic detections of rainforest and open-country birds across visits</span></span>
<span id="cb82-18"><a href="#cb82-18"></a>propVisit <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/acoustic-detections-across-visits.csv&quot;</span>)</span>
<span id="cb82-19"><a href="#cb82-19"></a><span class="co"># convert date column to character for left_join</span></span>
<span id="cb82-20"><a href="#cb82-20"></a>propVisit<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.character</span>(propVisit<span class="sc">$</span>Date)</span>
<span id="cb82-21"><a href="#cb82-21"></a></span>
<span id="cb82-22"><a href="#cb82-22"></a><span class="co"># load the entire asu data across all sites and days computed</span></span>
<span id="cb82-23"><a href="#cb82-23"></a>sitebyDayAsu <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;results/site-by-day-asu.csv&quot;</span>) </span>
<span id="cb82-24"><a href="#cb82-24"></a></span>
<span id="cb82-25"><a href="#cb82-25"></a><span class="co"># separate by Site and Date</span></span>
<span id="cb82-26"><a href="#cb82-26"></a>sitebyDayAsu <span class="ot">&lt;-</span> <span class="fu">separate</span>(sitebyDayAsu, <span class="at">col =</span> Site_Day, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>, <span class="st">&quot;Date&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>) </span>
<span id="cb82-27"><a href="#cb82-27"></a></span>
<span id="cb82-28"><a href="#cb82-28"></a><span class="co"># Add restoration type column to the space use data</span></span>
<span id="cb82-29"><a href="#cb82-29"></a>sitebyDayAsu <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sitebyDayAsu, sites, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span><span class="ot">=</span><span class="st">&quot;Site.code&quot;</span>))</span>
<span id="cb82-30"><a href="#cb82-30"></a></span>
<span id="cb82-31"><a href="#cb82-31"></a><span class="co"># scale values per site/date for comparison between sites and treatment types</span></span>
<span id="cb82-32"><a href="#cb82-32"></a>sitebyDayAsu <span class="ot">&lt;-</span> sitebyDayAsu <span class="sc">%&gt;%</span></span>
<span id="cb82-33"><a href="#cb82-33"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb82-34"><a href="#cb82-34"></a>  <span class="fu">mutate</span>(<span class="at">f.cont.scaled =</span> <span class="fu">range01</span>(f.cont))</span>
<span id="cb82-35"><a href="#cb82-35"></a></span>
<span id="cb82-36"><a href="#cb82-36"></a><span class="co"># Let&#39;s look at data by restoration type</span></span>
<span id="cb82-37"><a href="#cb82-37"></a><span class="co"># This suggests that we have more data for benchmark sites relative to the other two treatment types</span></span>
<span id="cb82-38"><a href="#cb82-38"></a>nDays_siteType <span class="ot">&lt;-</span> sitebyDayAsu <span class="sc">%&gt;%</span></span>
<span id="cb82-39"><a href="#cb82-39"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb82-40"><a href="#cb82-40"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-41"><a href="#cb82-41"></a>  <span class="fu">group_by</span>(Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb82-42"><a href="#cb82-42"></a>  <span class="fu">count</span>()</span>
<span id="cb82-43"><a href="#cb82-43"></a>  </span>
<span id="cb82-44"><a href="#cb82-44"></a><span class="co"># Prepare data for statistical modeling</span></span>
<span id="cb82-45"><a href="#cb82-45"></a><span class="co"># Calculating total space use across all frequency bins and times of day: 128*24 for each site-day combination</span></span>
<span id="cb82-46"><a href="#cb82-46"></a></span>
<span id="cb82-47"><a href="#cb82-47"></a>totSpaceUse <span class="ot">&lt;-</span> sitebyDayAsu <span class="sc">%&gt;%</span></span>
<span id="cb82-48"><a href="#cb82-48"></a>  <span class="fu">group_by</span>(Site, Date, Restoration.type) <span class="sc">%&gt;%</span></span>
<span id="cb82-49"><a href="#cb82-49"></a>  <span class="fu">summarise</span>(<span class="at">totSpaceuse =</span> <span class="fu">sum</span>(f.cont.scaled)) <span class="sc">%&gt;%</span></span>
<span id="cb82-50"><a href="#cb82-50"></a>  <span class="fu">group_by</span>(Site) <span class="sc">%&gt;%</span> </span>
<span id="cb82-51"><a href="#cb82-51"></a>  <span class="fu">mutate</span>(<span class="at">visit =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb82-52"><a href="#cb82-52"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">str_extract</span>(Site, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">d+&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb82-53"><a href="#cb82-53"></a>  <span class="fu">mutate</span>(<span class="at">siteCode =</span> <span class="fu">factor</span>(siteCode)) <span class="sc">%&gt;%</span></span>
<span id="cb82-54"><a href="#cb82-54"></a>  <span class="fu">full_join</span>(vegData, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span><span class="ot">=</span><span class="st">&quot;Site_ID&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb82-55"><a href="#cb82-55"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
</div>
<div id="getting-data-ready-in-a-format-for-linear-modeling-1" class="section level3 hasAnchor" number="0.17.3">
<h3><span class="header-section-number">0.17.3</span> Getting data ready in a format for linear modeling<a href="#getting-data-ready-in-a-format-for-linear-modeling-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="co"># overall space use and bird species detections</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>modelDataAll <span class="ot">&lt;-</span> vegPcaScores <span class="sc">%&gt;%</span> </span>
<span id="cb83-3"><a href="#cb83-3"></a>  <span class="fu">rename</span>(<span class="at">Site =</span> Site_ID) <span class="sc">%&gt;%</span></span>
<span id="cb83-4"><a href="#cb83-4"></a>  <span class="fu">rename</span>(<span class="at">Restoration.type =</span> Site_type) <span class="sc">%&gt;%</span></span>
<span id="cb83-5"><a href="#cb83-5"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Restoration.type, factor))  <span class="sc">%&gt;%</span></span>
<span id="cb83-6"><a href="#cb83-6"></a>  <span class="fu">full_join</span>(totSpaceUse, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-7"><a href="#cb83-7"></a>  <span class="fu">mutate</span>(<span class="st">&quot;roundSpaceuse&quot;</span> <span class="ot">=</span> <span class="fu">round</span>(totSpaceuse)) <span class="sc">%&gt;%</span></span>
<span id="cb83-8"><a href="#cb83-8"></a>  <span class="fu">full_join</span>(propVisit[,<span class="sc">-</span><span class="dv">2</span>], <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-9"><a href="#cb83-9"></a>  <span class="fu">distinct</span>(.)</span></code></pre></div>
</div>
<div id="acoustic-space-use-and-proportion-of-bird-species-detections" class="section level3 hasAnchor" number="0.17.4">
<h3><span class="header-section-number">0.17.4</span> Acoustic space use and proportion of bird species detections<a href="#acoustic-space-use-and-proportion-of-bird-species-detections" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="co"># rainforest bird species detections</span></span>
<span id="cb84-2"><a href="#cb84-2"></a>glmm_detectionsRF_space <span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundSpaceuse <span class="sc">~</span> propRF <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> modelDataAll, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb84-3"><a href="#cb84-3"></a></span>
<span id="cb84-4"><a href="#cb84-4"></a><span class="fu">summary</span>(glmm_detectionsRF_space)</span>
<span id="cb84-5"><a href="#cb84-5"></a><span class="fu">plot_model</span>(glmm_detectionsRF_space, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>)</span>
<span id="cb84-6"><a href="#cb84-6"></a>report<span class="sc">::</span><span class="fu">report</span>(glmm_detectionsRF_space)</span>
<span id="cb84-7"><a href="#cb84-7"></a></span>
<span id="cb84-8"><a href="#cb84-8"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict roundSpaceuse with propRF (formula: roundSpaceuse ~ propRF). The model included siteCode and visit as random effects (formula: list(~1 | siteCode, ~1 | visit)). The model&#39;s total explanatory power is substantial (conditional R2 = 0.84) and the part related to the fixed effects alone (marginal R2) is of 1.99e-04. The model&#39;s intercept, corresponding to propRF = 0, is at 289.91 (95% CI [233.66, 346.16], t(1215) = 10.11, p &lt; .001). Within this model:</span></span>
<span id="cb84-9"><a href="#cb84-9"></a></span>
<span id="cb84-10"><a href="#cb84-10"></a><span class="co">#  - The effect of propRF is statistically non-significant and positive (beta = 15.96, 95% CI [-18.66, 50.57], t(1215) = 0.90, p = 0.366; Std. beta = 0.01, 95% CI [-0.02, 0.05])</span></span>
<span id="cb84-11"><a href="#cb84-11"></a></span>
<span id="cb84-12"><a href="#cb84-12"></a><span class="co"># Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</span></span>
<span id="cb84-13"><a href="#cb84-13"></a></span>
<span id="cb84-14"><a href="#cb84-14"></a><span class="co"># open-country bird species detections</span></span>
<span id="cb84-15"><a href="#cb84-15"></a>glmm_detectionsOC_space <span class="ot">&lt;-</span> <span class="fu">glmer</span>(roundSpaceuse <span class="sc">~</span> propOC <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>siteCode) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> modelDataAll, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb84-16"><a href="#cb84-16"></a></span>
<span id="cb84-17"><a href="#cb84-17"></a><span class="fu">summary</span>(glmm_detectionsOC_space)</span>
<span id="cb84-18"><a href="#cb84-18"></a><span class="fu">plot_model</span>(glmm_detectionsOC_space, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>)</span>
<span id="cb84-19"><a href="#cb84-19"></a>report<span class="sc">::</span><span class="fu">report</span>(glmm_detectionsOC_space)</span>
<span id="cb84-20"><a href="#cb84-20"></a></span>
<span id="cb84-21"><a href="#cb84-21"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict roundSpaceuse with propOC (formula: roundSpaceuse ~ propOC). The model included siteCode and visit as random effects (formula: list(~1 | siteCode, ~1 | visit)). The model&#39;s total explanatory power is substantial (conditional R2 = 0.84) and the part related to the fixed effects alone (marginal R2) is of 1.99e-04. The model&#39;s intercept, corresponding to propOC = 0, is at 305.87 (95% CI [257.26, 354.48], t(1215) = 12.35, p &lt; .001). Within this model:</span></span>
<span id="cb84-22"><a href="#cb84-22"></a></span>
<span id="cb84-23"><a href="#cb84-23"></a><span class="co">#  - The effect of propOC is statistically non-significant and negative (beta = -15.96, 95% CI [-50.57, 18.66], t(1215) = -0.90, p = 0.366; Std. beta = -0.01, 95% CI [-0.05, 0.02])</span></span>
<span id="cb84-24"><a href="#cb84-24"></a></span>
<span id="cb84-25"><a href="#cb84-25"></a><span class="co"># Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation. </span></span></code></pre></div>
</div>
<div id="year-since-restoration" class="section level3 hasAnchor" number="0.17.5">
<h3><span class="header-section-number">0.17.5</span> Year since restoration<a href="#year-since-restoration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s look at year since restoration and its effect on acoustic space use and the proportion of rainforest and open country bird species detections</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="co"># prep dataframe</span></span>
<span id="cb85-2"><a href="#cb85-2"></a>allRestored <span class="ot">&lt;-</span> modelDataAll <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3"></a>  <span class="fu">filter</span>(Restoration.type<span class="sc">==</span><span class="st">&quot;Active&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="#cb85-4"></a>  <span class="fu">mutate</span>(<span class="at">yearSinceRestoration =</span> (<span class="dv">2022</span><span class="sc">-</span>plantingYear))</span>
<span id="cb85-5"><a href="#cb85-5"></a></span>
<span id="cb85-6"><a href="#cb85-6"></a><span class="do">## acoustic space use</span></span>
<span id="cb85-7"><a href="#cb85-7"></a>glmmYearSpace <span class="ot">&lt;-</span> <span class="fu">glmer</span>(totSpaceuse <span class="sc">~</span> yearSinceRestoration <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> allRestored, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb85-8"><a href="#cb85-8"></a><span class="fu">summary</span>(glmmYearSpace)</span>
<span id="cb85-9"><a href="#cb85-9"></a></span>
<span id="cb85-10"><a href="#cb85-10"></a><span class="fu">plot_model</span>(glmmYearSpace, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>)</span>
<span id="cb85-11"><a href="#cb85-11"></a>report<span class="sc">::</span><span class="fu">report</span>(glmmYearSpace)</span>
<span id="cb85-12"><a href="#cb85-12"></a></span>
<span id="cb85-13"><a href="#cb85-13"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict totSpaceuse with yearSinceRestoration (formula: totSpaceuse ~ yearSinceRestoration). The model included visit as random effect (formula: ~1 | visit). The model&#39;s total explanatory power is moderate (conditional R2 = 0.16) and the part related to the fixed effects alone (marginal R2) is of 0.12. The model&#39;s intercept, corresponding to yearSinceRestoration = 0, is at 343.91 (95% CI [238.78, 449.04], t(61) = 6.54, p &lt; .001). Within this model:</span></span>
<span id="cb85-14"><a href="#cb85-14"></a></span>
<span id="cb85-15"><a href="#cb85-15"></a><span class="co">#  - The effect of yearSinceRestoration is statistically significant and negative (beta = -10.07, 95% CI [-16.66, -3.47], t(61) = -3.05, p = 0.003; Std. beta = -0.35, 95% CI [-0.58, -0.12])</span></span>
<span id="cb85-16"><a href="#cb85-16"></a></span>
<span id="cb85-17"><a href="#cb85-17"></a><span class="co"># Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</span></span>
<span id="cb85-18"><a href="#cb85-18"></a></span>
<span id="cb85-19"><a href="#cb85-19"></a><span class="do">## rainforest bird species detections</span></span>
<span id="cb85-20"><a href="#cb85-20"></a>glmmYearRF <span class="ot">&lt;-</span> <span class="fu">glmer</span>(propRF <span class="sc">~</span> yearSinceRestoration <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> allRestored, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb85-21"><a href="#cb85-21"></a><span class="fu">summary</span>(glmmYearRF)</span>
<span id="cb85-22"><a href="#cb85-22"></a></span>
<span id="cb85-23"><a href="#cb85-23"></a><span class="fu">plot_model</span>(glmmYearRF, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>)</span>
<span id="cb85-24"><a href="#cb85-24"></a>report<span class="sc">::</span><span class="fu">report</span>(glmmYearRF)</span>
<span id="cb85-25"><a href="#cb85-25"></a></span>
<span id="cb85-26"><a href="#cb85-26"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict propRF with yearSinceRestoration (formula: propRF ~ yearSinceRestoration). The model included visit as random effect (formula: ~1 | visit). The model&#39;s explanatory power related to the fixed effects alone (marginal R2) is 3.67e-09. The model&#39;s intercept, corresponding to yearSinceRestoration = 0, is at 0.77 (95% CI [0.71, 0.83], t(366) = 24.62, p &lt; .001). Within this model:</span></span>
<span id="cb85-27"><a href="#cb85-27"></a></span>
<span id="cb85-28"><a href="#cb85-28"></a><span class="co">#  - The effect of yearSinceRestoration is statistically non-significant and negative (beta = -2.33e-06, 95% CI [-3.94e-03, 3.93e-03], t(366) = -1.16e-03, p &gt; .999; Std. beta = -6.07e-05, 95% CI [-0.10, 0.10])</span></span>
<span id="cb85-29"><a href="#cb85-29"></a></span>
<span id="cb85-30"><a href="#cb85-30"></a><span class="co"># Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation. </span></span>
<span id="cb85-31"><a href="#cb85-31"></a></span>
<span id="cb85-32"><a href="#cb85-32"></a><span class="do">## open country bird species detections</span></span>
<span id="cb85-33"><a href="#cb85-33"></a>glmmYearOC <span class="ot">&lt;-</span> <span class="fu">glmer</span>(propOC <span class="sc">~</span> yearSinceRestoration <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>visit), <span class="at">data =</span> allRestored, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>))</span>
<span id="cb85-34"><a href="#cb85-34"></a><span class="fu">summary</span>(glmmYearOC)</span>
<span id="cb85-35"><a href="#cb85-35"></a></span>
<span id="cb85-36"><a href="#cb85-36"></a><span class="fu">plot_model</span>(glmmYearOC, <span class="at">type=</span><span class="st">&quot;pred&quot;</span>)</span>
<span id="cb85-37"><a href="#cb85-37"></a>report<span class="sc">::</span><span class="fu">report</span>(glmmYearOC)</span>
<span id="cb85-38"><a href="#cb85-38"></a></span>
<span id="cb85-39"><a href="#cb85-39"></a><span class="co"># We fitted a linear mixed model (estimated using REML and nloptwrap optimizer) to predict propOC with yearSinceRestoration (formula: propOC ~ yearSinceRestoration). The model included visit as random effect (formula: ~1 | visit). The model&#39;s explanatory power related to the fixed effects alone (marginal R2) is 3.67e-09. The model&#39;s intercept, corresponding to yearSinceRestoration = 0, is at 0.23 (95% CI [0.17, 0.29], t(366) = 7.32, p &lt; .001). Within this model:</span></span>
<span id="cb85-40"><a href="#cb85-40"></a></span>
<span id="cb85-41"><a href="#cb85-41"></a><span class="co">#  - The effect of yearSinceRestoration is statistically non-significant and positive (beta = 2.33e-06, 95% CI [-3.93e-03, 3.94e-03], t(366) = 1.16e-03, p &gt; .999; Std. beta = 6.07e-05, 95% CI [-0.10, 0.10])</span></span>
<span id="cb85-42"><a href="#cb85-42"></a></span>
<span id="cb85-43"><a href="#cb85-43"></a><span class="co"># Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation. </span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/vjjan91/acoustics-westernGhats/edit/master/%s",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
