<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 5 Non-metric multidimensional scaling of acoustic space use data | Source code for Using acoustics to assess the impacts of forest restoration on bird communities in the Western Ghats</title>
  <meta name="description" content="Section 5 Non-metric multidimensional scaling of acoustic space use data | Source code for Using acoustics to assess the impacts of forest restoration on bird communities in the Western Ghats" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 5 Non-metric multidimensional scaling of acoustic space use data | Source code for Using acoustics to assess the impacts of forest restoration on bird communities in the Western Ghats" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="vjjan91/acoustics-westernGhats" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 5 Non-metric multidimensional scaling of acoustic space use data | Source code for Using acoustics to assess the impacts of forest restoration on bird communities in the Western Ghats" />
  
  
  

<meta name="author" content="Vijay Ramesh" />
<meta name="author" content="Priyanka HariHaran" />
<meta name="author" content="VA Akshay" />
<meta name="author" content="Pooja Choksi" />
<meta name="author" content="Sarika Khanwilkar" />
<meta name="author" content="VV Robin" />
<meta name="author" content="Ruth DeFries" />


<meta name="date" content="2022-05-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="acoustic-space-use.html"/>
<link rel="next" href="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#attribution"><i class="fa fa-check"></i><b>1.1</b> Attribution</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-access"><i class="fa fa-check"></i><b>1.2</b> Data access</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-processing"><i class="fa fa-check"></i><b>1.3</b> Data processing</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#main-text-figure-1"><i class="fa fa-check"></i><b>1.4</b> Main Text Figure 1</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="site-selection.html"><a href="site-selection.html"><i class="fa fa-check"></i><b>2</b> Site selection</a><ul>
<li class="chapter" data-level="2.1" data-path="site-selection.html"><a href="site-selection.html#install-required-libraries"><i class="fa fa-check"></i><b>2.1</b> Install required libraries</a></li>
<li class="chapter" data-level="2.2" data-path="site-selection.html"><a href="site-selection.html#load-list-of-sites"><i class="fa fa-check"></i><b>2.2</b> Load list of sites</a></li>
<li class="chapter" data-level="2.3" data-path="site-selection.html"><a href="site-selection.html#extract-elevation"><i class="fa fa-check"></i><b>2.3</b> Extract elevation</a></li>
<li class="chapter" data-level="2.4" data-path="site-selection.html"><a href="site-selection.html#distance-to-nearest-road"><i class="fa fa-check"></i><b>2.4</b> Distance to nearest road</a></li>
<li class="chapter" data-level="2.5" data-path="site-selection.html"><a href="site-selection.html#distance-between-ar-nr-site-pairs"><i class="fa fa-check"></i><b>2.5</b> Distance between AR-NR site pairs</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="processing-vegetation-data.html"><a href="processing-vegetation-data.html"><i class="fa fa-check"></i><b>3</b> Processing vegetation data</a><ul>
<li class="chapter" data-level="3.1" data-path="processing-vegetation-data.html"><a href="processing-vegetation-data.html#install-required-libraries-1"><i class="fa fa-check"></i><b>3.1</b> Install required libraries</a></li>
<li class="chapter" data-level="3.2" data-path="processing-vegetation-data.html"><a href="processing-vegetation-data.html#load-the-vegetation-data"><i class="fa fa-check"></i><b>3.2</b> Load the vegetation data</a></li>
<li class="chapter" data-level="3.3" data-path="processing-vegetation-data.html"><a href="processing-vegetation-data.html#process-habitat-structure-variables"><i class="fa fa-check"></i><b>3.3</b> Process habitat structure variables</a></li>
<li class="chapter" data-level="3.4" data-path="processing-vegetation-data.html"><a href="processing-vegetation-data.html#principal-component-analysis-of-vegetation-data"><i class="fa fa-check"></i><b>3.4</b> Principal component analysis of vegetation data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="acoustic-space-use.html"><a href="acoustic-space-use.html"><i class="fa fa-check"></i><b>4</b> Acoustic space use</a><ul>
<li class="chapter" data-level="4.1" data-path="acoustic-space-use.html"><a href="acoustic-space-use.html#install-necessary-libraries"><i class="fa fa-check"></i><b>4.1</b> Install necessary libraries</a></li>
<li class="chapter" data-level="4.2" data-path="acoustic-space-use.html"><a href="acoustic-space-use.html#load-recordings-across-multiple-days-and-sites"><i class="fa fa-check"></i><b>4.2</b> Load recordings across multiple days and sites</a></li>
<li class="chapter" data-level="4.3" data-path="acoustic-space-use.html"><a href="acoustic-space-use.html#short-time-discrete-fourier-transform-stdft"><i class="fa fa-check"></i><b>4.3</b> Short-time discrete fourier transform (STDFT)</a></li>
<li class="chapter" data-level="4.4" data-path="acoustic-space-use.html"><a href="acoustic-space-use.html#average-acoustic-space-use"><i class="fa fa-check"></i><b>4.4</b> Average acoustic space use</a></li>
<li class="chapter" data-level="4.5" data-path="acoustic-space-use.html"><a href="acoustic-space-use.html#visual-examination-of-asu"><i class="fa fa-check"></i><b>4.5</b> Visual examination of ASU</a></li>
<li class="chapter" data-level="4.6" data-path="acoustic-space-use.html"><a href="acoustic-space-use.html#representative-figure-for-publication"><i class="fa fa-check"></i><b>4.6</b> Representative figure for publication</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html"><i class="fa fa-check"></i><b>5</b> Non-metric multidimensional scaling of acoustic space use data</a><ul>
<li class="chapter" data-level="5.1" data-path="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#load-necessary-libraries-for-analysis"><i class="fa fa-check"></i><b>5.1</b> Load necessary libraries for analysis</a></li>
<li class="chapter" data-level="5.2" data-path="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#load-the-necessary-data-for-nmds-calculations"><i class="fa fa-check"></i><b>5.2</b> Load the necessary data for nmds calculations</a></li>
<li class="chapter" data-level="5.3" data-path="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#preparing-a-dataframe-of-space-use-to-run-ordinations"><i class="fa fa-check"></i><b>5.3</b> Preparing a dataframe of space use to run ordinations</a></li>
<li class="chapter" data-level="5.4" data-path="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#plotting-the-nmds-scores"><i class="fa fa-check"></i><b>5.4</b> Plotting the NMDS scores</a></li>
<li class="chapter" data-level="5.5" data-path="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#testing-multivariate-homogeneity-of-group-dispersions"><i class="fa fa-check"></i><b>5.5</b> Testing multivariate homogeneity of group dispersions</a></li>
<li class="chapter" data-level="5.6" data-path="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#visualizing-the-multivariate-homogeneity-of-group-dispersions"><i class="fa fa-check"></i><b>5.6</b> Visualizing the multivariate homogeneity of group dispersions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html"><a href="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html"><i class="fa fa-check"></i><b>6</b> Generalized linear mixed modeling (acoustic space use and vegetation data)</a><ul>
<li class="chapter" data-level="6.1" data-path="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html"><a href="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html#install-required-libraries-2"><i class="fa fa-check"></i><b>6.1</b> Install required libraries</a></li>
<li class="chapter" data-level="6.2" data-path="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html"><a href="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html#load-necessary-data-for-statistical-modeling"><i class="fa fa-check"></i><b>6.2</b> Load necessary data for statistical modeling</a></li>
<li class="chapter" data-level="6.3" data-path="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html"><a href="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html#getting-data-ready-in-a-format-for-linear-modeling"><i class="fa fa-check"></i><b>6.3</b> Getting data ready in a format for linear modeling</a></li>
<li class="chapter" data-level="6.4" data-path="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html"><a href="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html#running-the-generalized-linear-mixed-models"><i class="fa fa-check"></i><b>6.4</b> Running the generalized linear mixed models</a></li>
<li class="chapter" data-level="6.5" data-path="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html"><a href="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html#creating-figure-for-publication"><i class="fa fa-check"></i><b>6.5</b> Creating figure for publication</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="splitting-large-.wav-files.html"><a href="splitting-large-.wav-files.html"><i class="fa fa-check"></i><b>7</b> Splitting large .wav files</a><ul>
<li class="chapter" data-level="7.1" data-path="splitting-large-.wav-files.html"><a href="splitting-large-.wav-files.html#load-required-libraries"><i class="fa fa-check"></i><b>7.1</b> Load required libraries</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="selecting-the-dawn-chorus.html"><a href="selecting-the-dawn-chorus.html"><i class="fa fa-check"></i><b>8</b> Selecting the dawn chorus</a><ul>
<li class="chapter" data-level="8.1" data-path="selecting-the-dawn-chorus.html"><a href="selecting-the-dawn-chorus.html#split-the-files"><i class="fa fa-check"></i><b>8.1</b> Split the files</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bird-species-richness.html"><a href="bird-species-richness.html"><i class="fa fa-check"></i><b>9</b> Bird Species Richness</a><ul>
<li class="chapter" data-level="9.1" data-path="bird-species-richness.html"><a href="bird-species-richness.html#install-required-libraries-3"><i class="fa fa-check"></i><b>9.1</b> Install required libraries</a></li>
<li class="chapter" data-level="9.2" data-path="bird-species-richness.html"><a href="bird-species-richness.html#load-manual-annotations-data"><i class="fa fa-check"></i><b>9.2</b> Load manual annotations data</a></li>
<li class="chapter" data-level="9.3" data-path="bird-species-richness.html"><a href="bird-species-richness.html#subset-data"><i class="fa fa-check"></i><b>9.3</b> Subset data</a></li>
<li class="chapter" data-level="9.4" data-path="bird-species-richness.html"><a href="bird-species-richness.html#total-number-of-detections"><i class="fa fa-check"></i><b>9.4</b> Total number of detections</a></li>
<li class="chapter" data-level="9.5" data-path="bird-species-richness.html"><a href="bird-species-richness.html#calculate-species-richness"><i class="fa fa-check"></i><b>9.5</b> Calculate species richness</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="acoustic-detections.html"><a href="acoustic-detections.html"><i class="fa fa-check"></i><b>10</b> Acoustic Detections</a><ul>
<li class="chapter" data-level="10.1" data-path="acoustic-detections.html"><a href="acoustic-detections.html#install-required-libraries-4"><i class="fa fa-check"></i><b>10.1</b> Install required libraries</a></li>
<li class="chapter" data-level="10.2" data-path="acoustic-detections.html"><a href="acoustic-detections.html#load-data"><i class="fa fa-check"></i><b>10.2</b> Load data</a></li>
<li class="chapter" data-level="10.3" data-path="acoustic-detections.html"><a href="acoustic-detections.html#overall-number-of-detections"><i class="fa fa-check"></i><b>10.3</b> Overall number of detections</a></li>
<li class="chapter" data-level="10.4" data-path="acoustic-detections.html"><a href="acoustic-detections.html#detections-by-treatment-type"><i class="fa fa-check"></i><b>10.4</b> Detections by treatment type</a></li>
<li class="chapter" data-level="10.5" data-path="acoustic-detections.html"><a href="acoustic-detections.html#detections-by-species-traits"><i class="fa fa-check"></i><b>10.5</b> Detections by species traits</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="jackknife-estimates.html"><a href="jackknife-estimates.html"><i class="fa fa-check"></i><b>11</b> Jackknife estimates</a><ul>
<li class="chapter" data-level="11.1" data-path="jackknife-estimates.html"><a href="jackknife-estimates.html#install-required-libraries-5"><i class="fa fa-check"></i><b>11.1</b> Install required libraries</a></li>
<li class="chapter" data-level="11.2" data-path="jackknife-estimates.html"><a href="jackknife-estimates.html#load-the-necessary-data-to-calculate-jackknife-scores"><i class="fa fa-check"></i><b>11.2</b> Load the necessary data to calculate Jackknife scores</a></li>
<li class="chapter" data-level="11.3" data-path="jackknife-estimates.html"><a href="jackknife-estimates.html#preparing-dataframe-to-extract-jacknife-scores"><i class="fa fa-check"></i><b>11.3</b> Preparing dataframe to extract jacknife scores</a></li>
<li class="chapter" data-level="11.4" data-path="jackknife-estimates.html"><a href="jackknife-estimates.html#save-scores-locally"><i class="fa fa-check"></i><b>11.4</b> Save scores locally</a></li>
<li class="chapter" data-level="11.5" data-path="jackknife-estimates.html"><a href="jackknife-estimates.html#looking-at-correlations-between-jacknife-scores-and-bootstrap-estimates"><i class="fa fa-check"></i><b>11.5</b> Looking at correlations between jacknife scores and bootstrap estimates</a></li>
<li class="chapter" data-level="11.6" data-path="jackknife-estimates.html"><a href="jackknife-estimates.html#testing-for-differences-between-treatment-types"><i class="fa fa-check"></i><b>11.6</b> Testing for differences between treatment types</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html"><i class="fa fa-check"></i><b>12</b> Non-metric multidimensional scaling</a><ul>
<li class="chapter" data-level="12.1" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html#install-required-libraries-6"><i class="fa fa-check"></i><b>12.1</b> Install required libraries</a></li>
<li class="chapter" data-level="12.2" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html#load-the-necessary-data-for-nmds-calculations-1"><i class="fa fa-check"></i><b>12.2</b> Load the necessary data for NMDS calculations</a></li>
<li class="chapter" data-level="12.3" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html#preparing-dataframe-of-traits-and-species-to-be-used-for-nmds-later-on"><i class="fa fa-check"></i><b>12.3</b> Preparing dataframe of traits and species to be used for NMDS later on</a></li>
<li class="chapter" data-level="12.4" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html#preparing-a-dataframe-of-detections-to-run-ordinations"><i class="fa fa-check"></i><b>12.4</b> Preparing a dataframe of detections to run ordinations</a></li>
<li class="chapter" data-level="12.5" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html#bray-curtis-dissimilarity-index"><i class="fa fa-check"></i><b>12.5</b> Bray-Curtis dissimilarity index</a></li>
<li class="chapter" data-level="12.6" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html#plotting-the-nmds-scores-1"><i class="fa fa-check"></i><b>12.6</b> Plotting the NMDS scores</a></li>
<li class="chapter" data-level="12.7" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html#main-text-figure-2"><i class="fa fa-check"></i><b>12.7</b> Main text Figure 2</a></li>
<li class="chapter" data-level="12.8" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html#testing-multivariate-homogeneity-of-group-dispersions-1"><i class="fa fa-check"></i><b>12.8</b> Testing multivariate homogeneity of group dispersions</a></li>
<li class="chapter" data-level="12.9" data-path="non-metric-multidimensional-scaling.html"><a href="non-metric-multidimensional-scaling.html#testing-compositional-dissimilarity-between-groups"><i class="fa fa-check"></i><b>12.9</b> Testing compositional dissimilarity between groups</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html"><a href="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html"><i class="fa fa-check"></i><b>13</b> Generalized linear mixed modeling (species richness, vegetation data and planting year)</a><ul>
<li class="chapter" data-level="13.1" data-path="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html"><a href="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html#install-required-libraries-7"><i class="fa fa-check"></i><b>13.1</b> Install required libraries</a></li>
<li class="chapter" data-level="13.2" data-path="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html"><a href="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html#load-the-necessary-data-for-statistical-modeling"><i class="fa fa-check"></i><b>13.2</b> Load the necessary data for statistical modeling</a></li>
<li class="chapter" data-level="13.3" data-path="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html"><a href="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html#getting-data-ready-in-a-format-for-generalized-linear-modeling"><i class="fa fa-check"></i><b>13.3</b> Getting data ready in a format for generalized linear modeling</a></li>
<li class="chapter" data-level="13.4" data-path="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html"><a href="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html#getting-data-ready-for-generalized-linear-mixed-modeling-with-richness-data-as-well-as-visits."><i class="fa fa-check"></i><b>13.4</b> Getting data ready for generalized linear mixed modeling with richness data as well as visits.</a></li>
<li class="chapter" data-level="13.5" data-path="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html"><a href="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html#running-the-generalized-linear-mixed-models-1"><i class="fa fa-check"></i><b>13.5</b> Running the generalized linear mixed models</a></li>
<li class="chapter" data-level="13.6" data-path="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html"><a href="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html#testing-the-role-of-habitat"><i class="fa fa-check"></i><b>13.6</b> Testing the role of habitat</a></li>
<li class="chapter" data-level="13.7" data-path="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html"><a href="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html#effect-of-planting-year"><i class="fa fa-check"></i><b>13.7</b> Effect of planting year</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="generalized-linear-modeling-acoustic-space-use-and-bird-species-richness-and-time-since-restoration.html"><a href="generalized-linear-modeling-acoustic-space-use-and-bird-species-richness-and-time-since-restoration.html"><i class="fa fa-check"></i><b>14</b> Generalized linear modeling (acoustic space use and bird species richness, and time since restoration)</a><ul>
<li class="chapter" data-level="14.1" data-path="generalized-linear-modeling-acoustic-space-use-and-bird-species-richness-and-time-since-restoration.html"><a href="generalized-linear-modeling-acoustic-space-use-and-bird-species-richness-and-time-since-restoration.html#install-required-libraries-8"><i class="fa fa-check"></i><b>14.1</b> Install required libraries</a></li>
<li class="chapter" data-level="14.2" data-path="generalized-linear-modeling-acoustic-space-use-and-bird-species-richness-and-time-since-restoration.html"><a href="generalized-linear-modeling-acoustic-space-use-and-bird-species-richness-and-time-since-restoration.html#load-necessary-data-for-statistical-modeling-1"><i class="fa fa-check"></i><b>14.2</b> Load necessary data for statistical modeling</a></li>
<li class="chapter" data-level="14.3" data-path="generalized-linear-modeling-acoustic-space-use-and-bird-species-richness-and-time-since-restoration.html"><a href="generalized-linear-modeling-acoustic-space-use-and-bird-species-richness-and-time-since-restoration.html#getting-data-ready-in-a-format-for-linear-modeling-1"><i class="fa fa-check"></i><b>14.3</b> Getting data ready in a format for linear modeling</a></li>
<li class="chapter" data-level="14.4" data-path="generalized-linear-modeling-acoustic-space-use-and-bird-species-richness-and-time-since-restoration.html"><a href="generalized-linear-modeling-acoustic-space-use-and-bird-species-richness-and-time-since-restoration.html#bird-species-richness-1"><i class="fa fa-check"></i><b>14.4</b> Bird species richness</a></li>
<li class="chapter" data-level="14.5" data-path="generalized-linear-modeling-acoustic-space-use-and-bird-species-richness-and-time-since-restoration.html"><a href="generalized-linear-modeling-acoustic-space-use-and-bird-species-richness-and-time-since-restoration.html#year-since-restoration"><i class="fa fa-check"></i><b>14.5</b> Year since restoration</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Source code for <em>Using acoustics to assess the impacts of forest restoration on bird communities in the Western Ghats</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="non-metric-multidimensional-scaling-of-acoustic-space-use-data" class="section level1">
<h1><span class="header-section-number">Section 5</span> Non-metric multidimensional scaling of acoustic space use data</h1>
<p>Here, we will use ordinations as a method of analyzing how acoustic space use (defined in terms of frequency and time, across 24 hours in a day) varies between treatment types.</p>
<div id="load-necessary-libraries-for-analysis" class="section level2">
<h2><span class="header-section-number">5.1</span> Load necessary libraries for analysis</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb16-1"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb16-2"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb16-3"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-3"></a><span class="kw">library</span>(stringr)</span>
<span id="cb16-4"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-4"></a><span class="kw">library</span>(vegan)</span>
<span id="cb16-5"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-5"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb16-6"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-6"></a><span class="kw">library</span>(scico)</span>
<span id="cb16-7"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-7"></a><span class="kw">library</span>(psych)</span>
<span id="cb16-8"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-8"></a><span class="kw">library</span>(ecodist)</span>
<span id="cb16-9"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-9"></a><span class="kw">library</span>(RColorBrewer)</span>
<span id="cb16-10"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-10"></a><span class="kw">library</span>(ggforce)</span>
<span id="cb16-11"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-11"></a><span class="kw">library</span>(ggalt)</span>
<span id="cb16-12"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-12"></a><span class="kw">library</span>(extrafont)</span>
<span id="cb16-13"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-13"></a><span class="co"># loadfonts(device = &quot;win&quot;) # run this prior to creating publication figures </span></span>
<span id="cb16-14"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-14"></a></span>
<span id="cb16-15"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-15"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb16-16"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb16-16"></a><span class="kw">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
</div>
<div id="load-the-necessary-data-for-nmds-calculations" class="section level2">
<h2><span class="header-section-number">5.2</span> Load the necessary data for nmds calculations</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb17-1"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-1"></a><span class="co"># load the site-wise space use data</span></span>
<span id="cb17-2"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-2"></a>sitebyDayAsu &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/site-by-day-asu.csv&quot;</span>)</span>
<span id="cb17-3"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-3"></a></span>
<span id="cb17-4"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-4"></a><span class="co"># separate the columns</span></span>
<span id="cb17-5"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-5"></a>sitebyDayAsu &lt;-<span class="st"> </span><span class="kw">separate</span>(sitebyDayAsu, <span class="dt">col =</span> Site_Day, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;Site&quot;</span>,<span class="st">&quot;Day&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb17-6"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-6"></a></span>
<span id="cb17-7"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-7"></a><span class="co"># load list of sites</span></span>
<span id="cb17-8"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-8"></a>sites &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/list-of-sites.csv&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb17-9"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;Site.code&quot;</span>,<span class="st">&quot;Restoration.type&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb17-10"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-10"></a><span class="st">  </span><span class="kw">filter</span>(Site.code <span class="op">!=</span><span class="st"> &quot;OLCAP5B&quot;</span>)</span>
<span id="cb17-11"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-11"></a></span>
<span id="cb17-12"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-12"></a><span class="co"># Add restoration type column to the space use data</span></span>
<span id="cb17-13"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-13"></a>sitebyDayAsu &lt;-<span class="st"> </span><span class="kw">left_join</span>(sitebyDayAsu,sites, <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;Site&quot;</span>=<span class="st">&quot;Site.code&quot;</span>))</span>
<span id="cb17-14"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-14"></a></span>
<span id="cb17-15"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-15"></a><span class="co"># Separate analysis: space use during certain times of day alone</span></span>
<span id="cb17-16"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-16"></a><span class="co"># let&#39;s look only at dawn chorus to explore what the data looks like</span></span>
<span id="cb17-17"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-17"></a>dawn &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;05:00-06:00&quot;</span>,<span class="st">&quot;06:00-07:00&quot;</span>,<span class="st">&quot;07:00-08:00&quot;</span>,<span class="st">&quot;08:00-09:00&quot;</span>,</span>
<span id="cb17-18"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-18"></a>          <span class="st">&quot;09:00-10:00&quot;</span>)</span>
<span id="cb17-19"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-19"></a>dawnChorusAsu &lt;-<span class="st"> </span>sitebyDayAsu <span class="op">%&gt;%</span></span>
<span id="cb17-20"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-20"></a><span class="st">  </span><span class="kw">filter</span>(time_of_day <span class="op">%in%</span><span class="st"> </span>dawn)</span>
<span id="cb17-21"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-21"></a></span>
<span id="cb17-22"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-22"></a><span class="co"># Separate analysis: space use during certain times of day alone</span></span>
<span id="cb17-23"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-23"></a><span class="co"># let&#39;s look only at dusk chorus to explore what the data looks like</span></span>
<span id="cb17-24"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-24"></a>dusk &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;16:00-17:00&quot;</span>,<span class="st">&quot;17:00-18:00&quot;</span>,<span class="st">&quot;18:00-19:00&quot;</span>,<span class="st">&quot;19:00-20:00&quot;</span>)</span>
<span id="cb17-25"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-25"></a>duskChorusAsu &lt;-<span class="st"> </span>sitebyDayAsu <span class="op">%&gt;%</span></span>
<span id="cb17-26"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb17-26"></a><span class="st">  </span><span class="kw">filter</span>(time_of_day <span class="op">%in%</span><span class="st"> </span>dusk)</span></code></pre></div>
</div>
<div id="preparing-a-dataframe-of-space-use-to-run-ordinations" class="section level2">
<h2><span class="header-section-number">5.3</span> Preparing a dataframe of space use to run ordinations</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb18-1"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb18-1"></a></span>
<span id="cb18-2"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb18-2"></a><span class="co"># Please note that while creating this dataframe for ordinations, the overall acoustic space use (sum of f.cont.sum column) was calculated by frequency bin, irrespective of the time of day for a given site. In other words, for 24 hours of data, a single value of space use was obtained for a given frequency bin. The frequency bin was pivoted from long to wide and each column essentially corresponded to a frequency bin. Within that frequency bin, grouped for each site, an overall value of space use was computed. </span></span>
<span id="cb18-3"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb18-3"></a></span>
<span id="cb18-4"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb18-4"></a>nmdsDat &lt;-<span class="st"> </span>sitebyDayAsu <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace with dawnChorusAsu/duskChorusAsu</span></span>
<span id="cb18-5"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb18-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Site, freq, f.cont, Restoration.type) <span class="op">%&gt;%</span></span>
<span id="cb18-6"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb18-6"></a><span class="st">  </span><span class="kw">group_by</span>(Site, Restoration.type, freq) <span class="op">%&gt;%</span></span>
<span id="cb18-7"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb18-7"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">totSpaceuse =</span> <span class="kw">sum</span>(f.cont)) <span class="op">%&gt;%</span></span>
<span id="cb18-8"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb18-8"></a><span class="st">  </span><span class="kw">arrange</span>(Restoration.type) <span class="op">%&gt;%</span></span>
<span id="cb18-9"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb18-9"></a><span class="st">  </span><span class="kw">pivot_wider</span> (<span class="dt">names_from =</span> freq, <span class="dt">values_from =</span> totSpaceuse, <span class="dt">values_fill =</span> <span class="kw">list</span>(<span class="dt">totSpaceuse=</span><span class="dv">0</span>))</span>
<span id="cb18-10"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb18-10"></a></span>
<span id="cb18-11"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb18-11"></a><span class="co"># Convert to matrix form</span></span>
<span id="cb18-12"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb18-12"></a>nmdsDatMatrix &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(nmdsDat[, <span class="dv">3</span><span class="op">:</span><span class="kw">ncol</span>(nmdsDat)])</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb19-1"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-1"></a><span class="co"># Run a euclidean dissimilarity distance and use metaMDS function from vegan to run ordinations</span></span>
<span id="cb19-2"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-2"></a></span>
<span id="cb19-3"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-3"></a>disEuclidean &lt;-<span class="st"> </span><span class="kw">vegdist</span>(nmdsDatMatrix, <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb19-4"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-4"></a></span>
<span id="cb19-5"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-5"></a>nmdsEuclidean &lt;-<span class="st"> </span><span class="kw">vegdist</span> (nmdsDatMatrix, <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-6"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-6"></a><span class="st">  </span><span class="kw">metaMDS</span> (nmdsEuclidean, <span class="dt">k=</span><span class="dv">6</span>)</span>
<span id="cb19-7"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-7"></a></span>
<span id="cb19-8"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-8"></a><span class="co"># extract nmds scores</span></span>
<span id="cb19-9"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-9"></a>nmdsScores &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">scores</span>(nmdsEuclidean))</span>
<span id="cb19-10"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-10"></a></span>
<span id="cb19-11"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-11"></a><span class="co"># Write the scores to a separate .csv</span></span>
<span id="cb19-12"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-12"></a><span class="kw">write.csv</span>(nmdsScores, <span class="st">&quot;data/nmds-acousticSpaceUse.csv&quot;</span>, <span class="dt">row.names =</span> F)</span>
<span id="cb19-13"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-13"></a></span>
<span id="cb19-14"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb19-14"></a><span class="co"># With the above analysis, we note the stress is 0.009345172. However, if stress is high, we should reposition the points in 2 dimensions in the direction of decreasing stress, and repeat until stress is below some threshold.**A good rule of thumb: stress &lt; 0.05 provides an excellent representation in reduced dimensions, &lt; 0.1 is great, &lt; 0.2 is good/ok, and stress &lt; 0.3 provides a poor representation.** To reiterate: high stress is bad, low stress is good!</span></span></code></pre></div>
</div>
<div id="plotting-the-nmds-scores" class="section level2">
<h2><span class="header-section-number">5.4</span> Plotting the NMDS scores</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb20-1"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-1"></a><span class="co"># First let&#39;s add the treatment type back to the nmds scores</span></span>
<span id="cb20-2"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-2"></a>nmdsScores<span class="op">$</span>Restoration.type &lt;-<span class="st"> </span>nmdsDat<span class="op">$</span>Restoration.type</span>
<span id="cb20-3"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-3"></a></span>
<span id="cb20-4"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-4"></a><span class="co"># Add a custom set of colors</span></span>
<span id="cb20-5"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-5"></a>mycolors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">brewer.pal</span>(<span class="dt">name=</span><span class="st">&quot;Dark2&quot;</span>, <span class="dt">n =</span> <span class="dv">3</span>), <span class="kw">brewer.pal</span>(<span class="dt">name=</span><span class="st">&quot;Paired&quot;</span>, <span class="dt">n =</span> <span class="dv">3</span>))</span>
<span id="cb20-6"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-6"></a></span>
<span id="cb20-7"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-7"></a><span class="co"># reordering factors for plotting</span></span>
<span id="cb20-8"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-8"></a>nmdsScores<span class="op">$</span>Restoration.type &lt;-<span class="st"> </span><span class="kw">factor</span>(nmdsScores<span class="op">$</span>Restoration.type, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Passive&quot;</span>))</span>
<span id="cb20-9"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-9"></a></span>
<span id="cb20-10"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-10"></a>fig_nmds &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>nmdsScores) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-11"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-11"></a><span class="st">  </span><span class="kw">stat_ellipse</span>(<span class="kw">aes</span>(<span class="dt">x=</span>NMDS1,<span class="dt">y=</span>NMDS2,<span class="dt">colour=</span>Restoration.type),<span class="dt">level =</span> <span class="fl">0.50</span>) <span class="op">+</span></span>
<span id="cb20-12"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-12"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>NMDS1,<span class="dt">y=</span>NMDS2,<span class="dt">shape=</span>Restoration.type,<span class="dt">colour=</span>Restoration.type),<span class="dt">size=</span><span class="dv">5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-13"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-13"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb20-14"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="st">&quot;NMDS 1&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-15"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-15"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;NMDS 2&quot;</span>) <span class="op">+</span></span>
<span id="cb20-16"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-16"></a><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="dt">values=</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">unique</span>(nmdsScores<span class="op">$</span>Restoration.type)), <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="op">+</span></span>
<span id="cb20-17"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-17"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="st">&quot;Treatment type&quot;</span>,<span class="dt">values=</span>mycolors, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;AR&quot;</span>,<span class="st">&quot;NR&quot;</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb20-18"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-18"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb20-19"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-19"></a>                                    <span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb20-20"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-20"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb20-21"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-21"></a>                                    <span class="dt">size =</span> <span class="dv">12</span>),</span>
<span id="cb20-22"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-22"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Century Gothic&quot;</span>,</span>
<span id="cb20-23"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-23"></a>                                    <span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb20-24"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-24"></a>        <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb20-25"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-25"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Century Gothic&quot;</span>,<span class="dt">size =</span> <span class="dv">14</span>)) <span class="op">+</span></span>
<span id="cb20-26"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-26"></a><span class="st">   </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">max</span>(nmdsScores<span class="op">$</span>NMDS1), <span class="dt">y =</span> <span class="kw">max</span>(nmdsScores<span class="op">$</span>NMDS2),  <span class="dt">label =</span> <span class="st">&quot;Stress = 0.009&quot;</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">family =</span> <span class="st">&quot;Century Gothic&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)</span>
<span id="cb20-27"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-27"></a></span>
<span id="cb20-28"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb20-28"></a><span class="kw">ggsave</span>(fig_nmds, <span class="dt">filename =</span> <span class="st">&quot;figs/fig_nmds_overallSpaceUse.png&quot;</span>, <span class="dt">width=</span><span class="dv">12</span>, <span class="dt">height=</span><span class="dv">7</span>,<span class="dt">device =</span> <span class="kw">png</span>(), <span class="dt">units=</span><span class="st">&quot;in&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>); <span class="kw">dev.off</span>()</span></code></pre></div>
</div>
<div id="testing-multivariate-homogeneity-of-group-dispersions" class="section level2">
<h2><span class="header-section-number">5.5</span> Testing multivariate homogeneity of group dispersions</h2>
<p>One measure of multivariate dispersion (variance) for a group of samples is to calculate the average distance of group members to the group centroid or spatial median in multivariate space. To test if the dispersions (variances) of one or more groups are different, the distances of group members to the group centroid are subject to ANOVA.</p>
<p>Betadisper tests whether two or more groups (for example, restored and unrestored sites) are homogeneously dispersed in relation to their species in studied samples. This test can be done to see if one group has more compositional variance than another. Moreover, homogeneity of dispersion among groups is very advisable to have if you want to test if two or more groups have different compositions, which is tested by adonis.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb21-1"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb21-1"></a>nmdsVariance &lt;-<span class="st"> </span><span class="kw">betadisper</span>(disEuclidean, <span class="dt">group =</span> nmdsDat<span class="op">$</span>Restoration.type)</span>
<span id="cb21-2"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb21-2"></a>nmdsVariance</span>
<span id="cb21-3"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb21-3"></a></span>
<span id="cb21-4"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb21-4"></a><span class="kw">anova</span>(nmdsVariance)</span>
<span id="cb21-5"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb21-5"></a><span class="kw">permutest</span>(nmdsVariance, <span class="dt">pairwise =</span> <span class="ot">TRUE</span>, <span class="dt">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb21-6"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb21-6"></a><span class="kw">TukeyHSD</span>(nmdsVariance)</span>
<span id="cb21-7"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb21-7"></a></span>
<span id="cb21-8"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb21-8"></a><span class="co"># For overall space use, there is a significant difference in within group variance between one group and another (For Benchmark-Active sites and Passive-Benchmark sites, but not between Active-Passive)</span></span>
<span id="cb21-9"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb21-9"></a></span>
<span id="cb21-10"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb21-10"></a><span class="co"># This result suggests that there is heterogeneous variation and does not meet assumptions to run adonis</span></span></code></pre></div>
</div>
<div id="visualizing-the-multivariate-homogeneity-of-group-dispersions" class="section level2">
<h2><span class="header-section-number">5.6</span> Visualizing the multivariate homogeneity of group dispersions</h2>
<p>The below lines of code have been adapted from: <a href="https://chrischizinski.github.io/rstats/adonis/" class="uri">https://chrischizinski.github.io/rstats/adonis/</a></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb22-1"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-1"></a><span class="co"># extract the centroids and the site points in multivariate space.  </span></span>
<span id="cb22-2"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-2"></a>centroids &lt;-<span class="kw">data.frame</span>(<span class="dt">grps=</span><span class="kw">rownames</span>(nmdsVariance<span class="op">$</span>centroids),</span>
<span id="cb22-3"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-3"></a>                       <span class="kw">data.frame</span>(nmdsVariance<span class="op">$</span>centroids))</span>
<span id="cb22-4"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-4"></a>vectors &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">group=</span>nmdsVariance<span class="op">$</span>group,</span>
<span id="cb22-5"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-5"></a>                      <span class="kw">data.frame</span>(nmdsVariance<span class="op">$</span>vectors))</span>
<span id="cb22-6"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-6"></a></span>
<span id="cb22-7"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-7"></a><span class="co"># to create the lines from the centroids to each point we will put it in a format that ggplot can handle</span></span>
<span id="cb22-8"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-8"></a>seg.data&lt;-<span class="kw">cbind</span>(vectors[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>],centroids[<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(centroids),<span class="kw">as.data.frame</span>(<span class="kw">table</span>(vectors<span class="op">$</span>group))<span class="op">$</span>Freq),<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>])</span>
<span id="cb22-9"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-9"></a><span class="kw">names</span>(seg.data)&lt;-<span class="kw">c</span>(<span class="st">&quot;group&quot;</span>,<span class="st">&quot;v.PCoA1&quot;</span>,<span class="st">&quot;v.PCoA2&quot;</span>,<span class="st">&quot;PCoA1&quot;</span>,<span class="st">&quot;PCoA2&quot;</span>)</span>
<span id="cb22-10"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-10"></a></span>
<span id="cb22-11"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-11"></a><span class="co"># create the convex hulls of the outermost points</span></span>
<span id="cb22-12"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-12"></a>grp1.hull &lt;-<span class="st"> </span>seg.data[seg.data<span class="op">$</span>group<span class="op">==</span><span class="st">&quot;Active&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>][<span class="kw">chull</span>(seg.data[seg.data<span class="op">$</span>group<span class="op">==</span><span class="st">&quot;Active&quot;</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]),]</span>
<span id="cb22-13"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-13"></a>grp2.hull &lt;-<span class="st"> </span>seg.data[seg.data<span class="op">$</span>group<span class="op">==</span><span class="st">&quot;Benchmark&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>][<span class="kw">chull</span>(seg.data[seg.data<span class="op">$</span>group<span class="op">==</span><span class="st">&quot;Benchmark&quot;</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]),]</span>
<span id="cb22-14"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-14"></a>grp3.hull &lt;-<span class="st"> </span>seg.data[seg.data<span class="op">$</span>group<span class="op">==</span><span class="st">&quot;Passive&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>][<span class="kw">chull</span>(seg.data[seg.data<span class="op">$</span>group<span class="op">==</span><span class="st">&quot;Passive&quot;</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]),]</span>
<span id="cb22-15"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-15"></a>all.hull &lt;-<span class="st"> </span><span class="kw">rbind</span>(grp1.hull,grp2.hull,grp3.hull)</span>
<span id="cb22-16"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-16"></a></span>
<span id="cb22-17"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-17"></a><span class="co"># plot the panel and convex hulls</span></span>
<span id="cb22-18"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-18"></a>fig_hull &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-19"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-19"></a><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span> all.hull,<span class="kw">aes</span>(<span class="dt">x=</span>v.PCoA1,<span class="dt">y=</span>v.PCoA2),<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>,<span class="dt">alpha=</span><span class="dv">0</span>,<span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb22-20"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-20"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data=</span>seg.data,<span class="kw">aes</span>(<span class="dt">x=</span>v.PCoA1,<span class="dt">xend=</span>PCoA1,<span class="dt">y=</span>v.PCoA2,<span class="dt">yend=</span>PCoA2),<span class="dt">alpha=</span><span class="fl">0.30</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-21"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-21"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>centroids[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="kw">aes</span>(<span class="dt">x=</span>PCoA1,<span class="dt">y=</span>PCoA2,<span class="dt">shape=</span>grps),<span class="dt">size=</span><span class="dv">4</span>,<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-22"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-22"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>seg.data, <span class="kw">aes</span>(<span class="dt">x=</span>v.PCoA1,<span class="dt">y=</span>v.PCoA2,<span class="dt">shape=</span>group),<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb22-23"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-23"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;All&quot;</span>,<span class="dt">x=</span><span class="st">&quot;&quot;</span>,<span class="dt">y=</span><span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb22-24"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-24"></a><span class="st">  </span><span class="co">#coord_cartesian(xlim = c(-0.2,0.2), ylim = c(-0.25,0.2)) +</span></span>
<span id="cb22-25"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-25"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-26"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html#cb22-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="acoustic-space-use.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/vjjan91/acoustics-westernGhats/edit/master/04_nmds-acoustic-space-use.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
