<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 9 Multiple regression on distance matrices | Source code for Using acoustics to assess the impacts of forest restoration on bird communities in the Western Ghats</title>
  <meta name="description" content="Section 9 Multiple regression on distance matrices | Source code for Using acoustics to assess the impacts of forest restoration on bird communities in the Western Ghats" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 9 Multiple regression on distance matrices | Source code for Using acoustics to assess the impacts of forest restoration on bird communities in the Western Ghats" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="vjjan91/acoustics-westernGhats" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 9 Multiple regression on distance matrices | Source code for Using acoustics to assess the impacts of forest restoration on bird communities in the Western Ghats" />
  
  
  

<meta name="author" content="Vijay Ramesh" />
<meta name="author" content="VA Akshay" />
<meta name="author" content="Priyanka HariHaran" />
<meta name="author" content="Pooja Choksi" />
<meta name="author" content="Sarika Khanwilkar" />
<meta name="author" content="Don J Melnick" />
<meta name="author" content="VV Robin" />
<meta name="author" content="Ruth DeFries" />


<meta name="date" content="2021-11-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html"/>
<link rel="next" href="acoustic-space-use.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#attribution"><i class="fa fa-check"></i><b>1.1</b> Attribution</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-access"><i class="fa fa-check"></i><b>1.2</b> Data access</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-processing"><i class="fa fa-check"></i><b>1.3</b> Data processing</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#main-text-figure-1"><i class="fa fa-check"></i><b>1.4</b> Main Text Figure 1</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="splitting-large-wav-files-into-smaller-chunks.html"><a href="splitting-large-wav-files-into-smaller-chunks.html"><i class="fa fa-check"></i><b>2</b> Splitting large .wav files into smaller chunks</a></li>
<li class="chapter" data-level="3" data-path="species-richness.html"><a href="species-richness.html"><i class="fa fa-check"></i><b>3</b> Species Richness</a></li>
<li class="chapter" data-level="4" data-path="acoustic-detections.html"><a href="acoustic-detections.html"><i class="fa fa-check"></i><b>4</b> Acoustic Detections</a></li>
<li class="chapter" data-level="5" data-path="jackknife-estimates.html"><a href="jackknife-estimates.html"><i class="fa fa-check"></i><b>5</b> Jackknife estimates</a></li>
<li class="chapter" data-level="6" data-path="non-metric-multidimensional-scaling-and-indicator-species-analysis.html"><a href="non-metric-multidimensional-scaling-and-indicator-species-analysis.html"><i class="fa fa-check"></i><b>6</b> Non-metric multidimensional scaling and indicator-species analysis</a></li>
<li class="chapter" data-level="7" data-path="preparing-vegetation-data-for-glms.html"><a href="preparing-vegetation-data-for-glms.html"><i class="fa fa-check"></i><b>7</b> Preparing vegetation data for GLMs</a></li>
<li class="chapter" data-level="8" data-path="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html"><a href="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html"><i class="fa fa-check"></i><b>8</b> Generalized linear mixed modeling (species richness, vegetation data and planting year)</a></li>
<li class="chapter" data-level="9" data-path="multiple-regression-on-distance-matrices.html"><a href="multiple-regression-on-distance-matrices.html"><i class="fa fa-check"></i><b>9</b> Multiple regression on distance matrices</a></li>
<li class="chapter" data-level="10" data-path="acoustic-space-use.html"><a href="acoustic-space-use.html"><i class="fa fa-check"></i><b>10</b> Acoustic space use</a></li>
<li class="chapter" data-level="11" data-path="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html"><a href="non-metric-multidimensional-scaling-of-acoustic-space-use-data.html"><i class="fa fa-check"></i><b>11</b> Non-metric multidimensional scaling of acoustic space use data</a></li>
<li class="chapter" data-level="12" data-path="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html"><a href="generalized-linear-mixed-modeling-acoustic-space-use-and-vegetation-data.html"><i class="fa fa-check"></i><b>12</b> Generalized linear mixed modeling (acoustic space use and vegetation data)</a></li>
<li class="chapter" data-level="13" data-path="multiple-regression-on-distance-matrices-acoustic-space-use.html"><a href="multiple-regression-on-distance-matrices-acoustic-space-use.html"><i class="fa fa-check"></i><b>13</b> Multiple regression on distance matrices (acoustic space use)</a></li>
<li class="chapter" data-level="14" data-path="generalized-linear-modeling-acoustic-space-use-and-richness-and-time-since-restoration.html"><a href="generalized-linear-modeling-acoustic-space-use-and-richness-and-time-since-restoration.html"><i class="fa fa-check"></i><b>14</b> Generalized linear modeling (acoustic space use and richness, and time since restoration)</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Source code for <em>Using acoustics to assess the impacts of forest restoration on bird communities in the Western Ghats</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-regression-on-distance-matrices" class="section level1">
<h1><span class="header-section-number">Section 9</span> Multiple regression on distance matrices</h1>
<p>Load necessary libraries</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb45-1"><a href="multiple-regression-on-distance-matrices.html#cb45-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb45-2"><a href="multiple-regression-on-distance-matrices.html#cb45-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb45-3"><a href="multiple-regression-on-distance-matrices.html#cb45-3"></a><span class="kw">library</span>(stringr)</span>
<span id="cb45-4"><a href="multiple-regression-on-distance-matrices.html#cb45-4"></a><span class="kw">library</span>(vegan)</span>
<span id="cb45-5"><a href="multiple-regression-on-distance-matrices.html#cb45-5"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb45-6"><a href="multiple-regression-on-distance-matrices.html#cb45-6"></a><span class="kw">library</span>(scico)</span>
<span id="cb45-7"><a href="multiple-regression-on-distance-matrices.html#cb45-7"></a><span class="kw">library</span>(sf)</span>
<span id="cb45-8"><a href="multiple-regression-on-distance-matrices.html#cb45-8"></a><span class="kw">library</span>(sna)</span>
<span id="cb45-9"><a href="multiple-regression-on-distance-matrices.html#cb45-9"></a><span class="kw">library</span>(hier.part)</span>
<span id="cb45-10"><a href="multiple-regression-on-distance-matrices.html#cb45-10"></a></span>
<span id="cb45-11"><a href="multiple-regression-on-distance-matrices.html#cb45-11"></a><span class="co"># Source any custom/other internal functions necessary for analysis</span></span>
<span id="cb45-12"><a href="multiple-regression-on-distance-matrices.html#cb45-12"></a><span class="kw">source</span>(<span class="st">&quot;code/01_internal-functions.R&quot;</span>)</span></code></pre></div>
<p>Load necessary data and create dissimilarity matrices to run MRM analyses</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb46-1"><a href="multiple-regression-on-distance-matrices.html#cb46-1"></a><span class="co"># estimating geographic distance (euclidean) between sites</span></span>
<span id="cb46-2"><a href="multiple-regression-on-distance-matrices.html#cb46-2"></a>sites &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/list-of-sites.csv&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb46-3"><a href="multiple-regression-on-distance-matrices.html#cb46-3"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">str_detect</span>(Site.code, <span class="st">&#39;OLCAP5B&#39;</span>))</span>
<span id="cb46-4"><a href="multiple-regression-on-distance-matrices.html#cb46-4"></a></span>
<span id="cb46-5"><a href="multiple-regression-on-distance-matrices.html#cb46-5"></a>sites &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(sites, <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>), <span class="dt">crs=</span><span class="dv">4326</span>)</span>
<span id="cb46-6"><a href="multiple-regression-on-distance-matrices.html#cb46-6"></a>sites &lt;-<span class="st"> </span><span class="kw">st_transform</span>(sites, <span class="dv">32643</span>)</span>
<span id="cb46-7"><a href="multiple-regression-on-distance-matrices.html#cb46-7"></a></span>
<span id="cb46-8"><a href="multiple-regression-on-distance-matrices.html#cb46-8"></a>distanceData &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">st_coordinates</span>(sites), <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="dt">diag =</span> <span class="ot">TRUE</span>, <span class="dt">upper =</span> <span class="ot">TRUE</span>, <span class="dt">p =</span> <span class="dv">2</span>)</span>
<span id="cb46-9"><a href="multiple-regression-on-distance-matrices.html#cb46-9"></a>distMatrix &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(distanceData)</span>
<span id="cb46-10"><a href="multiple-regression-on-distance-matrices.html#cb46-10"></a></span>
<span id="cb46-11"><a href="multiple-regression-on-distance-matrices.html#cb46-11"></a><span class="co"># getting vegetation PCA scores as a matrix</span></span>
<span id="cb46-12"><a href="multiple-regression-on-distance-matrices.html#cb46-12"></a>vegPcaScores &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/pcaVeg.csv&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb46-13"><a href="multiple-regression-on-distance-matrices.html#cb46-13"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">str_detect</span>(Site_ID, <span class="st">&#39;OLCAP5B&#39;</span>))</span>
<span id="cb46-14"><a href="multiple-regression-on-distance-matrices.html#cb46-14"></a></span>
<span id="cb46-15"><a href="multiple-regression-on-distance-matrices.html#cb46-15"></a>vegPcaScores &lt;-<span class="st"> </span><span class="kw">dist</span>(vegPcaScores, <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="dt">diag =</span> <span class="ot">TRUE</span>, <span class="dt">upper =</span> <span class="ot">TRUE</span>, <span class="dt">p =</span> <span class="dv">2</span>)</span>
<span id="cb46-16"><a href="multiple-regression-on-distance-matrices.html#cb46-16"></a>vegPcaScores &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(vegPcaScores)</span>
<span id="cb46-17"><a href="multiple-regression-on-distance-matrices.html#cb46-17"></a></span>
<span id="cb46-18"><a href="multiple-regression-on-distance-matrices.html#cb46-18"></a><span class="co"># load NMDS scores (run on bird detections)</span></span>
<span id="cb46-19"><a href="multiple-regression-on-distance-matrices.html#cb46-19"></a>nmdsScores &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/nmdsBrayCurtis-bird-detections.csv&quot;</span>)</span>
<span id="cb46-20"><a href="multiple-regression-on-distance-matrices.html#cb46-20"></a>birdMatrix &lt;-<span class="st"> </span><span class="kw">dist</span>(nmdsScores[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="dt">diag =</span> <span class="ot">TRUE</span>, <span class="dt">upper =</span> <span class="ot">TRUE</span>, <span class="dt">p =</span> <span class="dv">2</span>)</span>
<span id="cb46-21"><a href="multiple-regression-on-distance-matrices.html#cb46-21"></a>birdMatrix &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(birdMatrix)</span></code></pre></div>
<p>Extracting floristic data and running NMDS ordinations on the same</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb47-1"><a href="multiple-regression-on-distance-matrices.html#cb47-1"></a><span class="co"># getting floristic data as a matrix, using NMDS scores</span></span>
<span id="cb47-2"><a href="multiple-regression-on-distance-matrices.html#cb47-2"></a><span class="co"># to do the above, we need to reload the vegetation data and process it</span></span>
<span id="cb47-3"><a href="multiple-regression-on-distance-matrices.html#cb47-3"></a></span>
<span id="cb47-4"><a href="multiple-regression-on-distance-matrices.html#cb47-4"></a>veg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/2020-vegetation-data.csv&quot;</span>)</span>
<span id="cb47-5"><a href="multiple-regression-on-distance-matrices.html#cb47-5"></a>veg<span class="op">$</span>Site_ID &lt;-<span class="st"> </span><span class="kw">str_remove</span>(veg<span class="op">$</span>Site_ID,<span class="st">&quot;_&quot;</span>)</span>
<span id="cb47-6"><a href="multiple-regression-on-distance-matrices.html#cb47-6"></a></span>
<span id="cb47-7"><a href="multiple-regression-on-distance-matrices.html#cb47-7"></a><span class="co"># We load the subset data</span></span>
<span id="cb47-8"><a href="multiple-regression-on-distance-matrices.html#cb47-8"></a>datSubset &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/datSubset.csv&quot;</span>)</span>
<span id="cb47-9"><a href="multiple-regression-on-distance-matrices.html#cb47-9"></a>sites_needed &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">unique</span>(datSubset<span class="op">$</span>Site))</span>
<span id="cb47-10"><a href="multiple-regression-on-distance-matrices.html#cb47-10"></a><span class="kw">names</span>(sites_needed) &lt;-<span class="st"> &quot;Site_ID&quot;</span></span>
<span id="cb47-11"><a href="multiple-regression-on-distance-matrices.html#cb47-11"></a></span>
<span id="cb47-12"><a href="multiple-regression-on-distance-matrices.html#cb47-12"></a><span class="co"># Obtain a subset of the data which have the sites visited </span></span>
<span id="cb47-13"><a href="multiple-regression-on-distance-matrices.html#cb47-13"></a>veg &lt;-<span class="st"> </span><span class="kw">merge</span>(veg, sites_needed, <span class="dt">by.x =</span> <span class="st">&quot;Site_ID&quot;</span>, <span class="dt">by.y=</span><span class="st">&quot;Site_ID&quot;</span>)</span>
<span id="cb47-14"><a href="multiple-regression-on-distance-matrices.html#cb47-14"></a></span>
<span id="cb47-15"><a href="multiple-regression-on-distance-matrices.html#cb47-15"></a><span class="co"># renaming restoration type</span></span>
<span id="cb47-16"><a href="multiple-regression-on-distance-matrices.html#cb47-16"></a>veg<span class="op">$</span>Site_type[veg<span class="op">$</span>Site_type<span class="op">==</span><span class="st">&quot;Unrestored&quot;</span>] &lt;-<span class="st"> &quot;Passive&quot;</span></span>
<span id="cb47-17"><a href="multiple-regression-on-distance-matrices.html#cb47-17"></a>veg<span class="op">$</span>Site_type[veg<span class="op">$</span>Site_type<span class="op">==</span><span class="st">&quot;Restored&quot;</span>] &lt;-<span class="st"> &quot;Active&quot;</span></span>
<span id="cb47-18"><a href="multiple-regression-on-distance-matrices.html#cb47-18"></a></span>
<span id="cb47-19"><a href="multiple-regression-on-distance-matrices.html#cb47-19"></a><span class="co"># now extract floristics data (tree species abundance)</span></span>
<span id="cb47-20"><a href="multiple-regression-on-distance-matrices.html#cb47-20"></a>floraData &lt;-<span class="st"> </span>veg <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-21"><a href="multiple-regression-on-distance-matrices.html#cb47-21"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Site_ID, tree_species, Site_type) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-22"><a href="multiple-regression-on-distance-matrices.html#cb47-22"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Number =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb47-23"><a href="multiple-regression-on-distance-matrices.html#cb47-23"></a><span class="st">  </span><span class="kw">group_by</span>(tree_species, Site_ID, Site_type) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-24"><a href="multiple-regression-on-distance-matrices.html#cb47-24"></a><span class="st">  </span><span class="kw">summarise</span> (<span class="dt">totalAbun =</span> <span class="kw">sum</span>(Number)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-25"><a href="multiple-regression-on-distance-matrices.html#cb47-25"></a><span class="st">  </span><span class="kw">pivot_wider</span> (<span class="dt">names_from =</span> tree_species, <span class="dt">values_from =</span> totalAbun, <span class="dt">values_fill =</span> <span class="kw">list</span>(<span class="dt">totalAbun=</span><span class="dv">0</span>)) <span class="op">%&gt;%</span></span>
<span id="cb47-26"><a href="multiple-regression-on-distance-matrices.html#cb47-26"></a><span class="st">  </span><span class="kw">arrange</span>(.,Site_ID)</span>
<span id="cb47-27"><a href="multiple-regression-on-distance-matrices.html#cb47-27"></a></span>
<span id="cb47-28"><a href="multiple-regression-on-distance-matrices.html#cb47-28"></a><span class="co"># Convert to matrix form</span></span>
<span id="cb47-29"><a href="multiple-regression-on-distance-matrices.html#cb47-29"></a>nmdsDatMatrix &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(floraData[, <span class="dv">3</span><span class="op">:</span><span class="kw">ncol</span>(floraData)])</span>
<span id="cb47-30"><a href="multiple-regression-on-distance-matrices.html#cb47-30"></a></span>
<span id="cb47-31"><a href="multiple-regression-on-distance-matrices.html#cb47-31"></a><span class="co"># Run a bray-curtis dissimilarity index and use metaMDS function from vegan to run ordinations</span></span>
<span id="cb47-32"><a href="multiple-regression-on-distance-matrices.html#cb47-32"></a>disBrayCurtis &lt;-<span class="st"> </span><span class="kw">vegdist</span>(nmdsDatMatrix, <span class="dt">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb47-33"><a href="multiple-regression-on-distance-matrices.html#cb47-33"></a></span>
<span id="cb47-34"><a href="multiple-regression-on-distance-matrices.html#cb47-34"></a>nmdsBrayCurtis &lt;-<span class="st"> </span><span class="kw">vegdist</span> (nmdsDatMatrix, <span class="dt">method =</span> <span class="st">&quot;bray&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-35"><a href="multiple-regression-on-distance-matrices.html#cb47-35"></a><span class="st">  </span><span class="kw">metaMDS</span> (nmdsBrayCurtis, <span class="dt">k=</span><span class="dv">6</span>)</span>
<span id="cb47-36"><a href="multiple-regression-on-distance-matrices.html#cb47-36"></a></span>
<span id="cb47-37"><a href="multiple-regression-on-distance-matrices.html#cb47-37"></a><span class="co"># extract nmds scores</span></span>
<span id="cb47-38"><a href="multiple-regression-on-distance-matrices.html#cb47-38"></a>nmdsScores &lt;-<span class="st"> </span><span class="kw">as.tibble</span>(<span class="kw">scores</span>(nmdsBrayCurtis))</span>
<span id="cb47-39"><a href="multiple-regression-on-distance-matrices.html#cb47-39"></a></span>
<span id="cb47-40"><a href="multiple-regression-on-distance-matrices.html#cb47-40"></a><span class="co"># stress is lowest at around 6 dimensions with value of 0.06152919. However, if stress is high, we should reposition the points in 2 dimensions in the direction of decreasing stress, and repeat until stress is below some threshold.**A good rule of thumb: stress &lt; 0.05 provides an excellent representation in reduced dimensions, &lt; 0.1 is great, &lt; 0.2 is good/ok, and stress &lt; 0.3 provides a poor representation.** To reiterate: high stress is bad, low stress is good!</span></span>
<span id="cb47-41"><a href="multiple-regression-on-distance-matrices.html#cb47-41"></a></span>
<span id="cb47-42"><a href="multiple-regression-on-distance-matrices.html#cb47-42"></a><span class="co"># create a distance matrix on the nmds scores of the flora data</span></span>
<span id="cb47-43"><a href="multiple-regression-on-distance-matrices.html#cb47-43"></a>floraMatrix &lt;-<span class="st"> </span><span class="kw">dist</span>(nmdsScores[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="dt">diag =</span> <span class="ot">TRUE</span>, <span class="dt">upper =</span> <span class="ot">TRUE</span>, <span class="dt">p =</span> <span class="dv">2</span>)</span>
<span id="cb47-44"><a href="multiple-regression-on-distance-matrices.html#cb47-44"></a>floraMatrix &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(floraMatrix)</span></code></pre></div>
<p>Running multiple regression on distance matrices</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb48-1"><a href="multiple-regression-on-distance-matrices.html#cb48-1"></a><span class="co"># First we get rid of redundant duplicate values, then make the diagonal zeros NA, unfold each matrix into a vector, and then omit rows with 0 in them</span></span>
<span id="cb48-2"><a href="multiple-regression-on-distance-matrices.html#cb48-2"></a></span>
<span id="cb48-3"><a href="multiple-regression-on-distance-matrices.html#cb48-3"></a>birdVector &lt;-<span class="st"> </span><span class="kw">upper.tri.remove</span>(birdMatrix)</span>
<span id="cb48-4"><a href="multiple-regression-on-distance-matrices.html#cb48-4"></a><span class="kw">diag</span>(birdVector) &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb48-5"><a href="multiple-regression-on-distance-matrices.html#cb48-5"></a>birdVector &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(birdVector)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()</span>
<span id="cb48-6"><a href="multiple-regression-on-distance-matrices.html#cb48-6"></a></span>
<span id="cb48-7"><a href="multiple-regression-on-distance-matrices.html#cb48-7"></a>floraVector &lt;-<span class="st"> </span><span class="kw">upper.tri.remove</span>(floraMatrix)</span>
<span id="cb48-8"><a href="multiple-regression-on-distance-matrices.html#cb48-8"></a><span class="kw">diag</span>(floraVector) &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb48-9"><a href="multiple-regression-on-distance-matrices.html#cb48-9"></a>floraVector &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(floraVector)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()</span>
<span id="cb48-10"><a href="multiple-regression-on-distance-matrices.html#cb48-10"></a></span>
<span id="cb48-11"><a href="multiple-regression-on-distance-matrices.html#cb48-11"></a>pcaVector &lt;-<span class="st"> </span><span class="kw">upper.tri.remove</span>(vegPcaScores)</span>
<span id="cb48-12"><a href="multiple-regression-on-distance-matrices.html#cb48-12"></a><span class="kw">diag</span>(pcaVector) &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb48-13"><a href="multiple-regression-on-distance-matrices.html#cb48-13"></a>pcaVector &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(pcaVector)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>() </span>
<span id="cb48-14"><a href="multiple-regression-on-distance-matrices.html#cb48-14"></a></span>
<span id="cb48-15"><a href="multiple-regression-on-distance-matrices.html#cb48-15"></a>distanceVector &lt;-<span class="st"> </span><span class="kw">upper.tri.remove</span>(distMatrix)</span>
<span id="cb48-16"><a href="multiple-regression-on-distance-matrices.html#cb48-16"></a><span class="kw">diag</span>(distanceVector) &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb48-17"><a href="multiple-regression-on-distance-matrices.html#cb48-17"></a>distanceVector &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(distanceVector)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span></span>
<span id="cb48-18"><a href="multiple-regression-on-distance-matrices.html#cb48-18"></a><span class="st">  </span>scale</span>
<span id="cb48-19"><a href="multiple-regression-on-distance-matrices.html#cb48-19"></a></span>
<span id="cb48-20"><a href="multiple-regression-on-distance-matrices.html#cb48-20"></a><span class="co">#arranging data for MRM</span></span>
<span id="cb48-21"><a href="multiple-regression-on-distance-matrices.html#cb48-21"></a>mrmData &lt;-<span class="st"> </span><span class="kw">bind_cols</span> (birdVector, floraVector, pcaVector, distanceVector) <span class="op">%&gt;%</span></span>
<span id="cb48-22"><a href="multiple-regression-on-distance-matrices.html#cb48-22"></a><span class="st">  </span><span class="kw">rename</span> (<span class="dt">bird =</span> ...<span class="dv">1</span>, <span class="dt">flora =</span> ...<span class="dv">2</span>, <span class="dt">structure =</span> ...<span class="dv">3</span>, <span class="dt">distance =</span> ...<span class="dv">4</span>)</span>
<span id="cb48-23"><a href="multiple-regression-on-distance-matrices.html#cb48-23"></a></span>
<span id="cb48-24"><a href="multiple-regression-on-distance-matrices.html#cb48-24"></a><span class="kw">MRM</span>(<span class="kw">dist</span>(bird) <span class="op">~</span><span class="st"> </span><span class="kw">dist</span>(flora) <span class="op">+</span><span class="st"> </span><span class="kw">dist</span>(structure) <span class="op">+</span><span class="st"> </span><span class="kw">dist</span>(distance), <span class="dt">data =</span> mrmData, <span class="dt">method =</span> <span class="st">&quot;linear&quot;</span>, <span class="dt">nperm =</span> <span class="dv">1000</span>)</span>
<span id="cb48-25"><a href="multiple-regression-on-distance-matrices.html#cb48-25"></a></span>
<span id="cb48-26"><a href="multiple-regression-on-distance-matrices.html#cb48-26"></a><span class="co"># The above result suggests that bird compositional dissimilarity is not signficantly related to dissimilarity in habitat structure, geographic distance and florstics (Please note that the overall R2 values are very low)</span></span></code></pre></div>
<p>Hierarchical partitioning</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb49-1"><a href="multiple-regression-on-distance-matrices.html#cb49-1"></a><span class="kw">hier.part</span>(mrmData<span class="op">$</span>bird, mrmData[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">gof =</span> <span class="st">&quot;Rsqu&quot;</span>, <span class="dt">barplot =</span> <span class="ot">TRUE</span>)</span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="generalized-linear-mixed-modeling-species-richness-vegetation-data-and-planting-year.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="acoustic-space-use.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/vjjan91/acoustics-westernGhats/edit/master/08_multiple-regression-distance-matrices-bird-detections.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
